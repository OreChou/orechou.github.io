{"meta":{"title":"OreChou's Batcave","subtitle":"Coding & Reading & Playing & Listening","description":"Coding & Reading & Playing & Listening","author":"OreChou","url":"https://orechou.github.io","root":"/"},"pages":[{"title":"About me.","date":"2022-05-13T16:18:44.709Z","updated":"2022-05-13T16:18:44.709Z","comments":true,"path":"about/index.html","permalink":"https://orechou.github.io/about/index.html","excerpt":"","text":"åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œä¹Ÿä»€ä¹ˆäº‹æƒ…æ²¡åšã€‚ æ•™è‚²2012 ~ 2016 é‡åº†å¤§å­¦|è®¡ç®—æœºå­¦é™¢|è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯|æœ¬ç§‘2016 ~ 2019 é‡åº†å¤§å­¦|è®¡ç®—æœºå­¦é™¢|è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯|ç¡•å£«ä¸‰ç¯‡ CCF-C ä¼šè®®è®ºæ–‡Spatially fine-grained air quality prediction based on DBU-LSTMA Novel Approach for Air Quality Inference and Prediction Based on DBU-LSTMDeep Spatial-Temporal Fusion Network for Fine-Grained Air Quality Prediction èŒä¸š2019.7 ~ 2021.6 ç»´æ²ƒç§»åŠ¨é€šä¿¡(æ·±åœ³)æœ‰é™å…¬å¸|å½±åƒç³»ç»Ÿé›†æˆå¼€å‘éƒ¨|åº”ç”¨å·¥ç¨‹å¸ˆå½±åƒç›¸å…³çš„è½¯ä»¶é‡æ„ã€é¢„è§ˆ VSYNC ä¼˜åŒ–ã€‚æ‹¿è¿‡å…¬å¸çš„åˆ›æ–°å¥–ã€ä¼˜ç§€å¥–ã€‚ 2021.6 ~ è‡³ä»Š ç‰›å®¢|åç«¯å·¥ç¨‹å¸ˆã€‚è´Ÿè´£å…¬å¸é¢˜åº“åŸºç¡€æœåŠ¡å»ºè®¾ã€‚ ç†æƒ³å¸Œæœ›èƒ½å¤Ÿä½“éªŒã€è®°å½•æ›´å¤šçš„ç”Ÿæ´»ã€‚"},{"title":"Books Of My Life.","date":"2022-04-08T16:13:27.313Z","updated":"2022-04-08T16:13:27.313Z","comments":true,"path":"book/index.html","permalink":"https://orechou.github.io/book/index.html","excerpt":"","text":"æŠ€æœ¯ä¹¦ç±ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹è±†ç“£ã€ŠEffective Javaä¸­æ–‡ç‰ˆï¼ˆç¬¬3ç‰ˆï¼‰ã€‹è±†ç“£ é‡‘èä¹¦ç±ã€ŠåŒºå—é“¾å®æˆ˜ã€‹è¯¥ä¹¦æ¯”è¾ƒå…¨é¢çš„ä»‹ç»åŒºå—é“¾åŸºæœ¬åŸç†ã€å†å²ã€å‘å±•å’Œåº”ç”¨ï¼Œæ˜¯ä¸€æœ¬å¾ˆå¥½çš„æ¦‚è¿°æ€§çš„ä¹¦ç±ã€‚å¯¹äºåŒºå—é“¾çš„æŠ€æœ¯ç»†èŠ‚å’Œä¸€äº›åº”ç”¨æ¶æ„æœ‰æ‰€æ¶‰åŠï¼Œä½†ä¸ä¼šæ·±å…¥ã€‚æƒ³è¦äº†è§£åŒºå—é“¾çš„è¯»è€…å¯ä»¥å„å–æ‰€éœ€ï¼Œåˆ°å¯¹åº”çš„ç« èŠ‚äº†è§£æƒ³è¦äº†è§£çš„å†…å®¹ã€‚ éæŠ€æœ¯ä¹¦ç±ã€Šè¯»æ°´æµ’ï¼šäººæ€§çš„åä¸‰ç§åˆ»åº¦ã€‹ä¸€æœ¬é—²ä¹¦ï¼Œç”¨äº†å¾ˆå¿«çš„æ—¶é—´è¯»å®Œã€‚ä½œè€…å¯¹æ°´æµ’é‡Œé¢ç‰¹æ®Šçš„äººç‰©åšäº†ä¸€äº›è§£è¯»ï¼Œåˆæ²¡æœ‰è¿‡æ¸¡è§£è¯»ã€‚å°‘å¹´çš„æ—¶å€™è¯»æ°´æµ’ï¼Œè§‰å¾—æ°´æµ’å¥½ç©ã€‚ç°å¦‚ä»Šé•¿å¤§äº†äº›ï¼Œå†è¯»æ°´æµ’ï¼Œæœ‰äº†ä¸€äº›æƒŠå¿ƒåŠ¨é­„ã€‚äººåœ¨æˆé•¿ï¼Œé€‚åº”ã€å¦¥åã€æ¥å—ç€è¿™ä¸ªä¸–ç•Œã€‚"},{"title":"Gallery Of My Life.","date":"2022-03-27T11:17:10.268Z","updated":"2022-03-27T11:17:10.268Z","comments":true,"path":"gallery/index.html","permalink":"https://orechou.github.io/gallery/index.html","excerpt":"","text":"è¥¿é—¨ğŸ±ï¼šPikachu"},{"title":"Games Of My Life.","date":"2022-05-13T16:25:55.888Z","updated":"2022-05-13T16:25:55.888Z","comments":true,"path":"game/index.html","permalink":"https://orechou.github.io/game/index.html","excerpt":"","text":"å–œæ¬¢çš„æ¸¸æˆã€1ã€‘Batman: Arkham Knightå¾ˆå–œæ¬¢åœ¨æš´é›¨ã€é»‘å¤œä¸­çš„å“¥è°­å¸‚ï¼Œæ‰®æ¼”è¿™ä½é»‘æš—éª‘å£«çš„æ„Ÿè§‰ã€‚å­¤ç‹¬ã€éšå¿ä¸ä¿¡å¿µã€‚ ã€2ã€‘Middle-earth: Shadow of MordoråŸåˆ›çš„ä¸€ä¸ªåˆšé“æ¸¸ä¾ ä¸ºå®ˆå«ä¸–ç•Œæœ€åæˆä¸ºæˆ’çµçš„æ•…äº‹ã€‚å¤ä»‡ã€çº ç»“ä¸ç‰ºç‰²ã€‚æ¸¸æˆçš„ç»“å°¾æ›²æ„Ÿäººã€‚ ã€3ã€‘Red Dead Redemption 2Read Dead Redemption 2 å¯ä»¥æ— é™å¹ï¼Œ18 å¹´æœ€ä½³æ¸¸æˆè½è´¥ç»™æˆ˜ç¥ 4 æˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ã€‚"},{"title":"Android Notes","date":"2021-10-29T06:35:18.520Z","updated":"2016-01-25T12:52:35.000Z","comments":true,"path":"back_posts/old_posts/Android_Notes.html","permalink":"https://orechou.github.io/back_posts/old_posts/Android_Notes.html","excerpt":"","text":"Quick Start1ã€åœ¨ç¨‹åºä¸­å®ç°äº‹ä»¶ç›‘å¬å™¨çš„4ç§å½¢å¼å†…éƒ¨ç±»ï¼ˆä¼˜ç‚¹ï¼šå¯ä»¥åœ¨å½“å‰ç±»ä¸­æœç”¨è¯¥ç›‘å¬å™¨ï¼›å¯ä»¥è‡ªç”±è®¿é—®å¤–éƒ¨ç±»çš„æ‰€æœ‰ç•Œé¢ç»„ä»¶ï¼‰å¤–éƒ¨ç±»ï¼ˆä¼˜ç‚¹ï¼šç¡®å®éœ€è¦è¢«å¤šä¸ªGUIç•Œé¢å…±äº«ï¼Œè€Œä¸”ä¸»è¦æ˜¯å®ŒæˆæŸç§ä¸šåŠ¡é€»è¾‘çš„å®ç°ï¼‰ï¼ˆButï¼šå®é™…ä¸Šä¸æ¨èå°†ä¸šåŠ¡é€»è¾‘å®ç°å†™åœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­ï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘çš„äº‹ä»¶ç›‘å¬å™¨å°†å¯¼è‡´ç¨‹åºçš„æ˜¾ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘è€¦åˆã€‚é€šå¸¸è€ƒè™‘ä½¿ç”¨ä¸šåŠ¡é€»è¾‘ç»„ä»¶æ¥å®šä¹‰ä¸šåŠ¡é€»è¾‘åŠŸèƒ½ï¼Œå†è®©äº‹ä»¶ç›‘å¬å™¨æ¥è°ƒç”¨ä¸šåŠ¡é€»è¾‘ç»„ä»¶çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ã€‚ï¼‰Activityæœ¬èº«ä½œä¸ºäº‹ä»¶ç›‘å¬å™¨ï¼ˆç¼ºç‚¹ï¼šç¨‹åºç»“æ„æ··ä¹±ï¼›è¯¡å¼‚ï¼‰åŒ¿åå†…éƒ¨ç±»ï¼ˆäº‹ä»¶å¤„ç†å™¨æ²¡æœ‰å¤ç”¨ä»·å€¼ã€‚Butï¼šäº‹å®ä¸Šè¿™æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„å½¢å¼ï¼‰ç›´æ¥ç»‘å®šåˆ°æ ‡ç­¾ï¼ˆå‡½æ•°æ˜¯publicï¼Œå‚æ•°ä¼ å…¥ä¸€ä¸ªViewï¼‰ 2ã€åŸºäºç›‘å¬çš„äº‹ä»¶å¤„ç†æ¯”åŸºäºå›è°ƒçš„äº‹ä»¶å¤„ç†çš„ä¼˜åŠ¿ï¼ˆ1ï¼‰åŸºäºç›‘å¬çš„æ—¶é—´å¤„ç†æ¨¡å‹åˆ†å·¥æ›´æ˜ç¡®ï¼Œäº‹ä»¶æºã€äº‹ä»¶ç›‘å¬å™¨æœ‰ä¸¤ä¸ªç±»åˆ†å¼€å®ç°ï¼Œå…·æœ‰æ›´å¥½çš„å¯ç»´æŠ¤æ€§ã€‚ï¼ˆ2ï¼‰Androidçš„äº‹ä»¶å¤„ç†æœºåˆ¶ä¿è¯åŸºäºç›‘å¬çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ä¼˜å…ˆè§¦å‘ã€‚ 3ã€Activityçš„å››ç§åŠ è½½æ¨¡å¼Androidé‡‡ç”¨Taskæ¥ç®¡ç†å¤šä¸ªActivityã€‚å¯ä»¥æŠŠTaskç†è§£æˆActivityæ ˆï¼ŒTaskä»¥æ ˆçš„å½¢å¼æ¥ç®¡ç†Activityã€‚ï¼ˆ1ï¼‰standardæ¨¡å¼ï¼šAndroidæ€»ä¼šä¸ºç›®æ ‡Activityåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¹¶å°†è¯¥Activityæ·»åŠ åˆ°å½“å‰Taskæ ˆä¸­ï¼Œè¿™ç§æ¨¡å¼ä¸ä¼šå¯åŠ¨æ–°çš„Taskï¼Œæ–°Activityå°†è¢«æ·»åŠ åˆ°åŸæœ‰çš„Taskä¸­ã€‚ï¼ˆ2ï¼‰singleTopæ¨¡å¼ï¼šå½“å°†è¦å¯åŠ¨çš„ç›®æ ‡Activityå·²ç»ä½äºTaskæ ˆé¡¶æ—¶ï¼Œç³»ç»Ÿä¸ä¼šé‡æ–°åˆ›å»ºç›®æ ‡Activityçš„å®ä¾‹ï¼Œè€Œæ˜¯ç›´æ¥å¤ç”¨å·²æœ‰çš„Activityå®ä¾‹ã€‚ï¼ˆ3ï¼‰singleTaskæ¨¡å¼ï¼šè¦å¯åŠ¨çš„ç›®æ ‡Activityå·²ç»å­˜åœ¨ã€ä½†æ²¡æœ‰ä½äºTaskæ ˆé¡¶ï¼Œç³»ç»Ÿå°†ä¼šæŠŠä½äºè¯¥Activityä¸Šé¢çš„æ‰€æœ‰Activityç§»å‡ºTaskæ ˆï¼Œä»è€Œä½¿å¾—ç›®æ ‡Activityè½¬å…¥æ ˆé¡¶ã€‚ï¼ˆ4ï¼‰singleInstanceæ¨¡å¼ï¼šå¯åŠ¨çš„ç›®æ ‡Activityä¸å­˜åœ¨ï¼Œç³»ç»Ÿå…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„Taskï¼Œå†åˆ›å»ºç›®æ ‡Activityå®ä¾‹ï¼Œå¹¶å°†å®ƒåŠ å…¥æ–°çš„Taskæ ˆé¡¶ã€‚å¦‚æœç›®æ ‡Activityå·²ç»å­˜åœ¨ï¼Œæ— è®ºä»–ä½äºå“ªä¸ªåº”ç”¨ç¨‹åºä¸­ã€ä½äºå“ªä¸ªTaskä¸­ï¼Œç³»ç»Ÿéƒ½ä¼šæŠŠè¯¥Activityæ‰€åœ¨çš„Taskè½¬åˆ°å‰å°ï¼Œä»è€Œä½¿è¯¥Activityæ˜¾ç¤ºå‡ºæ¥ã€‚"},{"title":"Build this Blog","date":"2021-10-29T06:35:18.519Z","updated":"2016-01-13T09:19:49.000Z","comments":true,"path":"back_posts/old_posts/Blog.html","permalink":"https://orechou.github.io/back_posts/old_posts/Blog.html","excerpt":"","text":"date: 2016-01-13 16:44:51 ç®€ç®€å•å•è®°å½•å‡ å¥å§ã€‚ Quick Startç¬¬ä¸€ç‚¹å…¶å®ç°åœ¨æ­è¿™ä¸ªBlogï¼Œæœ‰ä¸€åŠæ˜¯è£…é€¼ã€‚å­¦æŠ€æœ¯æ‰å†™åšå®¢ï¼Œæˆ‘ç°åœ¨ç®—æœ¬æœ«å€’ç½®ã€‚æ­å»ºBlogä½¿ç”¨äº†Github+Hexoï¼Œæ­äº†åŠå¤©ã€‚Hexoæ˜¯åŸºäºNode.jsçš„é™æ€åšå®¢æ¡†æ¶ã€‚æ­å¾ˆç®€å•ï¼Œå°´å°¬çš„æ˜¯Node.jsè¢«å¢™ï¼Œæˆ‘åœ¨macç¯å¢ƒä¸‹ç”¨brewä¸€ç›´ä¸‹è½½å¤±è´¥ã€‚ç½‘ä¸Šæœ‰è§£å†³æ–¹æ³•ã€‚å½“ç„¶æ•™ç¨‹æœ‰å¾ˆå¤šã€‚è‡ªå·±æ­åšå®¢çš„å¥½å¤„ï¼šè‡ªå®šä¹‰ä½ çš„ç•Œé¢ç­‰ç­‰ã€‚æœ€é‡è¦çš„æ˜¯ï¼šä½ åªéœ€åœ¨ç”µè„‘é‡Œç”¨MakedownæŠŠpostå†™å¥½ï¼Œå‘å¸ƒåªéœ€è¦åœ¨å‘½ä»¤è¡Œé‡Œæ•²ä¸¤å¥â€œhexo generateâ€ï¼Œâ€œhexo deployâ€ ç¬¬äºŒç‚¹è¿™åŠå¹´æ¥è€ƒç ”ï¼Œæ²¡å­¦ä¸“ä¸šçŸ¥è¯†ï¼Œä¹Ÿæ²¡ç¼–ç¨‹ã€‚æˆ‘è¿˜ç®—ä¸ä¸Šè§£ç¼–ç¨‹ï¼Œèœé¸Ÿåˆšé£ã€‚äººæœ‰å…´è¶£ï¼Œåšäº‹æƒ…æ‰ä¼šæœ‰åŠ¨åŠ›ï¼Œæˆ‘è¿˜æœ‰å…´è¶£ã€‚ ç¬¬ä¸‰ç‚¹ç»™æˆ‘æœ‰æ„Ÿå—çš„æ˜¯ï¼Œäººçš„å·¥ä½œã€å­¦ä¹ æ•ˆç‡ä¸ä½¿ç”¨çš„å·¥å…·æœ‰å¾ˆå¤§å…³ç³»ï¼Œåˆ«è®©å·¥å…·æ‹–ä½äººçš„æ­¥ä¼ã€‚ä½†å¯¹æˆ‘æ¥è¯´ï¼Œæˆ‘çš„è„‘å­æ‹–ç€æˆ‘æ­¥ä¼ï¼Œå­¦ä¹ æ˜¯ä»¶å¾ˆåƒåŠ›çš„äº‹æƒ…ã€‚æ–°äº‹ç‰©å±‚å‡ºä¸ç©·ï¼Œè·Ÿä¸ä¸Šçš„ï¼Œæ³¨å®šæ·˜æ±°ã€‚ Thatâ€™s All"},{"title":"å…³äºDP","date":"2021-10-29T06:35:18.520Z","updated":"2016-03-02T10:48:31.000Z","comments":true,"path":"back_posts/old_posts/DP.html","permalink":"https://orechou.github.io/back_posts/old_posts/DP.html","excerpt":"","text":"QuikSorkä»Šå¤©é‡åˆ°ä¸€é“å…³äºDPçš„é¢˜ï¼Œå¤ä¹ ä¸€ä¸‹DP è§£é¢˜æ­¥éª¤1.åˆ»ç”»ä¸€ä¸ªæœ€ä¼˜è§£å¾—ç‰¹å¾ç»“æ„2.é€’å½’åœ°å®šä¹‰æœ€ä¼˜è§£çš„å€¼3.è®¡ç®—æœ€ä¼˜è§£çš„å€¼ï¼Œé€šå¸¸é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•4.åˆ©ç”¨è®¡ç®—å‡ºçš„ä¿¡æ¯æ„é€ ä¸€ä¸ªæœ€ä¼˜è§£ æ¦‚å¿µæœ€ä¼˜å­ç»“æ„æ€§è´¨ï¼šé—®é¢˜çš„æœ€ä¼˜è§£ç”±ç›¸å…³å­é—®é¢˜çš„æœ€ä¼˜è§£ç»„åˆè€Œæˆï¼Œè€Œè¿™äº›å­é—®é¢˜å¯ä»¥ç‹¬ç«‹æ±‚è§£å¯¹äºä»»ä½•å­é—®é¢˜ï¼Œç›´è‡³å®ƒä¾èµ–çš„æ‰€æœ‰å­é—®é¢˜å‡å·²æ±‚è§£å®Œæˆæ‰ä¼šæ±‚è§£å®ƒ é¢˜ç›®Problem Descriptionï¼šGiven a sequence a[1],a[2],a[3]......a[n], your job is to calculate the max sum of a sub-sequence. For example, given (6,-1,5,4,-7), the max sum in this sequence is 6 + (-1) + 5 + 4 = 14.Input:The first line of the input contains an integer T(1&lt;=T&lt;=20) which means the number of test cases. Then T lines follow, each line starts with a number N(1&lt;=N&lt;=100000), then N integers followed(all the integers are between -1000 and 1000).Output:For each test case, you should output two lines. The first line is &quot;Case #:&quot;, # means the number of the test case. The second line contains three integers, the Max Sum in the sequence, the start position of the sub-sequence, the end position of the sub-sequence. If there are more than one result, output the first one. Output a blank line between two cases.Sample Input:2 5 6 -1 5 4 -7 7 0 6 -1 1 -6 7 -5Sample Output:Case 1: 14 1 4Case 2: 7 1 6 ä»£ç #include &lt;stdio.h&gt; #define maxsize 1000000 int main() &#123; int seq[maxsize]; int T,N; scanf(&quot;%d&quot;, &amp;T); for (int i = 0; i &lt; T; ++i) &#123; scanf(&quot;%d&quot;, &amp;N); for (int k = 0; k &lt; N; ++k) &#123; scanf(&quot;%d&quot;, &amp;seq[k]); &#125; int max = 0, temp = 0, start = 0, end = 0, pos = 0; for (int j = 0; j &lt; N; ++j) &#123; /* code */ if (temp + seq[j] &lt; seq[j]) &#123; /* code */ pos = j; temp = seq[j]; &#125; else &#123; temp += seq[j]; &#125; if (temp &gt; max) &#123; max = temp; start = pos; end = j; &#125; &#125; printf(&quot;Case %d:\\n&quot;, i+1); printf(&quot;%d %d %d&quot;, max , start+1, end+1); if (i == T-1) &#123; printf(&quot;\\n&quot;); &#125; else &#123; printf(&quot;\\n\\n&quot;); &#125; &#125; &#125;"},{"title":"ORM & JPA  & Spring Data JPA ä¹‹é—´çš„å…³ç³»","date":"2021-10-29T06:35:18.519Z","updated":"2018-06-12T12:54:30.000Z","comments":true,"path":"back_posts/old_posts/JPA & ORM & Spring Data JPA ä¹‹é—´çš„å…³ç³».html","permalink":"https://orechou.github.io/back_posts/old_posts/JPA%20&%20ORM%20&%20Spring%20Data%20JPA%20%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB.html","excerpt":"è¿™ç¯‡æ–‡ç« ä¸»è¦æ¢³ç†ä¸€ä¸‹ ORM &amp; JPA &amp; Spring Data JPA ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼Œåé¢ä¼šå†™ä¸€ç¯‡ç°åœ¨ä¸»æµ ORM æ¡†æ¶ï¼ˆHibernateã€Mybatisï¼‰çš„æ–‡ç« ã€‚","text":"è¿™ç¯‡æ–‡ç« ä¸»è¦æ¢³ç†ä¸€ä¸‹ ORM &amp; JPA &amp; Spring Data JPA ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼Œåé¢ä¼šå†™ä¸€ç¯‡ç°åœ¨ä¸»æµ ORM æ¡†æ¶ï¼ˆHibernateã€Mybatisï¼‰çš„æ–‡ç« ã€‚ ORMWhatå¯¹è±¡å…³ç³»æ˜ å°„( Object Relational Mappingï¼Œç®€ç§° ORM ï¼‰ï¼Œæ˜¯ä¸€ç§ç¨‹åºæŠ€æœ¯ï¼Œç”¨äºå®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€é‡Œä¸åŒç±»å‹ç³»ç»Ÿçš„æ•°æ®ä¹‹é—´çš„è½¬æ¢ã€‚ Whyåœ¨åŸæ¥ Java å¯¹æ•°æ®åº“çš„è®¿é—®æ˜¯é€šè¿‡ JDBCï¼ˆJava Database Connectivityï¼‰ï¼ŒJDBC æä¾›äº†ä¸€ç»„ Java API æ¥è®¿é—®æ•°æ®åº“ã€‚ä½¿ç”¨ JDBC å¼€å‘åº”ç”¨ç¨‹åºçš„ä¼˜ç¼ºç‚¹å¦‚ä¸‹ï¼š JDBC çš„ä¼˜ç‚¹ JDBC çš„ç¼ºç‚¹ å¹²å‡€æ•´æ´çš„ SQL å¤„ç† å¤§é¡¹ç›®ä¸­ä½¿ç”¨å¾ˆå¤æ‚ å¤§æ•°æ®ä¸‹æœ‰è‰¯å¥½çš„æ€§èƒ½ å¾ˆå¤§çš„ç¼–ç¨‹æˆæœ¬ å¯¹äºå°åº”ç”¨éå¸¸å¥½ æ²¡æœ‰å°è£… æ˜“å­¦çš„ç®€æ˜“è¯­æ³• éš¾ä»¥å®ç° MVC çš„æ¦‚å¿µ é’ˆå¯¹ JDBC å­˜åœ¨çš„ç¼ºç‚¹ï¼Œä¸€äº›å‚å•†å¼€å‘äº† ORM æ¡†æ¶æ¥å¼¥è¡¥ã€‚æ¯”å¦‚ï¼šHibernateã€iBatisï¼ˆMyBatisï¼‰ã€openJDKç­‰ã€‚ä½¿ç”¨ ORM çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š åºå· ä¼˜ç‚¹ 1 ä¸€ä¸ª API æ¥åœ¨æŒä¹…ç±»çš„å¯¹è±¡ä¸Šå®ç°åŸºæœ¬çš„ CRUD æ“ä½œ 2 ä¸€ä¸ªè¯­è¨€æˆ– API æ¥æŒ‡å®šå¼•ç”¨ç±»å’Œå±æ€§çš„æŸ¥è¯¢ 3 ä¸€ä¸ªå¯é…ç½®çš„æœåŠ¡ç”¨æ¥æŒ‡å®šæ˜ å°„å…ƒæ•°æ® 4 ä¸€ä¸ªæŠ€æœ¯å’Œäº‹åŠ¡å¯¹è±¡äº¤äº’æ¥æ‰§è¡Œ dirty checking, lazy association fetching å’Œå…¶å®ƒä¼˜åŒ–çš„åŠŸèƒ½ ä½†æ˜¯ç°åœ¨ä¹Ÿå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œ ORM æ¡†æ¶è¿™ä¹ˆå¤šï¼Œå¤§å®¶å„è‡ªæè‡ªå·±çš„ï¼Œæ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„è§„èŒƒã€‚æ‰€ä»¥ JPA å°±å‡ºç°äº†ã€‚ JPAWhatJava Persistence APIï¼ˆJPAï¼‰å³JavaæŒä¹…å±‚APIï¼Œæ˜¯ä¸€ç§Javaåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£è§„èŒƒï¼Œå®ƒæè¿°äº†åœ¨ä½¿ç”¨Javaå¹³å°æ ‡å‡†ç‰ˆå’ŒJavaå¹³å°ä¼ä¸šç‰ˆçš„åº”ç”¨ç¨‹åºä¸­ç®¡ç†å…³ç³»æ•°æ®ã€‚ æŒä¹…å±‚æ˜¯ä¸€ä¸ªåŒ…æ‹¬äº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢çš„æŠ€æœ¯ï¼š å®šä¹‰åœ¨ javax.persistence åŒ…ä¸‹çš„APIæœ¬èº«ï¼šç”¨æ¥æ“ä½œå®ä½“å¯¹è±¡ï¼Œæ‰§è¡ŒCRUDæ“ä½œï¼Œæ¡†æ¶åœ¨åå°æ›¿ä»£æˆ‘ä»¬å®Œæˆæ‰€æœ‰çš„äº‹æƒ…ï¼Œå¼€å‘è€…ä»ç¹ççš„JDBCå’ŒSQLä»£ç ä¸­è§£è„±å‡ºæ¥ã€‚ JavaæŒä¹…å±‚æŸ¥è¯¢è¯­è¨€ï¼ˆJPQLï¼‰ï¼šè¿™æ˜¯æŒä¹…åŒ–æ“ä½œä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªæ–¹é¢ï¼Œé€šè¿‡é¢å‘å¯¹è±¡è€Œéé¢å‘æ•°æ®åº“çš„æŸ¥è¯¢è¯­è¨€æŸ¥è¯¢æ•°æ®ï¼Œé¿å…ç¨‹åºçš„SQLè¯­å¥ç´§å¯†è€¦åˆã€‚ å¯¹è±¡å…³ç³»å…ƒæ•°æ®ï¼šJPAæ”¯æŒXMLå’ŒJDK5.0æ³¨è§£ä¸¤ç§å…ƒæ•°æ®çš„å½¢å¼ï¼Œå…ƒæ•°æ®æè¿°å¯¹è±¡å’Œè¡¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œæ¡†æ¶æ®æ­¤å°†å®ä½“å¯¹è±¡æŒä¹…åŒ–åˆ°æ•°æ®åº“è¡¨ä¸­ WhySunå¼•å…¥æ–°çš„JPA ORMè§„èŒƒå‡ºäºä¸¤ä¸ªåŸå› ï¼šå…¶ä¸€ï¼Œç®€åŒ–ç°æœ‰Java EEå’ŒJava SEåº”ç”¨å¼€å‘å·¥ä½œï¼›å…¶äºŒï¼ŒSunå¸Œæœ›æ•´åˆORMæŠ€æœ¯ï¼Œå®ç°å¤©ä¸‹å½’ä¸€ã€‚å¼€å‘è€…é¢å‘ JPA è§„èŒƒçš„æ¥å£ï¼Œä½†åº•å±‚çš„ JPA å®ç°å¯ä»¥ä»»æ„åˆ‡æ¢ï¼šè§‰å¾— Hibernate å¥½çš„ï¼Œå¯ä»¥é€‰æ‹©Hibernate JPA å®ç°ï¼›è§‰å¾— TopLink å¥½çš„ï¼Œå¯ä»¥é€‰æ‹© TopLink JPA å®ç°ã€‚ JPA åªæ˜¯æä¾›äº†ä¸€ä¸ªæ¥å£è§„èŒƒï¼Œåœ¨å®é™…çš„å·¥ç¨‹åº”ç”¨ä¸­ï¼Œå…‰é  JPA åšä¸äº†å®é™…çš„äº‹æƒ…ã€‚ Spring Data JPAWhatå®˜æ–¹ç»™å‡ºçš„å®šä¹‰ï¼šSpring Data JPA å¯ä»¥è½»æ¾å®ç°åŸºäºJPAçš„å­˜å‚¨åº“ã€‚è¯¥æ¨¡å—å¤„ç†å¯¹åŸºäºJPAçš„æ•°æ®è®¿é—®å±‚çš„å¢å¼ºæ”¯æŒã€‚å®ƒä½¿æ„å»ºä½¿ç”¨æ•°æ®è®¿é—®æŠ€æœ¯çš„Springåº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ å®¹æ˜“ã€‚ Whyåœ¨ä¸€æ®µæ—¶é—´å†…å®ç°åº”ç”¨ç¨‹åºçš„æ•°æ®è®¿é—®å±‚å¾ˆéº»çƒ¦ã€‚éœ€è¦ç¼–å†™å¤ªå¤šçš„æ ·æ¿ä»£ç æ‰èƒ½æ‰§è¡Œç®€å•æŸ¥è¯¢ä»¥åŠæ‰§è¡Œåˆ†é¡µå’Œå®¡è®¡ã€‚ Spring Data JPAæ—¨åœ¨é€šè¿‡å‡å°‘å®é™…éœ€è¦çš„æ•°é‡æ¥æ˜¾ç€æ”¹è¿›æ•°æ®è®¿é—®å±‚çš„å®ç°ã€‚ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæ‚¨éœ€è¦ç¼–å†™å­˜å‚¨åº“æ¥å£ï¼ˆåŒ…æ‹¬è‡ªå®šä¹‰æŸ¥æ‰¾ç¨‹åºæ–¹æ³•ï¼‰ï¼ŒSpringå°†è‡ªåŠ¨æä¾›å®ç°ã€‚ è¿™æ ·å°±æ¸…æ¥šäº†ï¼ŒSpring Data JPA å¢å¼ºäº†åŸºäº JPA çš„æ•°æ®è®¿é—®å±‚çš„æ”¯æŒï¼Œå¹¶ä¸”å¯¹äºåº•å±‚çš„ ORM æä¾›äº†è‡ªåŠ¨çš„å®ç°ï¼ˆSpring Data JPA åº•å±‚ ORM å°±æ˜¯é€šè¿‡ Hibernate å®ç°çš„ï¼‰ã€‚ SummaryORM æ¡†æ¶æä¾›äº†é¢å‘å¯¹è±¡æ–¹å¼ï¼Œæ–¹ä¾¿äº†å¼€å‘äººå‘˜å¯¹æ•°æ®åº“çš„æ“ä½œã€‚å„å¤§å‚å•†å„è‡ªçš„ ORM è®¾è®¡å‘å±•éœ€è¦ä¸€ä¸ªè§„èŒƒç»Ÿä¸€èµ·æ¥ï¼Œæ˜¯ JPA å‡ºç°çš„ä¸»è¦åŸå› ã€‚åœ¨ Java Web é¢†åŸŸçš„å·¨å¤´ Spring æ¨å‡ºçš„ Spring Data JPA å³å¢å¼ºäº† JPAï¼Œåˆå±è”½æ‰äº†åº•å±‚ ORM çš„å®ç°ã€‚æå¤§ç¨‹åº¦åœ°æ–¹ä¾¿äº†å¼€å‘è€…ã€‚æœ€åå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„å›¾æè¿°ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š"},{"title":"JavaScript ä¸¥æ ¼æ¨¡å¼","date":"2021-10-29T06:35:18.519Z","updated":"2018-06-12T12:54:28.000Z","comments":true,"path":"back_posts/old_posts/JS ä¸¥æ ¼æ¨¡å¼.html","permalink":"https://orechou.github.io/back_posts/old_posts/JS%20%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F.html","excerpt":"æ¦‚è¿°ECMAScript ä¸¥æ ¼æ¨¡å¼æ˜¯é‡‡ç”¨å…·æœ‰é™åˆ¶æ€§ JavaScript å˜ä½“çš„ä¸€ç§æ–¹å¼ã€‚å…¶ç›®çš„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š æ¶ˆé™¤ JavaScript è¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸¥è°¨çš„åœ°æ–¹ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸º æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ ä¸ºæœªæ¥ç‰ˆæœ¬çš„ JavaScript åšå¥½é“ºå«","text":"æ¦‚è¿°ECMAScript ä¸¥æ ¼æ¨¡å¼æ˜¯é‡‡ç”¨å…·æœ‰é™åˆ¶æ€§ JavaScript å˜ä½“çš„ä¸€ç§æ–¹å¼ã€‚å…¶ç›®çš„ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š æ¶ˆé™¤ JavaScript è¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸¥è°¨çš„åœ°æ–¹ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸º æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨ æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ ä¸ºæœªæ¥ç‰ˆæœ¬çš„ JavaScript åšå¥½é“ºå« ä½¿ç”¨æ–¹å¼å¯¹äºè„šæœ¬å°† use strict æ”¾åœ¨æ•´ä¸ªè„šæœ¬çš„ç¬¬ä¸€è¡Œï¼ˆå¿…é¡»æ”¾ç½®åœ¨ç¬¬ä¸€è¡Œï¼Œå¦åˆ™æ— æ•ˆï¼‰ï¼Œæ•´ä¸ªè„šæœ¬ä»¥ä¸¥æ ¼æ¨¡å¼è¿è¡Œã€‚ 1234&lt;script&gt; &quot;use strict&quot; console.log(&quot;This is in strict mode.&quot;)&lt;/script&gt; ä¸Šé¢çš„å†™æ³•æœ‰ç¼ºç‚¹ï¼Œå½“æœ‰å¤šä¸ªè„šæœ¬æ–‡ä»¶çš„æ—¶å€™ï¼Œä¸åˆ©äºæ–‡ä»¶çš„åˆå¹¶ã€‚å˜é€šçš„åšæ³•æ˜¯å°†æ•´ä¸ªè„šæœ¬æ–‡ä»¶æ”¾åœ¨ç«‹å³æ‰§è¡Œçš„åŒ¿åå‡½æ•°ä¸­ 1234(function() &#123; &#x27;use strict&#x27; // follow codes&#125;)(); å°† use strict æ”¾åœ¨å‡½æ•°çš„ç¬¬ä¸€è¡Œï¼Œæ•´ä¸ªå‡½æ•°ä»¥ä¸¥æ ¼æ¨¡å¼è¿è¡Œ 1234function strict() &#123; &#x27;use strict&#x27; console.log(&#x27;This is in strict mode.&#x27;)&#125; å¸¦æ¥çš„æ”¹å˜å…¨å±€å˜é‡å¿…é¡»æ˜¾ç¤ºå£°æ˜123&#x27;use strict&#x27;v = 1 // æŠ¥é”™ã€‚v æœªå£°æ˜for (i = 0; i &lt; 10; i++) &#123;&#125; // æŠ¥é”™ã€‚i æœªå£°æ˜ ç¦æ­¢ä½¿ç”¨ with è¯­å¥1234567&#x27;use strict&#x27;var v = 1// ä¸¥æ ¼æ¨¡å¼é™åˆ¶äº†ä¸€äº›åŠ¨æ€ç»‘å®š// åœ¨è¿™é‡Œ with è¯­å¥æ— æ³•åœ¨ç¼–è¯‘æ—¶ç¡®å®šå±æ€§å½’å±äºå“ªä¸ªå¯¹è±¡with (o) &#123; // è¯­æ³•é”™è¯¯ v = 2&#125; eval ä½œç”¨åŸŸæ­£å¸¸æ¨¡å¼ä¸‹æœ‰ä¸¤ç§ä½œç”¨åŸŸï¼ˆ scope ï¼‰ï¼šå…¨å±€ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸã€‚ä¸¥æ ¼æ¨¡å¼ä¸‹æœ‰äº†ç¬¬ä¸‰ç§ä½œç”¨åŸŸï¼Œ eval ä½œç”¨åŸŸ 12345&#x27;use strict&#x27;var v = 1// eval åˆ›å»ºäº†è‡ªèº«çš„ä½œç”¨åŸŸï¼Œå®ƒæ‰€ç”Ÿæˆçš„å˜é‡åªç”¨äº eval å†…éƒ¨console.log(eval(&#x27;var v = 2; v&#x27;)) // è¾“å‡º 2console.log(v) // è¾“å‡º 1 ç¦æ­¢ this æŒ‡å‘å…¨å±€å¯¹è±¡1234567function f() &#123; return !this // false, this ä¸ºå…¨å±€å¯¹è±¡ï¼Œä¸ä¸º null å’Œ undefinedï¼Œæ‰€ä»¥è¿”å› false&#125;function f() &#123; &#x27;use strict&#x27; return !this // true, this ä¸æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œä¸º undefined&#125; ç¦æ­¢åœ¨å‡½æ•°å†…éƒ¨éå†è°ƒç”¨æ ˆ123456function f() &#123; &#x27;use strict&#x27; // properties may not be accessed on strict mode functions or the arguments objects for calls to them f.caller // æŠ¥é”™ f.arguments // æŠ¥é”™&#125; åˆ é™¤å˜é‡æˆ–å±æ€§çš„é™åˆ¶12345678910111213141516&#x27;use strict&#x27;var a = 1delete a // æŠ¥é”™ï¼Œç¦æ­¢åˆ é™¤å˜é‡var obj = Object.create(null, &#123; &#x27;a&#x27;: &#123; value: 1, configurable: true &#125;, &#x27;b&#x27;: &#123; value: 2, configurable: false &#125;&#125;)// åªæœ‰ configurable ä¸º true çš„å¯¹è±¡å±æ€§æ‰èƒ½è¢«åˆ é™¤delete obj.a // æˆåŠŸdelete obj.b // å¤±è´¥ æ˜¾ç¤ºæŠ¥é”™æ­£å¸¸æ¨¡å¼ä¸‹æœ‰äº›è¡Œä¸ºä¼šå¤±è´¥ï¼Œä¸ä¼šæŠ¥é”™ï¼›ä¸¥æ ¼æ¨¡å¼ä¸‹å°†æŠ¥é”™ï¼Œæƒ…å†µå¦‚ä¸‹ï¼š å¯¹ä¸€ä¸ªå¯¹è±¡çš„åªè¯»å±æ€§èµ‹å€¼ å¯¹ä¸€ä¸ªåªä½¿ç”¨ getter æ–¹æ³•è¯»å–çš„å±æ€§èµ‹å€¼ å¯¹ç¦æ­¢æ‰©å±•çš„å¯¹è±¡æ·»åŠ æ–°å±æ€§ åˆ é™¤ä¸€ä¸ªä¸å¯åˆ é™¤çš„å±æ€§ é‡åçš„é”™è¯¯æƒ…å†µå¦‚ä¸‹ï¼š å¯¹è±¡ä¸èƒ½æœ‰é‡åçš„å±æ€§ å‡½æ•°ä¸èƒ½æœ‰é‡åçš„å‚æ•° 123456&#x27;use strict&#x27;var obj = &#123; p: 1, p: 2 &#125;function f(a, a, b) &#123;&#125; ç¦æ­¢å…«è¿›åˆ¶è¡¨ç¤ºæ³•123&quot;use strict&quot;;// æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œæ•´æ•°çš„ç¬¬ä¸€ä½å¦‚æœæ˜¯0ï¼Œè¡¨ç¤ºè¿™æ˜¯å…«è¿›åˆ¶æ•°var a = 0100; // è¯­æ³•é”™è¯¯ arguments å¯¹è±¡çš„é™åˆ¶arguments å¯¹è±¡æ˜¯æ‰€æœ‰éç®­å¤´å‡½æ•°ä¸­éƒ½å¯ç”¨çš„å±€éƒ¨å˜é‡ é™åˆ¶å¦‚ä¸‹ï¼š ä¸å…è®¸å¯¹ arguments èµ‹å€¼ arguments ä¸å†è¿½è¸ªå‚æ•°å˜åŒ– ç¦æ­¢ä½¿ç”¨ arguments.callee 12345678910111213141516171819202122232425262728&quot;use strict&quot;;// ä¸å…è®¸å¯¹ arguments èµ‹å€¼arguments++; // è¯­æ³•é”™è¯¯var obj = &#123; set p(arguments) &#123; &#125; &#125;; // è¯­æ³•é”™è¯¯try &#123; &#125; catch (arguments) &#123; &#125; // è¯­æ³•é”™è¯¯function arguments() &#123; &#125; // è¯­æ³•é”™è¯¯var f = new Function(&quot;arguments&quot;, &quot;&#x27;use strict&#x27;; return 17;&quot;); // è¯­æ³•é”™è¯¯// arguments ä¸å†è¿½è¸ªå‚æ•°å˜åŒ–function f(a) &#123; a = 2; return [a, arguments[0]];&#125;f(1); // æ­£å¸¸æ¨¡å¼ä¸º[2,2]function f(a) &#123; &quot;use strict&quot;; a = 2; return [a, arguments[0]];&#125;f(1); // ä¸¥æ ¼æ¨¡å¼ä¸º[2,1]// ç¦æ­¢ä½¿ç”¨ arguments.callee&quot;use strict&quot;;var f = function() &#123; // argumens.callee æŒ‡å‘å½“å‰æ‰§è¡Œçš„å‡½æ•° return arguments.callee; &#125;;f(); // æŠ¥é”™ å‡½æ•°ä¸èƒ½å£°æ˜åœ¨éå‡½æ•°çš„ä»£ç å—ä¸­1234&quot;use strict&quot;;if (true) &#123; function f() &#123; &#125; // è¯­æ³•é”™è¯¯&#125; æ–°å¢åŠ çš„ä¿ç•™å­—implements, interface, let, package, private, protected, public, static, yield ä¿ç•™å­—æ— æ³•ä½œä¸ºå˜é‡å"},{"title":"Javaå¹¶å‘å®¹å™¨ConcurrentLinkedQueueæºç è§£æ","date":"2021-10-29T06:35:18.520Z","updated":"2018-06-12T12:56:38.000Z","comments":true,"path":"back_posts/old_posts/Java å¹¶å‘å®¹å™¨ConcurrentLinkedQueue æºç è§£æ.html","permalink":"https://orechou.github.io/back_posts/old_posts/Java%20%E5%B9%B6%E5%8F%91%E5%AE%B9%E5%99%A8ConcurrentLinkedQueue%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.html","excerpt":"Javaæä¾›äº†å¤šç§å¹¶å‘é˜Ÿåˆ—ï¼Œå…·ä½“å¦‚ä¸‹ï¼š æ— é”éé˜»å¡é˜Ÿåˆ—ï¼šConcurrentLinkedQueue &amp; ConcurrentLinkedDeque æ™®é€šé˜»å¡é˜Ÿåˆ—ï¼šArrayBlockingQueue &amp; LinkedBlockingQuene &amp; LinkedBlockingDeque","text":"Javaæä¾›äº†å¤šç§å¹¶å‘é˜Ÿåˆ—ï¼Œå…·ä½“å¦‚ä¸‹ï¼š æ— é”éé˜»å¡é˜Ÿåˆ—ï¼šConcurrentLinkedQueue &amp; ConcurrentLinkedDeque æ™®é€šé˜»å¡é˜Ÿåˆ—ï¼šArrayBlockingQueue &amp; LinkedBlockingQuene &amp; LinkedBlockingDeque 1ã€ConcurrentLinkedQueueConcurrentLinkedQueueå’ŒConcurrentLinkedDequeæ˜¯æ— é”éé˜»å¡çš„ï¼Œå…¶å®ç°æ–¹å¼æ˜¯é€šè¿‡å¾ªç¯CASï¼ˆwait-freeç®—æ³•ï¼‰ã€‚å†…éƒ¨çš„æ•°æ®ç»“æ„æ˜¯é“¾è¡¨ï¼Œéƒ½æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œå®¹é‡æ˜¯æ— é™çš„ã€‚å…¶ size() éå†æ•´ä¸ªé˜Ÿåˆ—ç»Ÿè®¡ä¸ªæ•°ï¼Œä¸æ˜¯ä¸€ä¸ªO(1)æ—¶é—´çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›çš„å€¼ä¸èƒ½å‡†ç¡®çš„ååº”é˜Ÿåˆ—çš„å®é™…å¤§å°ã€‚ æºç åˆ†æhead &amp; tail èŠ‚ç‚¹head å’Œ tail å¹¶ä¸æ˜¯ä¸€å®šæŒ‡å‘æ•´ä¸ªé˜Ÿåˆ—çš„é¦–éƒ¨ï¼Œå’Œå°¾éƒ¨ã€‚å…¶æ»¡è¶³ä¸€äº›è§„åˆ™ï¼šä¸å˜æ€§å’Œå¯å˜æ€§ã€‚ 123456789101112131415161718192021222324252627/** * A node from which the first live (non-deleted) node (if any) * can be reached in O(1) time. * Invariantsï¼ˆä¸å˜æ€§ï¼‰: * - all live nodes are reachable from head via succ() ï¼ˆæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å¯ä»¥é€šè¿‡ head ä½¿ç”¨ succ() æ–¹æ³•å–å¾—ï¼‰ * - head != null ï¼ˆhead èŠ‚ç‚¹ä¸ä¸º nullï¼‰ * - (tmp = head).next != tmp || tmp != head ï¼ˆå…¶å®å°±æ˜¯ head.next != headï¼‰ * Non-invariants: * - head.item may or may not be null. ï¼ˆhead èŠ‚ç‚¹çš„å€¼å¯èƒ½ä¸ºnullï¼‰ * - it is permitted for tail to lag behind head, that is, for tail * to not be reachable from head! ï¼ˆå…è®¸ tail æ»åäº head, ä¹Ÿå°±æ˜¯è°ƒç”¨ succ() æ–¹æ³•, ä» head ä¸å¯è¾¾tailï¼‰ */ private transient volatile Node&lt;E&gt; head; /** * A node from which the last node on list (that is, the unique * node with node.next == null) can be reached in O(1) time. * Invariants: * - the last node is always reachable from tail via succ() ï¼ˆtail èŠ‚ç‚¹é€šè¿‡succ()æ–¹æ³•ä¸€å®šåˆ°è¾¾é˜Ÿåˆ—ä¸­çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹(node.next = null)ï¼‰ * - tail != null * Non-invariants: * - tail.item may or may not be null. ï¼ˆtail èŠ‚ç‚¹çš„å€¼å¯èƒ½ä¸ºnullï¼‰ * - it is permitted for tail to lag behind head, that is, for tail * to not be reachable from head! ï¼ˆå…è®¸ tail æ»åäº head, ä¹Ÿå°±æ˜¯è°ƒç”¨ succ() æ–¹æ³•, ä» head ä¸å¯è¾¾tailï¼‰ * - tail.next may or may not be self-pointing to tail. ï¼ˆtail.next å¯èƒ½æŒ‡å‘ tailï¼‰ */ private transient volatile Node&lt;E&gt; tail; å…¥é˜Ÿåˆ—offerå…ƒç´ å…¥é˜Ÿçš„ä¸»è¦çš„å·¥ä½œï¼š å°†å…¥é˜ŸèŠ‚ç‚¹è®¾ç½®æˆå½“å‰é˜Ÿåˆ—å°¾èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ æ›´æ–° tail èŠ‚ç‚¹ï¼ˆtailèŠ‚ç‚¹ä¸æ€»æ˜¯ä¸ºé˜Ÿå°¾èŠ‚ç‚¹ï¼Œå‡å°‘äº†CASæ›´æ–° tail èŠ‚ç‚¹çš„æ¬¡æ•°ï¼Œæé«˜å…¥é˜Ÿæ•ˆç‡ï¼‰ï¼š è‹¥ tail èŠ‚ç‚¹çš„nextèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†å…¥é˜ŸèŠ‚ç‚¹è®¾ç½®æˆ tail èŠ‚ç‚¹ è‹¥ tail èŠ‚ç‚¹çš„nextèŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™å°†å…¥é˜ŸèŠ‚ç‚¹è®¾ç½®æˆ tail çš„nextèŠ‚ç‚¹ 123456789101112131415161718192021222324252627282930313233public boolean offer(E e) &#123; checkNotNull(e); // æ ¹æ®ä¼ å…¥çš„å€¼æ„é€ èŠ‚ç‚¹ final Node&lt;E&gt; newNode = new Node&lt;E&gt;(e); // é€šè¿‡ tail èŠ‚ç‚¹æ‰¾åˆ°é˜Ÿåˆ—çš„å°¾èŠ‚ç‚¹ for (Node&lt;E&gt; t = tail, p = t;;) &#123; Node&lt;E&gt; q = p.next; // å®šä½pä¸ºé˜Ÿåˆ—çš„å°¾èŠ‚ç‚¹ if (q == null) &#123; // ä½¿ç”¨caså°†æ–°èŠ‚ç‚¹åŠ å…¥åˆ°é˜Ÿå°¾ // æ¯”è¾ƒpçš„nextæ˜¯å¦ä¸ºnullï¼Œä¸ºnullæ‰ä¼šè®¾ç½®æˆåŠŸã€‚è¿™é‡Œå®ç°äº†åŒæ­¥ï¼Œé˜²æ­¢äº†åˆ«äººå·²ç»ä¿®æ”¹äº†é˜Ÿå°¾ï¼Œè€Œè®¾ç½®äº†é”™è¯¯çš„ä½ç½® // ifå¦‚æœå¤±è´¥ï¼Œåˆ™ä¼šå¾ªç¯å†æ¬¡æ‰§è¡Œ if (p.casNext(null, newNode)) &#123; // æ’å…¥æˆåŠŸä¹‹åï¼Œåˆ¤æ–­é˜Ÿå°¾èŠ‚èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦æ˜¯tailèŠ‚ç‚¹ï¼Œè‹¥ä¸æ˜¯ï¼Œåˆ™å°†tailèŠ‚ç‚¹æŒ‡å‘é˜Ÿå°¾èŠ‚ç‚¹ if (p != t) // hop two nodes at a time casTail(t, newNode); // Failure is OK. return true; &#125; // Lost CAS race to another thread; re-read next &#125; else if (p == q) // We have fallen off list. If tail is unchanged, it // will also be off-list, in which case we need to // jump to head, from which all live nodes are always // reachable. Else the new tail is a better bet. // è¿™é‡Œçš„æƒ…å†µæ˜¯ p == p.nextï¼Œå¹¶ä¸”tä¸ºtailèŠ‚ç‚¹ã€‚è¡¨ç¤ºè¿™ä¸ªé˜Ÿåˆ—åˆšåˆå§‹åŒ–ï¼Œæ­£åœ¨å‡†å¤‡æ·»åŠ èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿”å›headèŠ‚ç‚¹ p = (t != (t = tail)) ? t : head; else // Check for tail updates after two hops. // é‡æ–°èµ‹å€¼pç»“ç‚¹ï¼Œè®©pæˆä¸ºå°¾èŠ‚ç‚¹ p = (p != t &amp;&amp; t != (t = tail)) ? t : q; &#125;&#125; å‡ºé˜Ÿpollå…ƒç´ å‡ºé˜Ÿçš„ä¸»è¦å·¥ä½œï¼š æ ¹æ® head èŠ‚ç‚¹æ‰¾åˆ°é˜Ÿåˆ—é¦–ä¸ªä¸ä¸ºç©ºçš„èŠ‚ç‚¹ï¼Œå¹¶CASè®©è¯¥èŠ‚ç‚¹å‡ºé˜Ÿ æ›´æ–° head èŠ‚ç‚¹ï¼ˆhead èŠ‚ç‚¹ä¸æ€»æ˜¯ä¸ºé˜Ÿé¦–èŠ‚ç‚¹ï¼Œå‡å°‘äº†CASæ›´æ–° head èŠ‚ç‚¹çš„æ¬¡æ•°ï¼Œæé«˜å…¥é˜Ÿæ•ˆç‡ï¼‰ï¼š è‹¥ head èŠ‚ç‚¹æœ‰å…ƒç´ ï¼Œä¸ä¼šæ›´æ–°headèŠ‚ç‚¹ è‹¥ head èŠ‚ç‚¹æ²¡æœ‰å…ƒç´ ï¼Œå°† head æŒ‡å‘é˜Ÿåˆ—çš„é¦–èŠ‚ç‚¹ 123456789101112131415161718192021222324252627282930public E poll() &#123; restartFromHead: for (;;) &#123; for (Node&lt;E&gt; h = head, p = h, q;;) &#123; E item = p.item; // è‹¥å¤´èŠ‚ç‚¹çš„å€¼ä¸ä¸ºç©ºï¼Œå¹¶ä¸”casè®¾ç½®å¤´èŠ‚ç‚¹å€¼ä¸ºnullæˆåŠŸ if (item != null &amp;&amp; p.casItem(item, null)) &#123; // Successful CAS is the linearization point // for item to be removed from this queue. // è‹¥å½“å‰èŠ‚ç‚¹ä¸æ˜¯ head èŠ‚ç‚¹ if (p != h) // hop two nodes at a time // è‹¥å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°† head èŠ‚ç‚¹æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦è€…æŒ‡å‘å½“å‰èŠ‚ç‚¹ updateHead(h, ((q = p.next) != null) ? q : p); // è¿”å›å‡ºé˜Ÿçš„å€¼ return item; &#125; // è‹¥å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™è¯¥é˜Ÿåˆ—å·²ç©ºï¼Œé‡æ–°è®¾ç½® head èŠ‚ç‚¹ï¼Œå¹¶è¿”å›null else if ((q = p.next) == null) &#123; updateHead(h, p); return null; &#125; // è¯¥æƒ…å†µä¸ºï¼Œpæ˜¯å·²ç»åˆ é™¤çš„ head èŠ‚ç‚¹ï¼Œç»§ç»­å¾ªç¯ else if (p == q) continue restartFromHead; else // é‡æ–°èµ‹å€¼pèŠ‚ç‚¹ p = q; &#125; &#125; &#125; ä½¿ç”¨åœºæ™¯å› ä¸ºå…¶é‡‡ç”¨çš„æ˜¯æ— é”çš„æ–¹å¼ï¼Œæ‰€ä»¥èƒ½å¤Ÿæ»¡è¶³é«˜å¹¶å‘æƒ…å†µä¸‹çš„éœ€æ±‚ï¼Œå…¶æ€§èƒ½ä¼˜äºBlockingQueueã€‚ç¼ºç‚¹åœ¨äºå…¶size()æ–¹æ³•ä¸ºä¸€ä¸ªO(n)æ—¶é—´å¤æ‚åº¦çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›çš„å€¼å¹¶ä¸æ˜¯ä¸€ä¸ªå‡†ç¡®çš„å€¼ï¼Œæ‰€ä»¥åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ— æ³•æœ‰æ•ˆè·å–é˜Ÿåˆ—ä¸­èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚"},{"title":"July-9-2016","date":"2021-10-29T06:35:18.520Z","updated":"2016-07-09T13:26:52.000Z","comments":true,"path":"back_posts/old_posts/July-9-2016.html","permalink":"https://orechou.github.io/back_posts/old_posts/July-9-2016.html","excerpt":"","text":"è·ç¦»ä¸Šç¯‡åšæ–‡å·²ç»è¿‡å»äº†ä¸¤ä¸ªæœˆï¼Œå¯»æ€å†ä¸æ›´æ–°äº›ä»€ä¹ˆï¼Œè¿™ä¸ªBlogçš„æ„ä¹‰ä¹Ÿå°±ä¸åœ¨äº†ã€‚ä»Šæ—¥ä¸æ›´æ–°ï¼Œä»¥åä¹Ÿä¸ä¼šæ›´æ–°äº†ã€‚è¿™ä¸¤ä¸ªæœˆï¼Œæ¯•ä¸šã€çº¦ä¼šã€åšé¡¹ç›®ï¼Œå¦å¤–è¿˜å»äº†ä¸€è¶Ÿæ¾³é—¨ã€‚å¾ˆæ„Ÿè°¢æˆ‘çš„å¯¼å¸ˆâ€”â€”è‘›è€å¸ˆå¸¦ç»™çš„è¿™æ¬¡æœºä¼šï¼Œå»è§è¯†äº†ä¸€ä¸‹æ¾³é—¨çš„èµŒåœºå’Œä¸€äº›ä¼˜ç§€çš„è®¡ç®—æœºideaã€‚ å…³äºé¡¹ç›®ä»äº”æœˆä»½å¼€å§‹åšçš„é¡¹ç›®æ˜¯ä¸ºé‡åº†å¸‚åŸå¸‚å»ºè®¾å‘å±•æœ‰é™å…¬å¸åšçš„ä¸€ä¸ªé¡¹ç›®ç®¡ç†webè½¯ä»¶ã€‚ä»æœ€å¼€å§‹æ¥è§¦ternæ¡†æ¶å¼€å§‹ï¼Œå†æ…¢æ…¢æ¥è§¦ä¸šåŠ¡é€»è¾‘ï¼Œåˆ°åé¢å¯¹é¡¹ç›®çš„æ€è€ƒã€‚è¿™ä¸€ä¸ªå¤šæœˆè¿˜æ˜¯æŒºæœ‰æ”¶è·ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š1ã€å‚ä¸äº†å®Œæ•´çš„é¡¹ç›®å¼€å‘ï¼›2ã€é”»ç‚¼äº†å‰ç«¯ä¸åç«¯çš„ç¼–ç¨‹èƒ½åŠ›ï¼ˆä»é¡µé¢è®¾è®¡åˆ°æœåŠ¡å™¨APIçš„ç¼–å†™ï¼‰ï¼›3ã€æ¡†æ¶åº•å±‚ä»£ç çš„é˜…è¯»ï¼ˆè‡ªå·±è°ƒè¯•bugçš„æ—¶å€™ï¼Œä¼šæ·±å…¥å»çœ‹ä¸€çœ‹æ¡†æ¶åº•å±‚çš„ä»£ç ã€‚ä¾‹å¦‚ï¼šæ•°æ®åº“çš„å†æ¬¡å°è£…çš„ä»£ç ï¼›çº¿ç¨‹æ± åˆ†é…çš„ä»£ç ï¼‰ã€‚æ˜¨å¤©å¸¦ç€é¡¹ç›®ç®€é™‹ç‰ˆæœ¬å»ä¸šä¸»æ–¹å±•ç¤ºï¼Œå¯¹äºä¸šä¸»æ–¹çš„éœ€æ±‚ï¼Œç›®å‰çš„web appè¿˜æœ‰å¾ˆå¤šä¸œè¥¿è¦å»å®ç°ã€‚ å…³äºæ¯•ä¸šæ¯•ä¸šåªæœ‰å‡ å¥è¯è¯´ã€‚å¤©ä¹‹æ¶¯ï¼Œåœ°ä¹‹è§’ï¼ŒçŸ¥äº¤åŠé›¶è½ã€‚ä¸€å£¶æµŠé…’å°½é¦€æ¬¢ï¼Œä»Šå®µåˆ«æ¢¦å¯’ã€‚ç¥å„ä½å‰ç¨‹ä¼¼é”¦ï¼Œçé‡ã€‚ å…³äºæ¾³é—¨æ­¤æ¬¡å»æ¾³é—¨æ˜¯å‚åŠ æ³›ç ä¸‰è§’è®¡ç®—æœºä½œå“èµ›ã€‚è®¤è¯†äº†å‡ ä½ç§‘æŠ€å­¦é™¢çš„åŒå­¦ï¼Œè§è¯†äº†èµŒåœºã€‚è‘›è€å¸ˆè¿˜è¯·åƒäº†çŒªæ‰’åŒ…å’Œæ¾³é—¨è›‹æŒã€‚ğŸ˜„"},{"title":"Linux å‘½ä»¤åŸºç¡€","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-15T07:19:41.000Z","comments":true,"path":"back_posts/old_posts/Linux å‘½ä»¤åŸºç¡€.html","permalink":"https://orechou.github.io/back_posts/old_posts/Linux%20%E5%91%BD%E4%BB%A4%E5%9F%BA%E7%A1%80.html","excerpt":"Linux åŸºç¡€å‘½ä»¤æ˜¯ä»»ä½•ä¸€ä¸ªå¼€å‘äººå‘˜åº”è¯¥æŒæ¡çš„åŸºæœ¬æŠ€èƒ½ã€‚å¤§å¤šæ•°é¡¹ç›®çš„ç”Ÿäº§éƒ¨ç½²ç¯å¢ƒéƒ½ä¼šé€‰æ‹© Linuxï¼Œæ‰€ä»¥åœ¨é¡¹ç›®è¿ç»´å’Œæ•…éšœæ’é™¤çš„æ—¶å€™ï¼ŒLinux å‘½ä»¤èƒ½å¤Ÿèµ·åˆ°å…³é”®çš„ä½œç”¨ã€‚","text":"Linux åŸºç¡€å‘½ä»¤æ˜¯ä»»ä½•ä¸€ä¸ªå¼€å‘äººå‘˜åº”è¯¥æŒæ¡çš„åŸºæœ¬æŠ€èƒ½ã€‚å¤§å¤šæ•°é¡¹ç›®çš„ç”Ÿäº§éƒ¨ç½²ç¯å¢ƒéƒ½ä¼šé€‰æ‹© Linuxï¼Œæ‰€ä»¥åœ¨é¡¹ç›®è¿ç»´å’Œæ•…éšœæ’é™¤çš„æ—¶å€™ï¼ŒLinux å‘½ä»¤èƒ½å¤Ÿèµ·åˆ°å…³é”®çš„ä½œç”¨ã€‚ è·å–æ–‡ä»¶å†…å®¹åŸºæœ¬æŒ‡ä»¤ å‘½ä»¤ æè¿° å¤‡æ³¨ cat æ‰“å°æ–‡ä»¶å†…å®¹ -n: æ‰“å°å‡ºè¡Œå·ï¼›-b: ä¸æ‰“å°å‡ºè¡Œå· tac æ˜¯ cat çš„åå‘æ“ä½œï¼Œä»æœ€åä¸€è¡Œå¼€å§‹æ‰“å° more ä¸€é¡µä¸€é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæ¯”è¾ƒé€‚åˆå¤§æ–‡ä»¶çš„æŸ¥çœ‹ less å’Œ more ç±»ä¼¼ï¼Œä½†æ˜¯å¤šäº†ä¸€ä¸ªå‘å‰ç¿»é¡µçš„åŠŸèƒ½ head æ‰“å°æ–‡ä»¶å‰å‡ è¡Œ head -n filename tail head çš„åå‘æ“ä½œï¼Œæ‰“å°åå‡ è¡Œ od ä»¥å­—ç¬¦æˆ–è€…åå…­è¿›åˆ¶çš„å½¢å¼æ˜¾ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶ æŒ‡ä»¤ &amp; æ–‡ä»¶æœç´¢åŸºæœ¬æŒ‡ä»¤ å‘½ä»¤ æè¿° å¤‡æ³¨ which æŒ‡ä»¤æœç´¢ -a: åˆ—å‡ºæ‰€æœ‰æŒ‡ä»¤ï¼Œè€Œä¸æ˜¯åˆ—å‡ºä¸€ä¸ª whereis æ–‡ä»¶æœç´¢ã€‚é€Ÿåº¦éå¸¸å¿«ï¼Œ åªæœç´¢å‡ ä¸ªç‰¹å®šçš„ç›®å½• locate æ–‡ä»¶æœç´¢ã€‚å¯ä»¥ç”¨å…³é”®å­—æˆ–è€…æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæœç´¢ find æ–‡ä»¶æœç´¢ã€‚å¯ä»¥ä½¿ç”¨æ–‡ä»¶çš„å±æ€§å’Œæƒé™è¿›è¡Œæœç´¢ find æŒ‡ä»¤è¯¦è§£æŒ‡ä»¤çš„åŸºç¡€ç”¨æ³•å¦‚ä¸‹ï¼š 12# find [basedir] [option] // basedir ä¸æŒ‡å®šåˆ™ä¸ºå½“å‰ç›®å½•ï¼ŒåŠå…¶å­ç›®å½•find . -name &quot;shadow*&quot; æŒ‰ä¿®æ”¹æ—¶é—´æœç´¢çš„å‚æ•°1234-mtime n ï¼šåˆ—å‡ºåœ¨ n å¤©å‰çš„é‚£ä¸€å¤©ä¿®æ”¹è¿‡å†…å®¹çš„æ–‡ä»¶-mtime +n ï¼šåˆ—å‡ºåœ¨ n å¤©ä¹‹å‰ (ä¸å« n å¤©æœ¬èº«) ä¿®æ”¹è¿‡å†…å®¹çš„æ–‡ä»¶-mtime -n ï¼šåˆ—å‡ºåœ¨ n å¤©ä¹‹å†… (å« n å¤©æœ¬èº«) ä¿®æ”¹è¿‡å†…å®¹çš„æ–‡ä»¶-newer file ï¼š åˆ—å‡ºæ¯” file æ›´æ–°çš„æ–‡ä»¶ æŒ‰æ–‡ä»¶æ‰€å±æœç´¢çš„å‚æ•°123456-uid n-gid n-user name-group name-nouser ï¼šæœç´¢æ‹¥æœ‰è€…ä¸å­˜åœ¨äº /etc/passwd çš„æ–‡ä»¶-nogroupï¼šæœç´¢æ‰€å±ç¾¤ç»„ä¸å­˜åœ¨äº /etc/group çš„æ–‡ä»¶ æŒ‰æ–‡ä»¶å±æ€§æœç´¢çš„å‚æ•°123456-name filename-size [+-]SIZEï¼šæœå¯»æ¯” SIZE è¿˜è¦å¤§ (+) æˆ–å° (-) çš„æ–‡ä»¶ã€‚è¿™ä¸ª SIZE çš„è§„æ ¼æœ‰ï¼šc: ä»£è¡¨ byteï¼Œk: ä»£è¡¨ 1024bytesã€‚æ‰€ä»¥ï¼Œè¦æ‰¾æ¯” 50KB è¿˜è¦å¤§çš„æ–‡ä»¶ï¼Œå°±æ˜¯ -size +50k-type TYPE-perm mode ï¼šæœç´¢æƒé™ç­‰äº mode çš„æ–‡ä»¶-perm -mode ï¼šæœç´¢æƒé™åŒ…å« mode çš„æ–‡ä»¶-perm /mode ï¼šæœç´¢æƒé™åŒ…å«ä»»ä¸€ mode çš„æ–‡ä»¶ æ­£åˆ™è¡¨è¾¾å¼åŸºæœ¬æŒ‡ä»¤ æŒ‡ä»¤ æè¿° å¤‡æ³¨ grep ä½¿ç”¨æ­£åˆ™è¡¨ç¤ºå¼è¿›è¡Œå…¨å±€æŸ¥æ‰¾å¹¶æ‰“å° printf ç”¨äºæ ¼å¼åŒ–è¾“å‡º åœ¨ç»™ printf ä¼ æ•°æ®æ—¶éœ€è¦ä½¿ç”¨ $( ) å½¢å¼ awk æ¯æ¬¡å¤„ç†ä¸€è¡Œï¼Œå¤„ç†çš„æœ€å°å•ä½æ˜¯å­—æ®µ grep è¯¦è§£æŒ‡ä»¤ grep ï¼ˆglobally search a regular expression and printï¼‰çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š 123456$ grep [-acinv] [--color=auto] æœå¯»å­—ç¬¦ä¸² filename-c ï¼š ç»Ÿè®¡ä¸ªæ•°-i ï¼š å¿½ç•¥å¤§å°å†™-n ï¼š è¾“å‡ºè¡Œå·-v ï¼š åå‘é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºå‡ºæ²¡æœ‰ æœå¯»å­—ç¬¦ä¸² å†…å®¹çš„é‚£ä¸€è¡Œ--color=auto ï¼šæ‰¾åˆ°çš„å…³é”®å­—åŠ é¢œè‰²æ˜¾ç¤º ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567# test.txt çš„å†…å®¹å¦‚ä¸‹hello world123aaaaa$ gerp -n &#x27;world&#x27; test.txt1:hello world awk è¯¦è§£æŒ‡ä»¤ awk çš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š 1$ awk &#x27;&#123;[pattern] action&#125;&#x27; &#123;filenames&#125; æ¯æ¬¡å¤„ç†è¾“å…¥æµä¸­çš„ä¸€è¡Œï¼Œç„¶åæ ¹æ®è®¾ç½®çš„æ¡ä»¶åŒ¹é…ç›¸åº”çš„å­—æ®µï¼Œç„¶ååšå¤„ç†ã€‚ awk å˜é‡ï¼š å˜é‡å ä»£è¡¨æ„ä¹‰ NF æ¯ä¸€è¡Œæ‹¥æœ‰çš„å­—æ®µæ€»æ•° NR ç›®å‰æ‰€å¤„ç†çš„æ˜¯ç¬¬å‡ è¡Œæ•°æ® FS ç›®å‰çš„åˆ†éš”å­—ç¬¦ï¼Œé»˜è®¤æ˜¯ç©ºæ ¼é”® ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415# å–å‡ºç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åå’Œ IP$ last -n 5dmtsai pts/0 192.168.1.100 Tue Jul 14 17:32 still logged indmtsai pts/0 192.168.1.100 Thu Jul 9 23:36 - 02:58 (03:22)dmtsai pts/0 192.168.1.100 Thu Jul 9 17:23 - 23:36 (06:12)dmtsai pts/0 192.168.1.100 Thu Jul 9 08:02 - 08:17 (00:14)dmtsai tty1 Fri May 29 11:55 - 12:11 (00:15)# $1, $3 ä»£è¡¨äº†ç¬¬å‡ ä¸ªæ®µï¼Œæ¯è¡Œæ ¹æ®ç©ºæ ¼å’Œtabæ¥åˆ’åˆ†æ®µ$ last -n 5 | awk &#x27;&#123;print $1 &quot;\\t lines: &quot; NR &quot;\\t columns: &quot; NF&#125;&#x27;dmtsai lines: 1 columns: 10dmtsai lines: 2 columns: 10dmtsai lines: 3 columns: 10dmtsai lines: 4 columns: 10dmtsai lines: 5 columns: 9 Pipeline æŒ‡ä»¤ç®¡çº¿æŒ‡ä»¤ | å°†ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ï¼Œåœ¨æ•°æ®éœ€è¦ç»è¿‡å¤šä¸ªæ­¥éª¤çš„å¤„ç†ä¹‹åæ‰èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹æ—¶å°±å¯ä»¥ä½¿ç”¨ Pipelineã€‚ ä¸‹é¢çš„æŒ‡ä»¤é€šå¸¸ä¸ç®¡çº¿æŒ‡ä»¤æ­é…ä½¿ç”¨ï¼Œå°†å…¶å®ƒæŒ‡ä»¤çš„è¾“å‡ºä½œä¸ºæŒ‡ä»¤çš„è¾“å…¥ã€‚ å­—ç¬¦è½¬æ¢åŸºæœ¬æŒ‡ä»¤ æŒ‡ä»¤ æè¿° å¤‡æ³¨ tr åˆ é™¤ä¸€è¡Œä¸­çš„å­—ç¬¦ï¼Œæˆ–è€…å¯¹å­—ç¬¦è¿›è¡Œæ›¿æ¢ col å°† tab å­—ç¬¦è½¬ä¸ºç©ºæ ¼å­—ç¬¦ expand å°† tab è½¬æ¢ä¸€å®šæ•°é‡çš„ç©ºæ ¼ï¼Œé»˜è®¤æ˜¯ 8 ä¸ª join å°†æœ‰ç›¸åŒæ•°æ®çš„é‚£ä¸€è¡Œåˆå¹¶åœ¨ä¸€èµ· paste ç›´æ¥å°†ä¸¤è¡Œç²˜è´´åœ¨ä¸€èµ· split å°†ä¸€ä¸ªæ–‡ä»¶åˆ’åˆ†æˆå¤šä¸ªæ–‡ä»¶ cut æŒ‡ä»¤cut å¯¹æ•°æ®è¿›è¡Œä¸€è¡Œä¸€è¡Œçš„åˆ‡åˆ†ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 1234$ cut -d-d ï¼šåˆ†éš”ç¬¦-f ï¼šç»è¿‡ -d åˆ†éš”åï¼Œä½¿ç”¨ -f n å–å‡ºç¬¬ n ä¸ªåŒºé—´-c ï¼šä»¥å­—ç¬¦ä¸ºå•ä½å–å‡ºåŒºé—´ sort æŒ‡ä»¤sort å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 123456789$ sort [options] [file &amp; stdin] -f ï¼šå¿½ç•¥å¤§å°å†™-b ï¼šå¿½ç•¥æœ€å‰é¢çš„ç©ºæ ¼-M ï¼šä»¥æœˆä»½çš„åå­—æ¥æ’åºï¼Œä¾‹å¦‚ JANï¼ŒDEC-n ï¼šä½¿ç”¨æ•°å­—-r ï¼šåå‘æ’åº-u ï¼šç›¸å½“äº uniqueï¼Œé‡å¤çš„å†…å®¹åªå‡ºç°ä¸€æ¬¡-t ï¼šåˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸º tab-k ï¼šæŒ‡å®šæ’åºçš„åŒºé—´ uniq æŒ‡ä»¤uniq åªå°†é‡å¤çš„æ•°æ®è¯»å–ä¸€æ¬¡ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 123$ uniq [-ic]-i ï¼šå¿½ç•¥å¤§å°å†™-c ï¼šè¿›è¡Œè®¡æ•° tee æŒ‡ä»¤è¾“å‡ºé‡å®šå‘ä¼šå°†è¾“å‡ºå†…å®¹é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ï¼Œè€Œ tee ä¸ä»…èƒ½å¤Ÿå®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œè¿˜èƒ½ä¿ç•™å±å¹•ä¸Šçš„è¾“å‡ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨ tee æŒ‡ä»¤ï¼Œä¸€ä¸ªè¾“å‡ºä¼šåŒæ—¶ä¼ é€åˆ°æ–‡ä»¶å’Œå±å¹•ä¸Šã€‚ è¿›ç¨‹ç®¡ç†åŸºæœ¬æŒ‡ä»¤ æŒ‡ä»¤ æè¿° å¤‡æ³¨ ps æŸ¥çœ‹æŸä¸ªæ—¶é—´ç‚¹çš„è¿›ç¨‹ä¿¡æ¯ -l: æŸ¥çœ‹è‡ªå·±çš„è¿›ç¨‹ï¼›-aux: æŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ top å®æ—¶æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯ pstree æŸ¥çœ‹è¿›ç¨‹æ ‘ netstat æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹ æŸ¥çœ‹ç‰¹å®šç«¯å£çš„è¿›ç¨‹ï¼šnetstat -anp | grep port è¿›ç¨‹çŠ¶æ€åœ¨ Linux ä¸­è¿›ç¨‹ä¸€å…±æœ‰ 6 ç§çŠ¶æ€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š çŠ¶æ€ è¯´æ˜ R running or runnable (on run queue) D uninterruptible sleep (usually I/O) S interruptible sleep (waiting for an event to complete) Z zombie (terminated but not reaped by its parent) T stopped (either by a job control signal or because it is being traced) X dead (should never be seen) å¸¸ç”¨æŒ‡ä»¤æŸ¥çœ‹ç¨‹åºå¯¹åº”çš„è¿›ç¨‹å·ps -ef|grep è¿›ç¨‹å æŸ¥çœ‹è¿›ç¨‹å ç”¨çš„ç«¯å£å·netstat -anp|grep pid æŸ¥çœ‹ç«¯å£å·æ‰€å¯¹åº”çš„è¿›ç¨‹å·lsof -i:ç«¯å£å· æ•°æ®æµé‡å®šå‘é‡å®šå‘æŒ‡çš„æ˜¯ä½¿ç”¨æ–‡ä»¶ä»£æ›¿æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚ æè¿° ä»£ç  è¿ç®—ç¬¦ æ ‡å‡†è¾“å…¥ (stdin) 0 &lt; æˆ– &lt;&lt; æ ‡å‡†è¾“å‡º (stdout) 1 &gt; æˆ– &gt;&gt; æ ‡å‡†é”™è¯¯è¾“å‡º (stderr) 2 2&gt; æˆ– 2&gt;&gt; æ³¨æ„ï¼š ä¸€ä¸ªç®­å¤´çš„è¡¨ç¤ºä»¥è¦†ç›–çš„æ–¹å¼é‡å®šå‘ï¼Œä¸¤ä¸ªç®­å¤´çš„è¡¨ç¤ºä»¥è¿½åŠ çš„æ–¹å¼é‡å®šå‘ã€‚ å¯ä»¥å°†ä¸éœ€è¦çš„æ ‡å‡†è¾“å‡ºä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ° /dev/nullï¼Œç›¸å½“äºæ‰”è¿›åƒåœ¾ç®±ã€‚ å¦‚æœéœ€è¦å°†æ ‡å‡†è¾“å‡ºä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºåŒæ—¶é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œéœ€è¦å°†æŸä¸ªè¾“å‡ºè½¬æ¢ä¸ºå¦ä¸€ä¸ªè¾“å‡ºã€‚ä¾‹å¦‚ 2&gt;&amp;1 è¡¨ç¤ºå°†æ ‡å‡†é”™è¯¯è¾“å‡ºè½¬æ¢ä¸ºæ ‡å‡†è¾“å‡ºã€‚ æŒ‡ä»¤æœç´¢çš„é¡ºåºåœ¨ç±» Unix æ“ä½œç³»ç»Ÿä¸­ï¼ŒæŒ‰ç…§å¦‚ä¸‹çš„é¡ºåºæœç´¢æŒ‡ä»¤ï¼š ä»¥ç»å¯¹æˆ–ç›¸å¯¹è·¯å¾„æ¥æ‰§è¡ŒæŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š/bin/ls æˆ–è€… ./ls ç”±åˆ«åæ‰¾åˆ°è¯¥æŒ‡ä»¤æ¥æ‰§è¡Œ ç”± Bash å†…å»ºçš„æŒ‡ä»¤æ¥æ‰§è¡Œ æŒ‰ PATH å˜é‡æŒ‡å®šçš„æœç´¢è·¯å¾„çš„é¡ºåºæ¥æ‰¾åˆ°æŒ‡ä»¤æ¥æ‰§è¡Œ"},{"title":"JavaScript MVVM åŒå‘ç»‘å®šçš„å®ç°","date":"2021-10-29T06:35:18.520Z","updated":"2018-06-20T14:02:15.000Z","comments":true,"path":"back_posts/old_posts/MVVMåŒå‘ç»‘å®šçš„å®ç°.html","permalink":"https://orechou.github.io/back_posts/old_posts/MVVM%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E7%9A%84%E5%AE%9E%E7%8E%B0.html","excerpt":"è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•å­¦ä¹  JS åŒå‘ç»‘å®šè¿‡ç¨‹ä¸­çš„ä¸€äº›æ¦‚å¿µä¸å…·ä½“çš„å®ç° MVVM å…·ä½“æ¦‚å¿µMVVM ä¸­æœ‰ä¸€äº›æ¦‚å¿µæ˜¯é€šç”¨çš„ï¼Œå…·ä½“å¦‚ä¸‹ Directive ï¼ˆæŒ‡ä»¤ï¼‰è‡ªå®šä¹‰çš„æ‰§è¡Œå‡½æ•°ï¼Œä¾‹å¦‚ Vue ä¸­çš„ v-clickã€v-bind ç­‰ã€‚è¿™äº›å‡½æ•°å°è£…äº† DOM çš„ä¸€äº›åŸºæœ¬å¯å¤ç”¨å‡½æ•°APIã€‚","text":"è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•å­¦ä¹  JS åŒå‘ç»‘å®šè¿‡ç¨‹ä¸­çš„ä¸€äº›æ¦‚å¿µä¸å…·ä½“çš„å®ç° MVVM å…·ä½“æ¦‚å¿µMVVM ä¸­æœ‰ä¸€äº›æ¦‚å¿µæ˜¯é€šç”¨çš„ï¼Œå…·ä½“å¦‚ä¸‹ Directive ï¼ˆæŒ‡ä»¤ï¼‰è‡ªå®šä¹‰çš„æ‰§è¡Œå‡½æ•°ï¼Œä¾‹å¦‚ Vue ä¸­çš„ v-clickã€v-bind ç­‰ã€‚è¿™äº›å‡½æ•°å°è£…äº† DOM çš„ä¸€äº›åŸºæœ¬å¯å¤ç”¨å‡½æ•°APIã€‚ Filter ï¼ˆè¿‡æ»¤å™¨ï¼‰ç”¨æˆ·å¸Œæœ›å¯¹ä¼ å…¥çš„åˆå§‹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œç„¶åå°†å¤„ç†ç»“æœäº¤ç»™ Directive æˆ–è€…ä¸‹ä¸€ä¸ª Filterã€‚ä¾‹å¦‚ï¼šv-bind=â€time | formatTimeâ€ã€‚formatTime æ˜¯å°† time è½¬æ¢æˆæŒ‡å®šæ ¼å¼çš„ Filter å‡½æ•°ã€‚ è¡¨è¾¾å¼ç±»ä¼¼å‰ç«¯æ™®é€šçš„é¡µé¢æ¨¡æ¿è¡¨è¾¾å¼ï¼Œä½œç”¨æ˜¯æ§åˆ¶é¡µé¢å†…å®¹å®‰è£…å…·ä½“çš„æ¡ä»¶æ˜¾ç¤ºã€‚ä¾‹å¦‚ï¼šifâ€¦else ç­‰ ViewModelä¼ å…¥çš„ Model æ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾ï¼Œæä¾›ä¸€äº›åŸºæœ¬çš„æ“ä½œ API ç»™å¼€å‘è€…ï¼Œä½¿å…¶èƒ½å¤Ÿå¯¹æ•°æ®è¿›è¡Œè¯»å–ä¸ä¿®æ”¹ åŒå‘ç»‘å®šï¼ˆæ•°æ®å˜æ›´æ£€æµ‹ï¼‰View å±‚çš„å˜åŒ–æ”¹å˜ Modelï¼šé€šè¿‡ç»™å…ƒç´ æ·»åŠ  onchange äº‹ä»¶æ¥è§¦å‘å¯¹ Model æ•°æ®è¿›è¡Œä¿®æ”¹ Model å±‚çš„å˜åŒ–æ”¹å˜ Viewï¼š æ‰‹åŠ¨è§¦å‘ç»‘å®š è„æ•°æ®æ£€æµ‹ å¯¹è±¡åŠ«æŒ Proxy å®ç°æ–¹å¼æ‰‹åŠ¨è§¦å‘ç»‘å®šå³ Model å¯¹è±¡æ”¹å˜ä¹‹åï¼Œéœ€è¦æ˜¾ç¤ºçš„å»è§¦å‘ View çš„æ›´æ–° é¦–å…ˆç¼–å†™ HTML é¡µé¢ 1234567891011121314&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;title&gt;Two way binding&lt;/title&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ªå…ƒç´ ï¼Œinput å…ƒç´ ç”¨äºæ¥å—ç”¨æˆ·è¾“å…¥ï¼Œspan å…ƒç´ ç”¨äºæ˜¾ç¤º --&gt; &lt;input q-value=&quot;value&quot; type=&quot;text&quot; id=&quot;input&quot;&gt; &lt;span q-text=&quot;value&quot; id=&quot;el&quot;&gt;&lt;/span&gt;&lt;/body&gt;&lt;script src=&quot;way_1.js&quot;&gt;&lt;/script&gt;&lt;/html&gt; ç¼–å†™å®ç° MVVM çš„ ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// Manual triggerlet elems = [document.getElementById(&#x27;el&#x27;), document.getElementById(&#x27;input&#x27;)]// æ•°æ® Modellet data = &#123; value: &#x27;hello&#x27;&#125;// å®šä¹‰ Directivelet directive = &#123; text: function(text) &#123; this.innerHTML = text &#125;, value: function(value) &#123; this.setAttribute(&#x27;value&#x27;, value) this.value = value &#125;&#125;// æ‰«ææ‰€æœ‰çš„å…ƒç´ function scan() &#123; // æ‰«æå¸¦æŒ‡ä»¤çš„èŠ‚ç‚¹å±æ€§ for (let elem of elems) &#123; elem.directive = [] for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf(&#x27;q-&#x27;) &gt;= 0) &#123; directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) elem.directive.push(attr.nodeName.slice(2)) &#125; &#125; &#125;&#125;// ViewModel æ›´æ–°å‡½æ•°function ViewModelSet(key, value) &#123; // ä¿®æ”¹æ•°æ®å¯¹è±¡å data[key] = value // æ‰‹åŠ¨åœ°å»è§¦å‘ View çš„ä¿®æ”¹ scan()&#125;// View ç»‘å®šç›‘å¬elems[1].addEventListener(&#x27;keyup&#x27;, function(e) &#123; ViewModelSet(&#x27;value&#x27;, e.target.value)&#125;, false)// -------- ç¨‹åºæ‰§è¡Œ -------scan()setTimeout(() =&gt; &#123; ViewModelSet(&#x27;value&#x27;, &#x27;hello world&#x27;)&#125;, 1000); æ•°æ®åŠ«æŒæ•°æ®åŠ«æŒæ˜¯ç›®å‰æ¯”è¾ƒå¹¿æ³›çš„æ–¹å¼ï¼ŒVue çš„åŒå‘ç»‘å®šå°±æ˜¯é€šè¿‡æ•°æ®åŠ«æŒå®ç°ã€‚å®ç°æ–¹å¼æ˜¯é€šè¿‡ Object.defineProperty å’Œ Object.defineProperies æ–¹æ³•å¯¹ Model å¯¹è±¡çš„ get å’Œ set å‡½æ•°è¿›è¡Œç›‘å¬ã€‚å½“æœ‰æ•°æ®è¯»å–æˆ–èµ‹å€¼æ“ä½œæ—¶ï¼Œæ‰«æï¼ˆæˆ–è€…é€šçŸ¥ï¼‰å¯¹åº”çš„å…ƒç´ æ‰§è¡Œ Directive å‡½æ•°ï¼Œå®ç° View çš„åˆ·æ–°ã€‚ HTML çš„ä»£ç ä¸å˜ï¼Œjs ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// Hijackinglet elems = [document.getElementById(&#x27;el&#x27;), document.getElementById(&#x27;input&#x27;)]let data = &#123; value: &#x27;hello&#x27;&#125;// å®šä¹‰ Directivelet directive = &#123; text: function(text) &#123; this.innerHTML = text &#125;, value: function(value) &#123; this.setAttribute(&#x27;value&#x27;, value) this.value = value &#125;&#125;// å®šä¹‰å¯¹è±¡å±æ€§è®¾ç½®åŠ«æŒ// obj: æŒ‡å®šçš„ Model æ•°æ®å¯¹è±¡// propName: æŒ‡å®šçš„å±æ€§åç§°function defineGetAndSet(obj, propName) &#123; let bValue // ä½¿ç”¨ Object.defineProperty åšæ•°æ®åŠ«æŒ Object.defineProperty(obj, propName, &#123; get: function() &#123; return bValue &#125;, set: function(value) &#123; bValue = value // åœ¨ vue ä¸­ï¼Œè¿™é‡Œä¸ä¼šå»æ‰«ææ‰€æœ‰çš„å…ƒç´ ï¼Œè€Œæ˜¯é€šè¿‡è®¢é˜…å‘å¸ƒæ¨¡å¼ï¼Œé€šçŸ¥é‚£äº›è®¢é˜…äº†è¯¥æ•°æ®çš„ view è¿›è¡Œæ›´æ–° scan() &#125;, enumerable: true, configurable: true &#125;)&#125;// View ç»‘å®šç›‘å¬elems[1].addEventListener(&#x27;keyup&#x27;, function(e) &#123; data.value = e.target.value&#125;, false)// æ‰«ææ‰€æœ‰çš„å…ƒç´ function scan() &#123; // æ‰«æå¸¦æŒ‡ä»¤çš„èŠ‚ç‚¹å±æ€§ for (let elem of elems) &#123; elem.directive = [] for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf(&#x27;q-&#x27;) &gt;= 0) &#123; directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) elem.directive.push(attr.nodeName.slice(2)) &#125; &#125; &#125;&#125;// -------- ç¨‹åºæ‰§è¡Œ -------scan()defineGetAndSet(data, &#x27;value&#x27;)setTimeout(() =&gt; &#123; // è¿™é‡Œä¸ºæ•°æ®è®¾ç½®æ–°å€¼ä¹‹åï¼Œåœ¨ set æ–¹æ³•ä¸­ä¼šå»æ›´æ–° view data.value = &#x27;Hello world&#x27;&#125;, 1000); åŸºäº Proxy çš„å®ç°Proxy æ˜¯ ES6 ä¸­çš„æ–°ç‰¹æ€§ã€‚å¯ä»¥åœ¨å·²æœ‰çš„å¯¹è±¡åŸºç¡€ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶é‡æ–°å®šä¹‰å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•ã€‚ä¾‹å¦‚ get å’Œ set æ–¹æ³•ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// Hijackinglet elems = [document.getElementById(&#x27;el&#x27;), document.getElementById(&#x27;input&#x27;)]// å®šä¹‰ Directivelet directive = &#123; text: function(text) &#123; this.innerHTML = text &#125;, value: function(value) &#123; this.setAttribute(&#x27;value&#x27;, value) this.value = value &#125;&#125;// è®¾ç½®å¯¹è±¡çš„ä»£ç†let data = new Proxy(&#123;&#125;, &#123; get: function(target, key, receiver) &#123; return target.value &#125;, set: function (target, key, value, receiver) &#123; target.value = value scan() return target.value &#125;&#125;)// View ç»‘å®šç›‘å¬elems[1].addEventListener(&#x27;keyup&#x27;, function(e) &#123; data.value = e.target.value&#125;, false)// æ‰«ææ‰€æœ‰çš„å…ƒç´ function scan() &#123; // æ‰«æå¸¦æŒ‡ä»¤çš„èŠ‚ç‚¹å±æ€§ for (let elem of elems) &#123; elem.directive = [] for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf(&#x27;q-&#x27;) &gt;= 0) &#123; directive[attr.nodeName.slice(2)].call(elem, data[attr.nodeValue]) elem.directive.push(attr.nodeName.slice(2)) &#125; &#125; &#125;&#125;// -------- ç¨‹åºæ‰§è¡Œ -------data[&#x27;value&#x27;] = &#x27;Hello&#x27;scan()setTimeout(() =&gt; &#123; data.value = &#x27;Hello world&#x27;&#125;, 1000); è„æ•°æ®ç›‘æµ‹åŸºæœ¬åŸç†æ˜¯åœ¨ Model å¯¹è±¡çš„å±æ€§å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰¾åˆ°ä¸è¯¥å±æ€§å€¼ç›¸å…³çš„æ‰€æœ‰å…ƒç´ ï¼Œç„¶ååˆ¤æ–­æ•°æ®æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œè‹¥å˜åŒ–åˆ™æ›´æ–° Viewã€‚ ç¼–å†™é¡µé¢ä»£ç å¦‚ä¸‹ï¼š 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;title&gt;Two way binding&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input q-event=&quot;value&quot; q-bind=&quot;value&quot; type=&quot;text&quot; id=&quot;input&quot;&gt; &lt;span q-event=&quot;text&quot; q-bind=&quot;value&quot; id=&quot;el&quot;&gt;&lt;/span&gt;&lt;/body&gt;&lt;script src=&quot;way_2.js&quot;&gt;&lt;/script&gt;&lt;/html&gt; js ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// Dirty detectionlet elems = [document.getElementById(&#x27;el&#x27;), document.getElementById(&#x27;input&#x27;)]let data = &#123; value: &#x27;hello&#x27;&#125;// å®šä¹‰ Directivelet directive = &#123; text: function(text) &#123; this.innerHTML = text &#125;, value: function(value) &#123; this.setAttribute(&#x27;value&#x27;, value) this.value = value &#125;&#125;// è„æ•°æ®å¾ªç¯æ£€æµ‹function digest(elems) &#123; for (let elem of elems) &#123; if (elem.directive === undefined) &#123; elem.directive = &#123;&#125; &#125; for (let attr of elem.attributes) &#123; if (attr.nodeName.indexOf(&#x27;q-event&#x27;) &gt;= 0) &#123; let dataKey = elem.getAttribute(&#x27;q-bind&#x27;) || undefined // è¿›è¡Œè„æ•°æ®æ£€æµ‹ï¼Œå¦‚æœæ•°æ®æ”¹å˜ï¼Œåˆ™é‡æ–°æ‰§è¡Œå‘½ä»¤ if (elem.directive[attr.nodeValue] !== data[dataKey]) &#123; directive[attr.nodeValue].call(elem, data[dataKey]) elem.directive[attr.nodeValue] = data[dataKey] &#125; &#125; &#125; &#125;&#125;// æ•°æ®ç›‘å¬function $digest(value) &#123; let list = document.querySelectorAll(&#x27;[q-bind=&#x27; + value + &#x27;]&#x27;) digest(list)&#125;// View ç»‘å®šç›‘å¬elems[1].addEventListener(&#x27;keyup&#x27;, function(e) &#123; data.value = e.target.value $digest(e.target.getAttribute(&#x27;q-bind&#x27;))&#125;, false)// -------- ç¨‹åºæ‰§è¡Œ -------$digest(&#x27;value&#x27;)setTimeout(() =&gt; &#123; data.value = &quot;Hello world&quot; $digest(&#x27;value&#x27;)&#125;, 1000); æ€»ç»“ä¸Šé¢åªæ˜¯ç®€å•åœ°å®ç°äº†åŒå‘ç»‘å®šï¼Œä½†å®é™…ä¸Šä¸€ä¸ªå®Œæ•´çš„ MVVM æ¡†æ¶è¦è€ƒè™‘å¾ˆå¤šä¸œè¥¿ã€‚åœ¨ä¸Šé¢çš„å®ç°ä¸­æ•°æ®åŠ«æŒçš„æ–¹æ³•æ›´æ–°View æ˜¯ä½¿ç”¨äº† Scan å‡½æ•°ï¼Œä½†å®é™…çš„å®ç°ä¸­ï¼ˆæ¯”å¦‚ Vueï¼‰æ˜¯ä½¿ç”¨äº†å‘å¸ƒè®¢é˜…çš„æ¨¡å¼ã€‚å®ƒåªä¼šå»æ›´æ–°é‚£äº›ä¸è¯¥ Model æ•°æ®ç»‘å®šçš„å…ƒç´ ï¼Œè€Œä¸ä¼šå»æ‰«ææ‰€æœ‰å…ƒç´ ã€‚è€Œåœ¨è„æ•°æ®æ£€æµ‹ä¸­ï¼Œå®ƒå»æ‰¾åˆ°äº†æ‰€æœ‰ç»‘å®šçš„å…ƒç´ ï¼Œç„¶ååˆ¤æ–­æ•°æ®æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œè¿™ç§æ–¹å¼åªæœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€çš„ã€‚ å‚è€ƒã€Šç°ä»£å‰ç«¯æŠ€æœ¯è§£æã€‹ ä»£ç ä¸‹è½½"},{"title":"May-8-2016","date":"2021-10-29T06:35:18.520Z","updated":"2016-05-08T15:28:46.000Z","comments":true,"path":"back_posts/old_posts/May-8-2016.html","permalink":"https://orechou.github.io/back_posts/old_posts/May-8-2016.html","excerpt":"","text":"ä»Šå¤©æ™šä¸ŠåˆšæŠŠæ¯•ä¸šè®ºæ–‡å†™å¥½å‘ç»™å¯¼å¸ˆã€‚è¿™å‘¨å·²ç»å¼€å§‹è·Ÿå¯¼å¸ˆåšé¡¹ç›®äº†ã€‚è€å¸ˆåŒå­¦åšçš„ä¸€ä¸ªJavaWebå¼€å‘æ¡†æ¶â€”â€”ternï¼Œè¯¥æ¡†æ¶å·²ç»åœ¨GitHubä¸Šå¼€æºã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªJavaWebæ¡†æ¶å¼€å‘WebAppã€‚ä¸€æœŸé¡¹ç›®æ˜¯åšä¸€ä¸ªé¢å‘ä¼ä¸šç”¨æˆ·çš„é¡¹ç›®ç®¡ç†ç³»ç»ŸCPMSã€‚ç†Ÿæ‚‰è¿™ä¸ªæ¡†æ¶æœ‰ä¸€å‘¨å¤šçš„æ—¶é—´ï¼Œè°ˆä¸€è°ˆè‡ªå·±çš„æ„Ÿå—ï¼š1ã€ç›¸æ¯”äºSSHã€äº¦æˆ–æ˜¯SpringMVCï¼Œternå¾ˆè½»é‡çº§ã€‚åœ¨é…ç½®å·¥ç¨‹ä¸Šï¼Œå‡ ä¹ä¸éœ€è¦åšä»€ä¹ˆé…ç½®ã€‚2ã€å¯¹äºåŸºæœ¬çš„æ•°æ®åº“æ”¯æŒå¾ˆå®Œå–„ï¼Œæ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½é½å…¨ã€‚å¯èƒ½ä¸è¶³çš„åœ°æ–¹åœ¨äºwebæ€§èƒ½é—®é¢˜ï¼Œè¯¥æ¡†æ¶ä¸é€‚ç”¨äºå¼€å‘å¤§å‹çš„ç”¨æˆ·é‡å¤§çš„ç½‘ç«™ã€‚3ã€å…·æœ‰å¾ˆå¤§çš„å¤ç”¨æ€§ï¼Œè¯¥æ¡†æ¶å¾ˆé€‚åˆäºå¼€å‘ä¼ä¸šçš„ç®¡ç†åº”ç”¨ç³»ç»Ÿã€‚ç›®å‰å¼€æºçš„Ternåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šternã€tern-uiã€tern-iapã€‚æ ¹æ®ä½œè€…ä¹”è€å¸ˆæ‰€è¯´ï¼Œternä¸tern-uiå·²ç»æ¥è¿‘å®Œå–„ã€ä¸ä¼šå†æœ‰æ”¹å˜ï¼Œtern-iapä»åœ¨å¼€å‘å®Œå–„ä¹‹ä¸­ã€‚å¤§ä¸‰å­¦ä¹ webå¼€å‘çš„æ—¶å€™æ²¡æœ‰å­¦ä¹ å‰ç«¯çŸ¥è¯†ï¼Œç›®å‰åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œè¦å¯¹å‰ç«¯çŸ¥è¯†æœ‰ä¸€å®šçš„æŒæ¡ã€‚æ‰€ä»¥è¿™å‘¨ä¹Ÿåœ¨å­¦ä¹ å‰ç«¯ï¼Œwebå‰ç«¯æŠ€æœ¯ï¼šHTMLã€CSSã€JavaScriptï¼Œæˆ‘ä¸»è¦æ·±å…¥å­¦ä¹ JavaScriptã€‚JavaScriptçš„å­¦ä¹ æ„ä¹‰ä¸æ­¢åœ¨äºåˆ¶ä½œå‰ç«¯é¡µé¢ï¼Œæ›´åœ¨äºå‰ç«¯ä¸šåŠ¡é€»è¾‘ä¸å‰ç«¯æ•°æ®ä¸UIçš„äº¤äº’ã€‚å‰©ä¸‹çš„HTMLå’ŒCSSï¼Œåœ¨ç›®å‰çš„å­¦ä¹ ä¸­ï¼Œå°±æ˜¯ç”¨åˆ°çš„æ—¶å€™Googleä¸€ä¸‹å°±okã€‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å‰ç«¯ç”¨åˆ°çš„æŠ€æœ¯æœ‰ï¼šBootstrapã€JQueryï¼ˆé€‰æ‹©å™¨çœå»æˆ‘å¥½å¤šå·¥ä½œé‡ï¼‰å’ŒFreeMarkerã€‚FreeMarkerç”¨äºä½¿ç”¨Javaè¯­è¨€å®šä¹‰å‰ç«¯UIæ¨¡æ¿ã€æŒ‡ä»¤æ ‡ç­¾ï¼Œå¹¶ä¸”è¿˜æœ‰å°†æ•°æ®åº“ä¸­æ‰€å¾—æ•°æ®ä¸æ¨¡æ¿ç»“åˆå±•ç¤ºçš„ä½œç”¨ã€‚å­¦ä¹ ä¸‰é—¨æŠ€æœ¯çš„æœ€å¥½é€”å¾„å°±æ˜¯ä¸Šå®˜ç½‘ï¼Œçœ‹å®˜ç½‘ç»™çš„ç¤ºä¾‹ï¼Œç„¶åæ ¹æ®é¡¹ç›®ä¸€æ­¥ä¸€æ­¥å®è·µã€‚ okã€‚ç¬¬ä¸€ç¯‡å‘¨è®°å°±è¿™äº›ã€‚"},{"title":"Tensor Decomposition in TensorLy","date":"2021-10-29T06:35:18.519Z","updated":"2018-04-01T12:18:57.000Z","comments":true,"path":"back_posts/old_posts/TensorLy_In_Action.html","permalink":"https://orechou.github.io/back_posts/old_posts/TensorLy_In_Action.html","excerpt":"æœ€è¿‘å› è®ºæ–‡éœ€è¦è€Œå­¦ä¹ å¼ é‡å’Œå¼ é‡åˆ†è§£ã€‚çœ‹äº†è¯¸å¤šè®ºæ–‡ä¹‹åï¼Œæƒ³ä½¿ç”¨ä¸€äº›å¼€æºå·¥å…·æ¥å®é™…æ“ä½œä¸€ä¸‹å¼ é‡ã€‚å°±é€‰æ‹©äº†TensorLyï¼Œé€‰æ‹©å®ƒçš„åŸå› ä¸»è¦å› ä¸ºå®ƒæ–‡æ¡£å†™å¾—è¯¦ç»†â€¦","text":"æœ€è¿‘å› è®ºæ–‡éœ€è¦è€Œå­¦ä¹ å¼ é‡å’Œå¼ é‡åˆ†è§£ã€‚çœ‹äº†è¯¸å¤šè®ºæ–‡ä¹‹åï¼Œæƒ³ä½¿ç”¨ä¸€äº›å¼€æºå·¥å…·æ¥å®é™…æ“ä½œä¸€ä¸‹å¼ é‡ã€‚å°±é€‰æ‹©äº†TensorLyï¼Œé€‰æ‹©å®ƒçš„åŸå› ä¸»è¦å› ä¸ºå®ƒæ–‡æ¡£å†™å¾—è¯¦ç»†â€¦ QuickSort1.What is TensorLyä¼ é€é—¨åœ¨è¿™é‡Œã€‚TensorLyæ˜¯ä¸€ä¸ªç®€å•å¿«é€Ÿçš„Pythonå¼ é‡åº“ï¼Œä¼˜ç‚¹åœ¨äºçº¯Pythonå®ç°ï¼Œä¾èµ–å°‘ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ”¯æŒå¦‚Numpyã€MXnetå¤šç§æ•°æ®çš„åº•å±‚ã€‚æœ€é‡è¦çš„æ˜¯æ–‡æ¡£è¯¦ç»†ã€‚ 2.Basic Operations1.Import the libraryé¦–å…ˆè¦å¼•å…¥ç›¸åº”çš„åº“æ‰èƒ½ä½¿ç”¨ 12import numpy as npimport tensorly as tl 2.Create a tensorä½¿ç”¨numpyç”Ÿæˆä¸€ä¸ªä¸‰ç»´æ•°ç»„ï¼Œå¹¶æ„å»ºæˆTensorLyä¸­çš„å¼ é‡ 1tensor = tl.tensor(np.arange(24).reshape((3, 4, 2))) 3.Unfolding tensor by modeå°†å¼ é‡æŒ‰ç»´åº¦å±•å¼€ 12import tensorly as unfoldunfold(tensor, 0) # mode-1 unfolding 4.Folding tensorå°†å±•å¼€çš„æ•°ç»„æŒ‰ç»´åº¦è¿˜åŸæˆå¼ é‡ 1234from tensorly import foldunfolding = unfold(tensor, 1)original_shape = tensor.shapefold(unfolding, 1, original_shape) 3.Tensor decompositionå¼ é‡åˆ†è§£æœ‰å¾ˆå¤šç§åˆ†è§£æ–¹æ³•ï¼Œä½†ä¸»è¦çš„åˆ†è§£æ–¹æ³•æœ‰ä¸¤ç§ï¼šTuckeråˆ†è§£å’ŒCPåˆ†è§£ï¼Œå…¶ä¸­CPåˆ†è§£æ˜¯Tuckeråˆ†è§£çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚TensorLyä¹Ÿæä¾›äº†è¿™ä¸¤ç§æ–¹æ³•çš„å®ç°ã€‚Tuckeråˆ†è§£çš„å…¬å¼ä¸º X = S * A * B * Cï¼ŒXæ˜¯åŸå¼ é‡ï¼ŒSä¸ºåˆ†è§£ä¹‹åäº§ç”Ÿçš„æ ¸å¿ƒå¼ é‡ï¼ŒAã€Bã€Cåˆ†åˆ«ä¸ºåˆ†è§£ä¹‹åå…³äº3ä¸ªç»´åº¦çš„çŸ©é˜µã€‚å›¾ç¤ºå¦‚ä¸‹ï¼š 1234from tensorly.decomposition import tucker# tuckerå‡½æ•°ä¼ å…¥ä¸€ä¸ªå¼ é‡ï¼Œå¹¶æŒ‡å®šæ ¸å¿ƒå¼ é‡çš„å„ä¸ªç»´åº¦çš„é•¿åº¦# tuckerå‡½æ•°çš„è¿”å›ç»“æœæ˜¯åˆ†è§£å®Œæˆä¹‹åçš„æ ¸å¿ƒå¼ é‡ï¼Œå’Œå„ä¸ªç»´åº¦çš„çŸ©é˜µcore, factors = tucker(tensor, ranks=[2, 3, 1]) CPåˆ†è§£æ˜¯Tuckeråˆ†è§£çš„ç‰¹ä¾‹ã€‚å¦‚æœTuckeråˆ†è§£ä¸­çš„æ ¸å¿ƒå¼ é‡æ˜¯ä¸€ä¸ªè¶…å¯¹è§’ç»“æ„ï¼ˆå¯¹è§’ï¼Œå¹¶ä¸”ä¸‰ä¸ªç»´åº¦çš„é•¿åº¦ç›¸ç­‰ï¼‰ï¼Œåˆ™Tuckeråˆ†è§£é€€åŒ–ä¸ºCPåˆ†è§£ã€‚å…¬å¼ä¸º X = Î» * A * B * Cï¼ˆå¸¦æƒé‡ï¼‰ï¼ŒXæ˜¯åŸå¼ é‡ï¼ŒÎ»çŸ©é˜µä¸ºåˆ†è§£ä¹‹åè¶…å¯¹è§’å¼ é‡çš„å¯¹è§’å€¼ï¼ŒAã€Bã€Cåˆ†åˆ«ä¸ºåˆ†è§£ä¹‹åå…³äº3ä¸ªç»´åº¦çš„çŸ©é˜µã€‚å›¾ç¤ºå¦‚ä¸‹ï¼š 1234from tensorly.decomposition import parafac# parafacå‡½æ•°ä¼ å…¥ä¸€ä¸ªå¼ é‡ï¼Œå¹¶æŒ‡å®šåŸå¼ é‡çš„ä¸€ä¸ªä¼°è®¡ï¼ˆè¿‘ä¼¼ï¼‰çš„ç§©# è¿”å›çš„å°±æ˜¯åˆ†è§£ä¹‹åfactors = parafac(tensor, rank=2) 4.Demoä½¿ç”¨å¼ é‡åˆ†è§£çš„çš„ä¸€ä¸ªä¾‹å­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import matplotlib.pyplot as pltimport tensorly as tlimport numpy as npfrom tensorly.decomposition import parafacfrom tensorly.decomposition import tuckerfrom PIL import Imagerandom_state = 12345tl.set_backend(&#x27;numpy&#x27;)# æ‰“å¼€å›¾ç‰‡image_png = Image.open(&#x27;/Users/orechou/Downloads/index_1.jpg&#x27;)# æ‰“å°å›¾ç‰‡çš„ä¿¡æ¯print(image_png)data = np.reshape(image_png, [1000, 1500, 3])# å°†å€¼ä»intè½¬å˜æˆfloatï¼Œå› ä¸ºåœ¨åˆ†è§£çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿæµ®ç‚¹æ•°image = tl.tensor(data, dtype=&#x27;float64&#x27;)def to_image(tensor): &quot;&quot;&quot;A convenience function to convert from a float dtype back to uint8&quot;&quot;&quot; im = tl.to_numpy(tensor) im -= im.min() im /= im.max() im *= 255 return im.astype(np.uint8)# Rank of the CP decompositioncp_rank = 25# Rank of the Tucker decompositiontucker_rank = [100, 100, 2]# Perform the CP decompositionfactors = parafac(image, rank=cp_rank, init=&#x27;random&#x27;, tol=10e-6)# Reconstruct the image from the factorscp_reconstruction = tl.kruskal_to_tensor(factors)# Tucker decompositioncore, tucker_factors = tucker(image, ranks=tucker_rank, init=&#x27;random&#x27;, tol=10e-5, random_state=random_state)tucker_reconstruction = tl.tucker_to_tensor(core, tucker_factors)# Plotting the original and reconstruction from the decompositionsfig = plt.figure()ax = fig.add_subplot(1, 3, 1)ax.set_axis_off()ax.imshow(to_image(image))ax.set_title(&#x27;Original&#x27;)ax = fig.add_subplot(1, 3, 2)ax.set_axis_off()ax.imshow(to_image(cp_reconstruction))ax.set_title(&#x27;CP&#x27;)ax = fig.add_subplot(1, 3, 3)ax.set_axis_off()ax.imshow(to_image(tucker_reconstruction))ax.set_title(&#x27;Tucker&#x27;)plt.tight_layout()plt.show() æ•ˆæœå¦‚ä¸‹ï¼š"},{"title":"Sept-11-2016","date":"2021-10-29T06:35:18.520Z","updated":"2016-09-11T15:29:54.000Z","comments":true,"path":"back_posts/old_posts/Sept-11-2016.html","permalink":"https://orechou.github.io/back_posts/old_posts/Sept-11-2016.html","excerpt":"","text":"æš‘å‡å›å®¶äº†10å¤©ï¼Œåœ¨å­¦æ ¡ä½“éªŒäº†å‡ å‘¨çš„æ—©ç­åœ°é“ï¼Œä½“ä¼šäº†æŒ¤åœ°é“çš„è‰°è¾›ã€‚æœ¬æ¥æœ‰è¯´çš„æŠ€æœ¯åšå®¢ä¹Ÿå˜æˆäº†ä¸€ä¸¤ä¸ªæœˆçš„ç‰¢éªšã€‚æ˜å¤©å¼€å­¦ç¬¬ä¸€è¯¾ï¼Œæ˜¯æ—¶å€™å†å‘ä¸€æ³¢éªšæ°”äº†ã€‚ å…³äºé¡¹ç›®ï¼šCPMSç³»ç»Ÿå¼€å‘ä¸€ä¸ªMISç³»ç»Ÿï¼Œéƒ½è¦é’ˆå¯¹è¯¥MISç³»ç»Ÿæ‰€è®¾è®¡çš„è¡Œä¸šæœ‰ä¸€ä¸ªæ¯”è¾ƒé€å½»çš„äº†è§£ï¼Œè¦è¡¥ä¹ ä¸€äº›ITè¡Œä¸šå¤–çš„çŸ¥è¯†ã€‚å¦å¤–å¼€å‘ä»»ä½•ä¸€ä¸ªç³»ç»Ÿï¼Œéƒ½è¦ä¸ä¸šä¸»æœ‰å¾ˆå¥½çš„æ²Ÿé€šã€‚å‚ä¸è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘çš„æ„Ÿè§‰æ˜¯æ²Ÿé€šä¸å¤Ÿã€‚ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘æ²¡æœ‰ä¸»åŠ¨æ²Ÿé€šçš„ç§¯ææ€§ï¼ŒäºŒæ˜¯æ²¡æœ‰å¯¹æ²Ÿé€šçš„æœ‰ä¸€å®šçš„é‡è§†ç¨‹åº¦ã€‚æ²Ÿé€šå’Œå¦å¤–çš„ä¸€äº›åŸå› äºï¼Œå¯¼è‡´è¯¥é¡¹ç›®çš„åœæ»ä¸å‰ã€è¿›åº¦ç¼“æ…¢ã€‚ å…³äºç ”ç©¶ç”Ÿ9æœˆæ¥å­¦æ ¡ï¼Œæˆ‘å»äº†ä¸€è¶Ÿè™æºªâ€”â€”å¤§å­¦å¼€å§‹çš„åœ°æ–¹ã€‚æ²¡æœ‰å¤šé€›ï¼Œä»å¤§å­¦åŸåœ°é“ç«™ã€èµ°ç†™è¡—ã€ç©¿è¿‡åŒ—é—¨å—é—¨ã€æœ€åå›æ²™åªåã€‚å›å¿†èµ·æœ¬ç§‘è¿™å››å¹´ï¼Œä¸šç²¾äºå‹¤è’äºå¬‰ã€‚å¯¹äºåé¢è¿™ä¸‰å¹´ï¼Œæˆ‘æƒ³ï¼Œæ˜¯è¯¥éªšæ°”åœ°åšä¸€æ³¢æ”¹å˜äº†ã€‚ å…³äºå†™ä¸œè¥¿æ¯æ¬¡æƒ³å†™ï¼Œéƒ½å†™ä¸äº†å¤šå°‘ã€‚ã€‚ã€‚"},{"title":"Spring Web Flow","date":"2021-10-29T06:35:18.519Z","updated":"2016-11-21T03:34:27.000Z","comments":true,"path":"back_posts/old_posts/spring_flow.html","permalink":"https://orechou.github.io/back_posts/old_posts/spring_flow.html","excerpt":"","text":"æœ¬Blogå†…å®¹ä¸»è¦åŸºäºã€ŠSpring In Actionã€‹ç¬¬å››ç‰ˆå’ŒGithubä¸Šé¢çš„sampleã€‚The first production ready 1.0 release was made on 2006-10-26. Version 2.0, first released on 2008-04-29ã€‚ä»é‚£ä¹‹åå°±æ²¡æœ‰å¤§çš„ç‰ˆæœ¬æ›´æ–°ã€‚ 1ã€åœ¨Springä¸­é…ç½®Web Flowã€ŠSpring In Actionã€‹ç¬¬å››ç‰ˆè¯´â€œè¿˜ä¸æ”¯æŒåœ¨Javaä¸­é…ç½®Spring Web Flowâ€ï¼Œä½†æ˜¯å®é™…ä¸Šå·²ç»æ”¯æŒäº†Javaçš„é…ç½®ã€‚ä¸»è¦åœ¨ä»£ç ä¸­ç»§æ‰¿å¹¶å®ç°AbstractFlowConfigurationæ¥å£ã€‚é¦–å…ˆåšå¥½SpringMVCçš„Javaé…ç½®ã€‚å› ä¸ºSpring Web Flowæ˜¯æ„å»ºäºSpringMVCåŸºç¡€ä¹‹ä¸Šï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦é¦–å…ˆç»è¿‡SpringMVCçš„DispatcherServletã€‚ï¼ˆ1ï¼‰è£…é…æµç¨‹æ‰§è¡Œå™¨å®ç°ä¸€ä¸ªç»§æ‰¿äº†AbstractFlowConfigurationçš„ç±»ã€‚ @Bean public FlowExecutor flowExecutor() &#123; return getFlowExecutorBuilder(flowRegistry()) .addFlowExecutionListener(new SecurityFlowExecutionListener(), &quot;*&quot;) .build(); &#125;æµç¨‹æ‰§è¡Œå™¨é©±åŠ¨æµç¨‹çš„æ‰§è¡Œï¼Œå½“ç”¨æˆ·è¿›å…¥ä¸€ä¸ªæµç¨‹æ—¶ï¼Œæµç¨‹æ‰§è¡Œå™¨ä¼šä¸ºç”¨æˆ·åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®ä¾‹ã€‚ï¼ˆ2ï¼‰é…ç½®æµç¨‹æ³¨å†Œè¡¨åŠ è½½æµç¨‹å®šä¹‰å¹¶è®©æµç¨‹æ‰§è¡Œå™¨èƒ½å¤Ÿä½¿ç”¨å®ƒä»¬ã€‚ @Bean public FlowDefinitionRegistry flowRegistry() &#123; return getFlowDefinitionRegistryBuilder(flowBuilderServices()) .setBasePath(&quot;/WEB-INF&quot;) .addFlowLocationPattern(&quot;/**/*-flow.xml&quot;).build(); &#125;ï¼ˆ3ï¼‰å¤„ç†æµç¨‹è¯·æ±‚éœ€è¦é…ç½®ä¸€ä¸ªFlowHandlerMappingæ¥å¸®åŠ©DispatcherServletå°†æµç¨‹çš„è¯·æ±‚å‘é€ç»™Spring Web Flowã€‚ @Bean public FlowHandlerMapping flowHandlerMapping() &#123; FlowHandlerMapping handlerMapping = new FlowHandlerMapping(); handlerMapping.setOrder(-1); handlerMapping.setFlowRegistry(this.webFlowConfig.flowRegistry()); return handlerMapping; &#125;è¿™é‡Œé¢è£…é…äº†æµç¨‹æ³¨å†Œè¡¨ï¼Œè¿™æ ·å°±èƒ½å¤ŸçŸ¥é“å¦‚ä½•å°†è¯·æ±‚çš„URLåŒ¹é…åˆ°æµç¨‹ä¸Šã€‚é…ç½®è¿™ä¸ªBeançš„ä½œç”¨åªæ˜¯å°†æµç¨‹è¯·æ±‚å®šå‘åˆ°swfï¼Œä½†æ˜¯å¹¶ä¸åšå“åº”ã€‚ @Bean public FlowHandlerAdapter flowHandlerAdapter() &#123; FlowHandlerAdapter handlerAdapter = new FlowHandlerAdapter(); handlerAdapter.setFlowExecutor(this.webFlowConfig.flowExecutor()); handlerAdapter.setSaveOutputToFlashScopeOnRedirect(true); return handlerAdapter; &#125;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢è®¾ç½®äº†æµç¨‹çš„æ‰§è¡Œå™¨ï¼Œç±»ä¼¼äºSpringMVCä¸­çš„æ§åˆ¶å™¨ï¼Œå®ƒä¼šå“åº”å‘é€çš„è¯·æ±‚ï¼Œå¹¶å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ 2ã€æµç¨‹çš„ç»„ä»¶åœ¨Spring Web Flowä¸­ï¼Œæµç¨‹æ˜¯ç”±çŠ¶æ€(state)ã€è½¬ç§»(transition)ã€æµç¨‹æ•°æ®(data)ä¸‰ä¸ªå…ƒç´ å®šä¹‰ã€‚çŠ¶æ€ç±»å‹ï¼šè¡Œä¸º(action)ã€å†³ç­–ï¼ˆdecisionï¼‰ã€ç»“æŸï¼ˆendï¼‰ã€å­æµç¨‹(subflow)ã€è§†å›¾(view)(è§†å›¾çŠ¶æ€ç”¨äºä¸ºç”¨æˆ·å±•ç°ä¿¡æ¯å¹¶ä½¿ç”¨æˆ·åœ¨æµç¨‹ä¸­å‘æŒ¥ä½œç”¨ï¼Œä¹Ÿå³æ˜¯ç”¨äºäº¤äº’)è§†å›¾çŠ¶æ€id:æ ‡ç¤ºè¿™ä¸ªçŠ¶æ€ï¼›è‹¥åœ¨è¿™ä¸ªçŠ¶æ€ä¸­æ²¡æœ‰ç”¨viewæŒ‡å®šè§†å›¾ï¼Œåˆ™è¿™ä¸ªidä¹Ÿä»£è¡¨äº†è§†å›¾åã€‚model:å°†ä¼šæŠŠidè§†å›¾ä¸­çš„è¡¨å•æ•°æ®ç»‘å®šåˆ°modelä¸­æ‰€æŒ‡å®šçš„å¯¹è±¡ã€‚è¡Œä¸ºçŠ¶æ€ä¼šå‡ºå‘springä¸­æ‰€ç®¡ç†beançš„ä¸€äº›æ–¹æ³•ï¼Œæ–¹æ³•æ‰§è¡Œè°ƒç”¨ä¹‹åä¼šè½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ã€‚å†³ç­–çŠ¶æ€è‹¥æµç¨‹ä¸æ˜¯çº¿æ€§çš„ï¼Œåˆ™éœ€è¦ä½¿ç”¨å†³ç­–çŠ¶æ€å­æµç¨‹çŠ¶æ€ç»“æŸçŠ¶æ€ç”¨äºæµç¨‹çš„ç»“æŸã€‚å½“ç»“æŸçš„æ˜¯å­æµç¨‹ï¼Œå­æµç¨‹ç»“æŸä¹‹åï¼Œè°ƒç”¨å®ƒçš„æµç¨‹å°†ä¼šä»è°ƒç”¨å¤„ç»§ç»­æ‰§è¡Œã€‚ çŠ¶æ€ä¹‹é—´çš„è¿ç§»toç”¨äºæŒ‡å®šæµç¨‹çš„ä¸‹ä¸€ä¸ªçŠ¶æ€onç”¨äºæŒ‡å®šè§¦å‘è½¬ç§»çš„äº‹ä»¶on-exceptionç”¨äºåˆ¶å®šäº†è¦è½¬ç§»çš„å¼‚å¸¸&lt;global-trasitions&gt;å…¨å±€è½¬ç§»ï¼Œå¯¹äºå®šä¹‰çš„æµç¨‹è½¬ç§»ï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¼šé»˜è®¤æ‹¥æœ‰è¿™ä¸ªè½¬ç§» 3ã€æµç¨‹æ•°æ®å¯ä»¥åœ¨æµç¨‹ä¸­å®šä¹‰å˜é‡ï¼Œå®šä¹‰çš„å˜é‡å¯ä»¥åœ¨æµç¨‹ä¸­çš„å„ä¸ªåœ°æ–¹è¿›è¡Œå¼•ç”¨ã€‚&lt;var name=&quot;&quot; class=&quot;&quot;&gt;"},{"title":"æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡","date":"2021-10-29T06:35:18.519Z","updated":"2018-09-15T07:19:30.000Z","comments":true,"path":"back_posts/old_posts/æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡.html","permalink":"https://orechou.github.io/back_posts/old_posts/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87.html","excerpt":"åœ¨å¯¹äº’è”ç½‘æœåŠ¡è¿›è¡ŒæœåŠ¡ç«¯æ€§èƒ½æµ‹è¯•æ—¶ï¼Œä¸»è¦å…³æ³¨ä¸¤æ–¹é¢çš„æ€§èƒ½æŒ‡æ ‡ï¼š ä¸šåŠ¡æŒ‡æ ‡ï¼šå¦‚ååé‡(QPSã€TPS)ã€å“åº”æ—¶é—´(RT)ã€å¹¶å‘æ•°ã€ä¸šåŠ¡æˆåŠŸç‡ç­‰ èµ„æºæŒ‡æ ‡ï¼šå¦‚ CPUã€å†…å­˜ã€Disk I/Oã€Network I/Oç­‰èµ„æºçš„æ¶ˆè€—æƒ…å†µæœ¬æ–‡ä¸»è¦ä»‹ç»ä¸€äº›å¹¿æ³›é€‚ç”¨çš„ã€åŸºæœ¬çš„èµ„æºæŒ‡æ ‡ä»¥åŠè¿™äº›æŒ‡æ ‡åœ¨ Linux æœåŠ¡å™¨çš„è·å–æ–¹å¼ã€‚","text":"åœ¨å¯¹äº’è”ç½‘æœåŠ¡è¿›è¡ŒæœåŠ¡ç«¯æ€§èƒ½æµ‹è¯•æ—¶ï¼Œä¸»è¦å…³æ³¨ä¸¤æ–¹é¢çš„æ€§èƒ½æŒ‡æ ‡ï¼š ä¸šåŠ¡æŒ‡æ ‡ï¼šå¦‚ååé‡(QPSã€TPS)ã€å“åº”æ—¶é—´(RT)ã€å¹¶å‘æ•°ã€ä¸šåŠ¡æˆåŠŸç‡ç­‰ èµ„æºæŒ‡æ ‡ï¼šå¦‚ CPUã€å†…å­˜ã€Disk I/Oã€Network I/Oç­‰èµ„æºçš„æ¶ˆè€—æƒ…å†µæœ¬æ–‡ä¸»è¦ä»‹ç»ä¸€äº›å¹¿æ³›é€‚ç”¨çš„ã€åŸºæœ¬çš„èµ„æºæŒ‡æ ‡ä»¥åŠè¿™äº›æŒ‡æ ‡åœ¨ Linux æœåŠ¡å™¨çš„è·å–æ–¹å¼ã€‚ æœåŠ¡å™¨æ€§èƒ½æŒ‡æ ‡CPU ç›¸å…³è´Ÿè½½ ï¼ˆLoadï¼‰åœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼Œç³»ç»Ÿè´Ÿè½½æ˜¯å¯¹å½“å‰ CPU å·¥ä½œé‡çš„åº¦é‡ï¼Œå®šä¹‰ä¸ºç‰¹å®šæ—¶é—´é—´éš”å†…è¿è¡Œé˜Ÿåˆ—ä¸­çš„å¹³å‡çº¿ç¨‹æ•°ã€‚ å¸¸ç”¨å‘½ä»¤Linux ä¸ŠæŸ¥çœ‹æœºå™¨è´Ÿè½½çš„æŒ‡ä»¤å¦‚ä¸‹ï¼š uptime å‘½ä»¤ï¼šæ‰“å°ç³»ç»Ÿæ€»å…±è¿è¡Œäº†å¤šé•¿æ—¶é—´å’Œç³»ç»Ÿçš„å¹³å‡è´Ÿè½½ï¼ˆ1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿï¼‰ w å‘½ä»¤ï¼šæ˜¾ç¤ºç›®å‰ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯ï¼Œç³»ç»Ÿæœ€è¿‘ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ top å‘½ä»¤ï¼šå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶æ€ é€šè¿‡å°†ç³»ç»Ÿ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ç§°ä¸º load1ã€load5ã€load15 Java åº”ç”¨å¯¼è‡´ load é£šå‡çš„æ’æŸ¥è´Ÿè½½è¿‡é«˜å¯èƒ½çš„åŸå› ï¼š å†…å­˜æ³„éœ²å¯¼è‡´é¢‘ç¹çš„ GC å‡ºç°äº†æ­»é”çš„æƒ…å†µ æœ‰å¤§å­—æ®µçš„è¯»å†™ï¼ŒIO è‹¥çº¿ä¸Š load ï¼Œå¯è€ƒè™‘å°†å †æ ˆå†…å­˜ dump ï¼Œé‡å¯ç³»ç»Ÿï¼Œé›¶æ—¶è§£å†³ã€‚è§£å†³çš„æ­¥éª¤å¦‚ä¸‹ï¼š æŸ¥çœ‹ load æƒ…å†µé¦–å…ˆä½¿ç”¨ uptime æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„ load 12 OreChou@orechoudeMacBook-Pro $ uptime17:35 up 10 days, 20:09, 3 users, load averages: 3.05 3.92 3.35 æŸ¥çœ‹å ç”¨ CPU è¾ƒé«˜è¿›ç¨‹ä½¿ç”¨ top å‘½ä»¤ï¼ŒæŸ¥çœ‹ CPU å ç”¨è¾ƒé«˜çš„è¿›ç¨‹ ID æŸ¥çœ‹å ç”¨ CPU è¾ƒé«˜çº¿ç¨‹å› ä¸º linux çš„å†…æ ¸ä¸­ï¼Œè¿›ç¨‹ä¸çº¿ç¨‹çš„æ•°æ®ç»“æ„ç›¸åŒã€‚æ‰€ä»¥é€šè¿‡è¿›ç¨‹ ID æŸ¥æ‰¾å½“å‰è¿›ç¨‹ä¸­å ç”¨ CPU è¾ƒé«˜çš„çº¿ç¨‹ IDã€‚ä½¿ç”¨æŒ‡ä»¤ top -Hp pidã€‚ æŸ¥çœ‹è¯¥çº¿ç¨‹çš„æ ˆç©ºé—´å› ä¸º JVM çº¿ç¨‹å¯¹åº”çš„å°±æ˜¯ä¸€ä¸ª linux å†…æ ¸ä¸­çš„çº¿ç¨‹ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ jstack æŸ¥çœ‹è¯¥çº¿ç¨‹çš„æ–¹æ³•æ ˆï¼Œæ‰¾åˆ°æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•ã€‚ä½¿ç”¨å‘½ä»¤ jstack pid | grep -A 200 tid åˆ©ç”¨ç‡ï¼ˆUsageï¼‰åœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼Œåˆ©ç”¨ç‡æ˜¯å¯¹å½“å‰ CPU å·¥ä½œé‡çš„åº¦é‡ï¼Œå®šä¹‰ä¸ºç‰¹å®šæ—¶é—´é—´éš”å†… CPU è¢«å ç”¨çš„æƒ…å†µã€‚ æŒ‡æ ‡ è¯´æ˜ å¤‡æ³¨ us ç”¨æˆ·è¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯” usçš„å€¼æ¯”è¾ƒé«˜æ—¶ï¼Œè¯´æ˜ç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„CPUæ—¶é—´å¤šï¼Œä½†æ˜¯å¦‚æœé•¿æœŸè¶…50%çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯¥è€ƒè™‘ä¼˜åŒ–ç¨‹åºç®—æ³•æˆ–è€…è¿›è¡ŒåŠ é€Ÿã€‚ sy å†…æ ¸ç³»ç»Ÿè¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯” syçš„å€¼é«˜æ—¶ï¼Œè¯´æ˜ç³»ç»Ÿå†…æ ¸æ¶ˆè€—çš„CPUèµ„æºå¤šï¼Œè¿™å¹¶ä¸æ˜¯è‰¯æ€§è¡¨ç°ï¼Œæˆ‘ä»¬åº”è¯¥æ£€æŸ¥åŸå› ã€‚ id ç©ºé—²æ—¶é—´ç™¾åˆ†æ¯” wa IO ç­‰å¾…æ—¶é—´ç™¾åˆ†æ¯” waçš„å€¼é«˜æ—¶ï¼Œè¯´æ˜IOç­‰å¾…æ¯”è¾ƒä¸¥é‡ï¼Œè¿™å¯èƒ½ç”±äºç£ç›˜å¤§é‡ä½œéšæœºè®¿é—®é€ æˆï¼Œä¹Ÿæœ‰å¯èƒ½ç£ç›˜å‡ºç°ç“¶é¢ˆï¼ˆå—æ“ä½œï¼‰ã€‚ st è™šæ‹Ÿ CPU ç­‰å¾…å®é™… CPU çš„æ—¶é—´çš„ç™¾åˆ†æ¯” å¸¸ç”¨å‘½ä»¤Linux ä¸ŠæŸ¥çœ‹æœºå™¨ CPU åˆ©ç”¨ç‡çš„å‘½ä»¤å¦‚ä¸‹ï¼š vmstat å‘½ä»¤ï¼šå±•ç°ç»™å®šæ—¶é—´é—´éš”çš„æœåŠ¡å™¨çš„çŠ¶æ€å€¼ã€‚åŒ…æ‹¬æœåŠ¡å™¨çš„CPU ä½¿ç”¨ç‡ï¼Œå†…å­˜ä½¿ç”¨ï¼Œè™šæ‹Ÿå†…å­˜äº¤æ¢æƒ…å†µ,IO è¯»å†™æƒ…å†µã€‚ top å‘½ä»¤ï¼šå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶æ€ã€‚ 12345$ vmstat æ—¶é—´é—´éš” é‡‡æ ·æ¬¡æ•°procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu----- r b swpd free buff cache si so bi bo in cs us sy id wa st 0 0 0 2479444 0 3165172 0 0 196 15905 2 8 0 0 84 5 11 0 0 0 2479404 0 3165176 0 0 0 2804 81664 2715 0 0 90 1 9 Java åº”ç”¨å¯¼è‡´ Usage é£šå‡çš„æ’æŸ¥Java åº”ç”¨å¯¼è‡´ CPU åˆ©ç”¨ç‡è¿‡é«˜çš„åŸå› ï¼š å†…å­˜æ³„éœ²å¯¼è‡´å¤§é‡çš„ GC ä»£ç å­˜åœ¨æ­»å¾ªç¯ æ’æŸ¥çš„æ–¹æ³•åŒä¸Šã€‚ å†…å­˜ç›¸å…³Linux ä¸­çš„å†…å­˜å¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼Œç‰©ç†å†…å­˜ã€è™šæ‹Ÿå†…å­˜å’Œ Swap åˆ†åŒºï¼ˆäº¤æ¢åŒºï¼‰ã€‚ ç‰©ç†å†…å­˜ï¼šå†…å­˜æ¡é‚£éƒ¨åˆ†å†…å­˜ç©ºé—´ï¼Œå®é™…çš„å†…å­˜ç©ºé—´ã€‚ è™šæ‹Ÿå†…å­˜ï¼šæ˜¯è®¡ç®—æœºç³»ç»Ÿå†…å­˜ç®¡ç†çš„ä¸€ç§æŠ€æœ¯ã€‚ä½¿å¾—åº”ç”¨ç¨‹åºè®¤ä¸ºå®ƒæ‹¥æœ‰è¿ç»­å¯ç”¨çš„å†…å­˜ï¼ˆä¸€ä¸ªè¿ç»­å®Œæ•´çš„åœ°å€ç©ºé—´ï¼‰ï¼Œè€Œå®é™…ä¸Šï¼Œå®ƒé€šå¸¸æ˜¯è¢«åˆ†éš”æˆå¤šä¸ªç‰©ç†å†…å­˜ç¢ç‰‡ï¼Œè¿˜æœ‰éƒ¨åˆ†æš‚æ—¶å­˜å‚¨åœ¨å¤–éƒ¨ç£ç›˜å­˜å‚¨å™¨ä¸Šï¼Œåœ¨éœ€è¦æ—¶è¿›è¡Œæ•°æ®äº¤æ¢ã€‚ä¸æ²¡æœ‰ä½¿ç”¨è™šæ‹Ÿå†…å­˜æŠ€æœ¯çš„ç³»ç»Ÿç›¸æ¯”ï¼Œä½¿ç”¨è¿™ç§æŠ€æœ¯çš„ç³»ç»Ÿä½¿å¾—å¤§å‹ç¨‹åºçš„ç¼–å†™å˜å¾—æ›´å®¹æ˜“ï¼Œå¯¹çœŸæ­£çš„ç‰©ç†å†…å­˜çš„ä½¿ç”¨ä¹Ÿæ›´æœ‰æ•ˆç‡ã€‚ Swap åˆ†åŒºï¼šå½“ç³»ç»Ÿç‰©ç†å†…å­˜çš„ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼ŒæŠŠç‰©ç†å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´é‡Šæ”¾å‡ºæ¥ï¼Œä»¥ä¾›å½“å‰è¿è¡Œçš„ç¨‹åºä½¿ç”¨ã€‚é‚£äº›è¢«é‡Šæ”¾çš„ç©ºé—´å¯èƒ½æ¥è‡ªä¸€äº›å¾ˆé•¿æ—¶é—´æ²¡æœ‰ä»€ä¹ˆæ“ä½œçš„ç¨‹åºï¼Œè¿™äº›è¢«é‡Šæ”¾çš„ç©ºé—´è¢«ä¸´æ—¶ä¿å­˜åˆ° Swap åˆ†åŒºä¸­ï¼ˆç£ç›˜ä¸Šï¼‰ï¼Œç­‰åˆ°é‚£äº›ç¨‹åºè¦è¿è¡Œæ—¶ï¼Œå†ä»Swap åˆ†åŒºä¸­æ¢å¤ä¿å­˜çš„æ•°æ®åˆ°å†…å­˜ä¸­ã€‚ å†…å­˜ç›¸å…³çš„æ€§èƒ½æŒ‡æ ‡ä¸»è¦æ˜¯ï¼Œå†…å­˜çš„ä½¿ç”¨ç‡ã€‚ ä½¿ç”¨ç‡ï¼ˆUsageï¼‰åœ¨ä¸Šé¢çš„æ¦‚å¿µä¸­ç‰©ç†å†…å­˜å’Œ Swap åˆ†åŒºæ˜¯å®é™…çš„ç‰©ç†çš„ç©ºé—´ã€‚æè¿°å†…å­˜ä½¿ç”¨çš„å±æ€§å¦‚ä¸‹ï¼š æŒ‡æ ‡ æè¿° å¤‡æ³¨ total ç‰©ç†å†…å­˜æ€»å¤§å° used å·²ç»åˆ†é…çš„å†…å­˜çš„å¤§å°ï¼ˆåŒ…æ‹¬äº† sharedã€buffers å’Œ cachedï¼‰ free æœªè¢«åˆ†é…çš„å†…å­˜çš„å¤§å° shared å…±äº«å†…å­˜ buffers å­˜æ”¾è¦è¾“å‡ºåˆ° diskï¼ˆå—è®¾å¤‡ï¼‰çš„æ•°æ®ï¼Œç¼“å†²æ»¡äº†ä¸€æ¬¡å†™ï¼Œæé«˜IOæ€§èƒ½ï¼ˆå†…å­˜ -&gt; ç£ç›˜ï¼‰ cached å­˜æ”¾ä» disk ä¸Šè¯»å‡ºçš„æ•°æ®ï¼Œå¸¸ç”¨çš„ç¼“å­˜èµ·æ¥ï¼Œå‡å°‘IOï¼ˆç£ç›˜ -&gt; å†…å­˜ï¼‰ å¸¸ç”¨å‘½ä»¤Linux ä¸ŠæŸ¥çœ‹å†…å­˜ä½¿ç”¨çš„å‘½ä»¤å¦‚ä¸‹ï¼š free å‘½ä»¤ï¼šæ˜¾ç¤º Linux ç³»ç»Ÿä¸­ç©ºé—²çš„ã€å·²ç”¨çš„ç‰©ç†å†…å­˜åŠ swap å†…å­˜ï¼ŒåŠè¢«å†…æ ¸ä½¿ç”¨çš„ buffer ç­‰ top å‘½ä»¤ï¼štop å‘½ä»¤æ˜¯å¾ˆå…¨èƒ½çš„ï¼Œå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶æ€ã€‚ 12345$free -m total used free shared buffers cachedMem: 8192 2802 5389 0 0 1559-/+ buffers/cache: 1243 6948Swap: 16383 0 16383 å¯ä»¥åœ¨ linux ä¸‹ä½¿ç”¨ /proc/meminfo æ–‡ä»¶æŸ¥çœ‹æ“ä½œç³»ç»Ÿçš„ä½¿ç”¨çŠ¶æ€ã€‚free ä¹Ÿæ˜¯åŸºäº /proc/meminfo æ–‡ä»¶çš„å†…å®¹å®ç°çš„ã€‚ Java å†…å­˜æ³„éœ²æ’æŸ¥æ€è·¯è·å–å†…å­˜å ç”¨è¾ƒé«˜çš„ PIDä½¿ç”¨ jmap å‘½ä»¤1234567jmap -heap 3331ï¼šæŸ¥çœ‹java å †ï¼ˆheapï¼‰ä½¿ç”¨æƒ…å†µjmap -histo 3331ï¼šæŸ¥çœ‹å †å†…å­˜(histogram)ä¸­çš„å¯¹è±¡æ•°é‡åŠå¤§å°jmap -histo:live 3331ï¼šJVMä¼šå…ˆè§¦å‘gcï¼Œç„¶åå†ç»Ÿè®¡ä¿¡æ¯jmap -dump:format=b,file=heapDump 3331ï¼šå°†å†…å­˜ä½¿ç”¨çš„è¯¦ç»†æƒ…å†µè¾“å‡ºåˆ°æ–‡ä»¶ ä¹Ÿå¯ä»¥å¾—åˆ° dump æ–‡ä»¶ï¼Œå†è¿›è¡Œåˆ†æã€‚ é¡µé¢äº¤æ¢ï¼ˆPagingï¼‰é¡µé¢äº¤æ¢åŒ…æ‹¬ä» Swap äº¤æ¢åˆ°å†…å­˜å’Œä»å†…å­˜äº¤æ¢åˆ° Swapï¼Œå¦‚æœç³»ç»Ÿå‡ºç°é¢‘ç¹çš„é¡µé¢äº¤æ¢ï¼Œéœ€è¦å¼•èµ·æ³¨æ„ã€‚å¯ä»¥ä» vmstat ä¸­çš„ si å’Œ so æŒ‡æ ‡å¯ä»¥æŸ¥çœ‹ï¼š siï¼šæ¯ç§’ä» Swap è¯»å–åˆ°å†…å­˜çš„æ•°æ®å¤§å° soï¼šæ¯ç§’ä»å†…å­˜å†™å…¥åˆ° Swap çš„æ•°æ®å¤§å°"},{"title":"æ•°æ®åº“ç›¸å…³æ€»ç»“","date":"2021-10-29T06:35:18.520Z","updated":"2018-05-03T13:19:02.000Z","comments":true,"path":"back_posts/old_posts/æ•°æ®åº“ç›¸å…³æ€»ç»“.html","permalink":"https://orechou.github.io/back_posts/old_posts/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3%E6%80%BB%E7%BB%93.html","excerpt":"","text":"äº‹åŠ¡ACIDå››ä¸ªå•è¯çš„é¦–å­—æ¯ç»„åˆï¼šAtomicityã€Consistencyã€Isolationã€Durability Atomicityï¼ˆåŸå­æ€§ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡å¿…é¡»è¢«è§†ä¸ºä¸€ä¸ªæœ€å°ä¸å¯åˆ†å‰²çš„å·¥ä½œå•å…ƒï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œæäº¤å®ŒæˆæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚ Consistencyï¼ˆä¸€è‡´æ€§ï¼‰ï¼šç³»ç»Ÿçš„çŠ¶æ€æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€è½¬æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚ Isolationï¼ˆéš”ç¦»æ€§ï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰çš„æ“ä½œåœ¨æˆåŠŸæäº¤ä¹‹å‰ï¼Œå¯¹å…¶ä»–çš„äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚ Durabilityï¼ˆæŒä¹…æ€§ï¼‰ï¼š æ•°æ®åº“å¼•æ“æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒMysqlå°†æ¯ä¸ªæ•°æ®åº“ï¼ˆSchemaï¼‰ä¿å­˜ä¸ºæ•°æ®åº“ç›®å½•ä¸‹çš„ä¸€ä¸ªå­ç›®å½•ã€‚åˆ›å»ºè¡¨æ—¶ï¼ŒMysqlåœ¨æ•°æ®åº“å­ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå’Œè¡¨åŒåçš„.frmæ–‡ä»¶ä¿å­˜è¡¨çš„å®šä¹‰ã€‚ ä¾‹å¦‚ï¼šä¸»é”®çš„Auto incrementï¼Œæ˜¯åœ¨.frmæœ‰ä¸ªAuto_incrementå±æ€§è®°å½•äº†ä¸‹ä¸€ä¸ªAUTO_INCREMENTçš„å€¼ã€‚ Schemaä¸åŸºç¡€ç±»å‹ä¼˜åŒ–VARCHAR CHARVARCHARå­˜å‚¨å¯å˜é•¿å­—ç¬¦ä¸²ï¼ˆVARCHARéœ€è¦ä½¿ç”¨1æˆ–2ä¸ªé¢å¤–å­—èŠ‚è®°å½•å­—ç¬¦ä¸²é•¿åº¦ã€‚åˆ—é•¿åº¦å°äºç­‰äº255ï¼Œä½¿ç”¨1ä¸ªå­—èŠ‚ï¼Œå¦åˆ™ä¸¤ä¸ªå­—èŠ‚ï¼‰ï¼ŒCHARå­˜å‚¨å›ºå®šé•¿åº¦å­—ç¬¦ä¸²ã€‚ VARCHARç”±äºæ˜¯å˜é•¿ï¼Œèƒ½å¤Ÿå‡å°‘å­˜å‚¨çš„ç©ºé—´ã€‚ä½†Updateæ—¶ï¼Œæ•°æ®è¡Œå¯èƒ½ä¼šå˜é•¿å¯¼è‡´åšé¢å¤–çš„å·¥ä½œã€‚ä¾‹å¦‚ï¼šè¡Œå ç”¨ç©ºé—´å¢å¤§ï¼Œé¡µå†…æ— æ³•å­˜å‚¨ã€‚InnoDBä¼šé‡‡å–åˆ†é¡µæ¥ä½¿è¡Œå¯ä»¥æ”¾è¿›é¡µå†…ã€‚InnoDBä¼šå°†è¿‡é•¿çš„Varcharå­˜å‚¨ä¸ºBLOB é€‚åˆVARCHARçš„æƒ…å†µï¼šå­—ç¬¦ä¸²åˆ—çš„æœ€å¤§é•¿åº¦æ¯”å¹³å‡é•¿åº¦å¤§å¾ˆå¤šï¼›åˆ—çš„æ›´æ–°å°‘ï¼Œç¢ç‰‡ä¸æˆé—®é¢˜ï¼›ä½¿ç”¨äº†åƒUTF-8è¿™æ ·å¤æ‚çš„å­—ç¬¦é›†ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½ä½¿ç”¨äº†ä¸åŒçš„å­—èŠ‚æ•°å­˜å‚¨ã€‚ é€‚åˆCHARçš„æƒ…å†µï¼šå­˜å‚¨å¾ˆçŸ­çš„å­—ç¬¦ä¸²ï¼›æ‰€æœ‰çš„å­—ç¬¦ä¸²æ¥è¿‘åŒä¸€ä¸ªé•¿åº¦ã€‚ä¾‹å¦‚ï¼šé€‚åˆå­˜å‚¨å¯†ç çš„MD5çš„å€¼ï¼›å­˜å‚¨ç»å¸¸å˜æ›´çš„å€¼ã€‚ BLOB å’Œ TEXTä¸¤è€…éƒ½æ˜¯ä¸ºå­˜å‚¨å¾ˆå¤§çš„æ•°æ®è€Œè®¾è®¡çš„å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«é‡‡ç”¨äºŒè¿›åˆ¶å’Œå­—ç¬¦ä¸²æ–¹å¼å­˜å‚¨ã€‚æ‰€ä»¥TEXTæœ‰å­—ç¬¦é›†å’Œæ’åºè§„åˆ™ï¼Œè€ŒBLOBæ²¡æœ‰ã€‚MysqlæŠŠæ¯ä¸ªBLOBå’ŒTEXTå€¼å½“åšä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡å¤„ç†ã€‚å½“BLOBå’ŒTEXTå€¼å¤ªå¤§æ—¶ï¼ŒInnoDBä¼šä½¿ç”¨å¤–éƒ¨çš„å­˜å‚¨åŒºåŸŸæ¥å­˜å‚¨å®é™…çš„å€¼ï¼Œæ­¤æ—¶åœ¨è¡Œä¸­å­˜å‚¨ä¸€ä¸ª1~4å­—èŠ‚çš„æŒ‡é’ˆã€‚BLOBå’ŒTEXTä¸¤ç§å±æ€§çš„åˆ—ä¸èƒ½è¿›è¡Œç´¢å¼•ã€‚ DATETIME &amp; TIMESTAMPDATETIMEèƒ½ä¿å­˜å¤§èŒƒå›´çš„å€¼ï¼Œä»1001å¹´åˆ°9999å¹´ï¼Œç²¾åº¦ä¸ºç§’ã€‚8ä¸ªå­—èŠ‚ã€‚TIMESTAMPä¿å­˜å°èŒƒå›´çš„å€¼ï¼Œä»1970å¹´åˆ°2038å¹´ï¼Œç²¾åº¦ä¸ºç§’ã€‚4ä¸ªå­—èŠ‚ã€‚åŒUNIXæ—¶é—´æˆ³ã€‚ åº”å°½é‡ä½¿ç”¨TIMESTAMPï¼Œå…¶æ¯”DATETIMEç©ºé—´æ•ˆç‡æ›´é«˜ã€‚ ç´¢å¼•æŸ¥è¯¢ç±»å‹å…¨å€¼åŒ¹é…ï¼šå’Œç´¢å¼•ä¸­æ‰€æœ‰åˆ—è¿›è¡ŒåŒ¹é…åŒ¹é…æœ€å·¦å‰ç¼€ï¼šåªä½¿ç”¨ç´¢å¼•çš„ç¬¬ä¸€åˆ—åŒ¹é…åˆ—å‰ç¼€ï¼šåªåŒ¹é…æŸä¸€åˆ—çš„å€¼çš„å¼€å¤´éƒ¨åˆ†åŒ¹é…èŒƒå›´å€¼ï¼šæŸä¸€ç±»çš„å€¼æŒ‰ä¸€ä¸ªèŒƒå›´åŒ¹é… ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ å‡å°‘äº†æœåŠ¡å™¨æ‰«æçš„æ•°æ®é‡ å¸®åŠ©æœåŠ¡å™¨é¿å…æ’åºå’Œé›¶æ—¶è¡¨ å°†éšæœºIOå˜æˆé¡ºåºIOç¼ºç‚¹ å¢åŠ äº†ç£ç›˜ç©ºé—´çš„ä½¿ç”¨ å¢åŠ äº†æ•°æ®å¢åˆ æŸ¥æ”¹çš„æ“ä½œæ—¶é—´ï¼ˆè¦ç»´æŠ¤ç´¢å¼•ï¼‰"},{"title":"OSWorkflow","date":"2021-10-29T06:35:18.520Z","updated":"2016-11-20T09:38:34.000Z","comments":true,"path":"back_posts/old_posts/è§£æternå·¥ä½œæµ.html","permalink":"https://orechou.github.io/back_posts/old_posts/%E8%A7%A3%E6%9E%90tern%E5%B7%A5%E4%BD%9C%E6%B5%81.html","excerpt":"","text":"ç‰¹ç‚¹ï¼šæ²¡æœ‰å¥½çš„å¯è§†åŒ–å·¥å…·ï¼Œ2.8.0æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œä½†è¿™å·²ç»æ˜¯07å¹´çš„ç‰ˆæœ¬ã€‚ç›®å‰å®˜ç½‘å·²ç»æ²¡æœ‰å¯¹ä»–æä¾›æ›´æ–°ã€‚åŸç†ï¼šä¸»è¦åŸºäºæœ‰é™çŠ¶æ€æœºï¼ˆFinite state machineï¼‰ï¼Œå°†æ¯ä¸€ä¸ªçŠ¶æ€æè¿°æˆæµç¨‹ä¸­çš„ä¸€ä¸ªæ­¥éª¤ã€‚jaråŒ…ï¼šosworkflowã€oscoreã€propertySetã€‚ 1ã€åŸºæœ¬æ¦‚å¿µå·¥ä½œæµæè¿°æ–‡ä»¶ï¼Œä¸€ä¸ªxmlæ–‡ä»¶ã€‚wrokflow:ä¸€ä¸ªæ ¹å…ƒç´ ï¼Œä»£è¡¨äº†ä¸€ä¸ªå·¥ä½œæµã€‚ä¸€èˆ¬ç”±å¤šä¸ªstepæ„æˆï¼Œstepè¡¨ç¤ºä¸€ä¸ªæµç¨‹ã€‚step:æ¯ä¸€ä¸ªæ­¥éª¤ä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªactionï¼Œactionè¡¨ç¤ºä¸€ä¸ªåŠ¨ä½œã€‚æ¯æ‰§è¡Œå®Œä¸€ä¸ªæ­¥éª¤ï¼Œå°±ä¼šèµ°å‘ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚åœ¨ä¸åŒçš„æ­¥éª¤ä¹‹ä¸­æµç¨‹çš„çŠ¶æ€å¯ä»¥ä¸æ–­çš„æ”¹å˜ï¼ŒçŠ¶æ€ç±»åˆ«å¯ä»¥è®¾ç½®ã€‚action:æ¯ä¸€ä¸ªåŠ¨ä½œå¯ä»¥æœ‰ä¸€ä¸ªæ— æ¡ä»¶ç»“æœunconditional resultå’Œé›¶åˆ°å¤šä¸ªconditional resultæ¡ä»¶ç»“æœã€‚åœ¨resultä¸­æŒ‡å®šå®Œæˆä¹‹åçš„çŠ¶æ€ï¼Œå¹¶æŒ‡å®šè·³è½¬çš„ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚åœ¨beanshell è¡¨è¾¾å¼èŒƒå›´å†…ä¸­å§‹ç»ˆå­˜åœ¨ä¸‰ä¸ªå˜é‡ï¼Œentryã€contextå’Œstoreï¼Œåˆ†åˆ«æ˜¯WorkflowEntryã€WorkflowContextã€WorkflowStoreä¸‰ä¸ªå¯¹è±¡ã€‚beanshellæ˜¯ä¸€ç§å®Œå…¨ç¬¦åˆjavaè¯­æ³•çš„è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥ç†è§£ä¸ºå¯ä»¥åœ¨beanshellä¸­ç¼–å†™javaä»£ç ã€‚ 2ã€å®ç°ç»†èŠ‚1ã€é…ç½®æ•°æ®åº“ï¼Œè¿™æ˜¯ä½ å·¥ä½œæµä¸­æ•°æ®æµè½¬çš„æ•°æ®åº“æ¥æºã€‚å¯ä»¥é€‰æ‹©xmlé…ç½®æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿçš„åŠ¨æ€webå·¥ç¨‹çš„server.xmlæ–‡ä»¶ä¸­ï¼Œè®¾ç½®å¥½æ•°æ®åº“é©±åŠ¨ã€‚Ternå°†æ‰€æœ‰é…ç½®ä¿¡æ¯ä¿å­˜åœ¨Javaä»£ç ä¸­ã€‚2ã€æŒä¹…åŒ–ï¼ˆPersistenceï¼‰ã€‚å†…ç½®æä¾›äº†ï¼šMemoryStoreã€SerializableStoreã€JDBCStoreæ–¹å¼ã€‚ä¹Ÿå¯ä»¥è‡ªå·±ç»§æ‰¿WorkflowStoreæ¥å£ï¼Œå®ç°è‡ªå·±çš„éœ€æ±‚ã€‚3ã€è½½å…¥æµç¨‹å®šä¹‰æ–‡ä»¶ï¼ˆWorkflowFactoryï¼‰è¯»å–ç¼–å†™å¥½çš„xmlï¼Œå°†æµç¨‹è½½å…¥ã€‚å¯ä»¥ç»§æ‰¿AbstractWorkflowFactoryæ¥å®ç°è‡ªå·±çš„éœ€æ±‚ã€‚ 3ã€Ternæ¡†æ¶é‡Œå®ç°1ã€æµç¨‹æœåŠ¡ï¼ˆService.classï¼‰Serviceç”¨äºå®šä¹‰å¥½æµç¨‹çš„IDï¼Œæµç¨‹çš„åç§° ï¼Œæµç¨‹æ‰€å…³è”çš„å®ä½“æ•°æ®è¡¨åç§°ã€‚æ­¤å¤„çš„æµç¨‹ä¸æ˜¯æŒ‡çš„å…·ä½“çš„æµç¨‹ï¼Œè€Œæ˜¯æŒ‡çš„ä¸€ç§æµç¨‹ã€‚ä¸»è¦çš„å±æ€§ï¼šæµç¨‹IDï¼Œæµç¨‹åç§°ï¼Œæµç¨‹æè¿°ï¼Œæµç¨‹å…³è”çš„å®ä½“æ•°æ®ï¼ˆå¯ä»¥æœ‰å®ä½“ç±»ç±»åï¼Œä¹Ÿå¯ä»¥æ˜¯è¯¥å®ä½“ç±»åœ¨æ•°æ®åº“ä¸­çš„è¡¨åï¼‰ã€‚åœ¨åé¢æ–°å»ºç«‹ä¸€ä¸ªæµç¨‹çš„æ—¶å€™éƒ½è¦é€šè¿‡è¿™ä¸ªç±»å»è·å–ä¸€ç§æµç¨‹ï¼Œç„¶åæ–°å¢ä¸€ä¸ªæµç¨‹å®ä¾‹ã€‚2ã€æµç¨‹å®ä¾‹ï¼ˆProcess.classï¼‰Processç”¨äºå®šä¹‰ä¸€ä¸ªå…·ä½“çš„æµç¨‹ã€‚ä¹Ÿå³æ˜¯æ˜¯é€šè¿‡Serviceç”Ÿæˆçš„ä¸€ä¸ªæµç¨‹å®ä¾‹ã€‚ä¸»è¦çš„å±æ€§ï¼šæµç¨‹IDï¼Œæµç¨‹æœåŠ¡IDï¼Œå®ä½“æ•°æ®IDï¼Œæµç¨‹æè¿°ï¼Œå‘èµ·è€…IDï¼Œå‘èµ·æ—¶é—´ï¼Œç»“æŸæ—¶é—´ï¼Œåºåˆ—å·ï¼ŒçŠ¶æ€3ã€å·¥ä½œæµè®°å½•ï¼ˆWorkflowEntry.classï¼‰WorkflowEntryç”¨äºå®šä¹‰æè¿°ä¸€ä¸ªå·¥ä½œæµå®ä¾‹ã€‚ä¸»è¦å±æ€§ï¼šå·¥ä½œæµåç§°ã€å·¥ä½œæµçŠ¶æ€ã€æ˜¯å¦å·²ç»åˆå§‹åŒ–ã€idåœ¨ternä¸­å¯¹WorkflowEntryè¿›è¡Œäº†æ‰©å±•ï¼Œå¢åŠ äº†record(å®ä½“æ•°æ®è®°å½•)ã€user(å½“å‰æ“ä½œå‘˜)ã€service(è¯¥å·¥ä½œæµå¯¹åº”çš„æµç¨‹æœåŠ¡)ã€process(è¯¥å·¥ä½œæµçš„æµç¨‹å®ä¾‹)WorkflowEntryçš„idåœ¨æ–°å»ºçš„æ—¶å€™è¢«èµ‹å€¼ä¸ºprocessçš„id4ã€å·¥ä½œæµæŒä¹…åŒ–ï¼ˆWorkflowStoreï¼‰ç”¨äºæ•°æ®çš„æŒä¹…åŒ–ã€‚ternæ‰©å±•ç»§æ‰¿äº†JDBCWorkflowStoreã€‚ä¸»è¦çš„åŠŸèƒ½æ˜¯è´Ÿè´£ç®¡ç†æµç¨‹çš„æ‰§è¡Œè¿‡ç¨‹ã€‚ä¸»è¦çš„åŠŸèƒ½å‡½æ•°ï¼šfindStepså»è·å–æ•°æ®åº“ä¸­å·²ç»è¿›è¡Œçš„æµç¨‹æ­¥éª¤ã€‚å¯ä¼ å…¥å¤šç§å‚æ•°entryIdï¼ŒstategetNextEntrySequenceè·å–ä¸‹ä¸€æ­¥æµç¨‹çš„åºåˆ—å·createEntryæ–°å¢ä¸€ä¸ªWorkflowEntryå®ä¾‹findCurrentSteps();findHistorySteps();createCurrentStep();ternåœ¨æ•°æ®åº“ä¸­å»ºç«‹äº†è¡¨wf_stepinfoï¼Œä¸Šé¢çš„æ–¹æ³•éƒ½æ˜¯å¯¹wf_stepinfoè¿›è¡Œæ“ä½œã€‚5ã€å·¥ä½œæµå·¥å‚ä¸»è¦çš„è´Ÿè´£æµç¨‹çš„å®šä¹‰æ–¹é¢ã€‚WorkflowDescriptoråœ¨OSWorkflowä¸­è¡¨ç¤ºä¸€ä¸ªå¤„ç†ä¹‹åçš„æµç¨‹6ã€å·¥ä½œæµå¼•æ“ï¼ˆWorkflow.classï¼‰ternå®ç°äº†OSWorkflowæä¾›çš„å·¥ä½œæµå¼•æ“çš„æ¥å£ã€‚ternå°†å·¥ä½œæµå¼•æ“è®¾è®¡ä¸ºå•ä¾‹æ¨¡å¼ã€‚å¼•æ“ä¸­è®¾ç½®äº†ç¯å¢ƒä¸Šä¸‹æ–‡(Context)ï¼Œé‡Œé¢å­˜å‚¨äº†å½“å‰ç™»å½•çš„æ“ä½œå‘˜ã€‚å¼•æ“ä¸­æŒæœ‰äº†ä¸€ä¸ªè¿è¡Œå½“å‰å·¥ä½œæµçš„çº¿ç¨‹å¯¹è±¡ã€‚ä¸»è¦çš„åŠŸèƒ½å‡½æ•°ï¼šï¼ˆ1ï¼‰createInstance()ï¼šåˆ›å»ºå·¥ä½œæµçš„å®ä¾‹ï¼Œå³é€šè¿‡Serviceå’Œå®ä½“æ•°æ®recordåˆ›å»ºä¸€ä¸ªæµç¨‹ã€‚è¿™ä¸€æ­¥ä¼šåœ¨æ•°æ®åº“ä¸­getAvailableActions()ï¼šå‡½æ•°ä¸­æ ¹æ®WorkflowStoreï¼ŒIAPWorkflowEntryï¼ŒWorkflowDescriptorè¿™ä¸‰ä¸ªå¯¹è±¡ï¼Œè·å–åˆ°å½“å‰æ­¥éª¤ä¸­å¯åšçš„åŠ¨ä½œActionsgetPermissionHandler()ï¼šæ ¹æ®ä¼ å…¥çš„WorkflowDescriptorå’Œå·¥ä½œæµå¼•æ“ä¸­å­˜å‚¨çš„æ“ä½œå‘˜ï¼Œå¯ä»¥åˆ¤æ–­å‡ºå½“å‰æ“ä½œå‘˜çš„è§’è‰²æ˜¯å¦æœ‰æƒé™å‚ä¸æµç¨‹getCurrentSteps();getEntryState();getHistorySteps();ï¼šè°ƒç”¨äº†WorkflowStoreé‡Œé¢çš„æ–¹æ³•initialize()ï¼šæ–°å¢ä¸€ä¸ªå·¥ä½œæµæ¡ç›®ï¼ŒchangeEntryState()ï¼šå˜æ›´å·¥ä½œæµæ¡ç›®çš„çŠ¶æ€COMPLETED,CREATED,ACTIVATED,SUSPENDED,KILLEDã€‚doAction()ï¼šåšå·¥ä½œæµé‡Œé¢çš„æ“ä½œã€‚entryã€propertySetã€transientVarsè¿™äº›å˜é‡å¯é€šè¿‡"},{"title":"Tern Modelå±‚è§£æ","date":"2021-10-29T06:35:18.520Z","updated":"2016-11-08T08:54:26.000Z","comments":true,"path":"back_posts/old_posts/è§£æternæ¡†æ¶Modelå±‚.html","permalink":"https://orechou.github.io/back_posts/old_posts/%E8%A7%A3%E6%9E%90tern%E6%A1%86%E6%9E%B6Model%E5%B1%82.html","excerpt":"","text":"com.tern.dbdbå¯¹JDBCåšäº†å°è£…ï¼Œæä¾›äº†ä¸€ç³»åˆ—çš„å¯¹æ•°æ®åº“çš„æ“ä½œã€‚å‡½æ•°æä¾›äº†é“¾å¼çš„æ“ä½œã€‚dbè·å–app.ymlä¸­çš„é…ç½®è¿›è¡Œæ•°æ®åº“çš„è¿æ¥(ConnectionPoolç±»)ï¼Œæ”¯æŒäº†å¦‚MySqlã€Oracleã€Sqliteç­‰å¤šç§æ•°æ®åº“ã€‚æŸ¥è¯¢ç­‰è·å–çš„æ•°æ®åº“çš„æ•°æ®ä»¥DataTableï¼ˆè¿”å›ä¸€å¼ è¡¨çš„æ•°æ®ï¼‰ï¼Œæˆ–è€…ä»¥DataRowï¼ˆè¿”å›ä¸€æ¡æ•°æ®è¡Œçš„æ•°æ®ï¼‰\u0010ä½œä¸ºå¯¹è±¡è¿”å›ã€‚ com.tern.daodaoæ˜¯å¯¹dbçš„å†ä¸€æ¬¡åšçš„å°è£…ï¼Œä»è€Œæ»¡è¶³MVCä¸­çš„Modelå±‚çš„è¦æ±‚ã€‚\u0010 1ã€Modeldaoä¸­çš„æ ¸å¿ƒç±»ä¹‹ä¸€ï¼Œå®ç°äº†æ•°æ®æ¨¡å‹çš„å°è£…ã€‚å…¶å®šä¹‰äº†æ•°æ®è¡¨åç§°ã€æ‰€åŒ…å«çš„åˆ—ï¼ˆå±æ€§ï¼‰çš„ä¿¡æ¯ï¼ˆå¦‚ï¼šåˆ—åã€åˆ—æ•°æ®ç±»å‹ã€çº¦æŸæ¡ä»¶ï¼‰å’Œä¸å…¶ä»–æ¨¡å‹ä¹‹é—´çš„å…³ç³»ä¿¡æ¯ã€‚MoodelReaderæ˜¯æ¨¡å‹çš„è¯»å–å™¨ï¼ˆæŠ½è±¡ç±»ï¼‰ï¼ŒDefaultModelReaderï¼ˆæ•°æ®åº“å…ƒæ•°æ®è¯»å–ï¼‰ã€YamlModelReaderï¼ˆYamlæ–‡ä»¶è¯»å–ï¼‰ã€DBModelReaderï¼ˆæ•°æ®åº“è¯»å–ï¼‰æ˜¯ä¸‰ä¸ªå®ç°ã€‚ è·å–Modelçš„æ–¹æ³•form(String name, Database db)è¿™æ˜¯ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒå®é™…å»è°ƒç”¨protectedå£°æ˜çš„æ„é€ æ–¹æ³•Model(String name, Database h)ï¼Œè¯¥æ„é€ æ–¹æ³•ä¸­ï¼Œé¦–å…ˆå°è¯•å»ä»yamlä¸­è¯»å–æ•°æ®æ¨¡å‹çš„schemaï¼Œè‹¥ä¸å­˜åœ¨çš„è¯æ‰ä¼šå»æ•°æ®åº“ä¸­è·å–schemaã€‚æ„é€ æ–¹æ³•ä¸­è°ƒç”¨ModelReaderçš„å®ç°ç±»å»è¯»å–schemaï¼Œè¯»å–columnsçš„ä¿¡æ¯ã€captionã€titleç­‰æ•°æ®å¹¶è§£æï¼ˆè¿™äº›æ•°æ®éƒ½æ˜¯ä»¥é”®å€¼å¯¹çš„å½¢å¼ä½œå­˜å‚¨ï¼Œmapï¼Œæ–¹ä¾¿è§£æ)ã€‚åœ¨å…ƒæ•°æ®åº“ä¸­å­˜å‚¨äº†å¯¹äºModelå®šä¹‰ã€Modelçš„åˆ—/å­—æ®µå®šä¹‰ã€Modelä¹‹é—´çš„å…³ç³»å®šä¹‰ã€å…³ç³»ä¸­çš„å­—æ®µæ˜ å°„å…³ç³»çš„æ•°æ®ï¼Œåˆ†åˆ«ä¸ºiap_entitiesã€iap_columnsã€iap_relationsã€iap_relation_mapè¿™å‡ å¼ è¡¨ã€‚ 2ã€RecordæŠ½è±¡æ„ä¹‰æ˜¯ä¸€æ¡æ•°æ®è®°å½•ã€‚Recrodæ˜¯ä¸€ä¸ªå®ç°äº†Map&lt;String, Object&gt;æ¥å£çš„ç±»ã€‚æ¯ä¸€ä¸ªRecordç±»çš„å†…éƒ¨éƒ½æŒæœ‰è¯¥æ•°æ®è®°å½•çš„modelï¼Œrowå³æ˜¯è¯¥Recordæ•°æ®ä¸­çš„æ‰€æœ‰åˆ—çš„é”®å€¼å¯¹ã€‚æœ‰è¿™ä¸¤ä¸ªå†…éƒ¨å®ä¾‹ï¼ŒRecordç±»å³å¯è¡¨ç¤ºæ‰€æœ‰å®šä¹‰äº†Modelçš„å®é™…æ•°æ®åº“å¯¹è±¡ã€‚ 3ã€RecordSetæŠ½è±¡æ„ä¹‰æ˜¯æ•°æ®è®°å½•çš„é›†åˆã€‚å…¶æŒæœ‰æ•°æ®æ¨¡å‹modelï¼Œè¿˜æœ‰ä¸€ä¸ªQueryç±»ï¼ˆdbæä¾›çš„æ•°æ®åº“æŸ¥è¯¢çš„å·¥å…·ç±»ï¼‰ã€‚é€šè¿‡modelä¸­çš„è¡¨åç§°ï¼Œå’ŒQueryç±»ï¼ŒRecordSetå¯ä»¥æŸ¥è¯¢æ•°æ®åº“ä¸­å¹¶è¿”å›è®°å½•ã€‚è¿”å›çš„è®°å½•ä»¥RecordSetçš„å¯¹è±¡å­˜å‚¨ã€‚RecordSetå®šä¹‰äº†å¾ˆå¤šè®¿é—®æ•°æ®åº“è¿”å›æ•°æ®çš„æ–¹æ³•ã€‚ 4ã€Modelä¸­çš„CURDModelä¸­æä¾›äº†query(String where, Object[] params)ç­‰æ–¹æ³•ï¼Œè¯»å–æ•°æ®åº“ï¼Œè¿”å›RecordSetæ•°æ®ã€‚å…¶å®æ˜¯è°ƒç”¨äº†RecordSetçš„æ–¹æ³•ã€‚å¦å¤–Modelæä¾›äº†æ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹çš„æ–¹æ³•ã€‚ æ€»ç»“com.tern.dbçš„å°è£…æ˜¯æä¾›ä¸€ç§è®¿é—®æ•°æ®åº“çš„ç®€ä¾¿æ–¹æ³•ï¼Œcom.tern.daoçš„å°è£…æ˜¯æä¾›ä¸€ç§æ“ä½œæ¨¡å‹ç®€ä¾¿æ–¹æ³•ã€‚ç®€å•æ¥è¯´ï¼Œåœ¨å®é™…å¼€å‘ä¹‹ä¸­è®¾è®¡å¥½æ•°æ®åº“ä¹‹åï¼Œå¯ä»¥å…ˆè¡Œä¸€æ­¥é…ç½®å¥½Modelï¼Œternå¹³å°æä¾›äº†ideçš„ç½‘é¡µå¹³å°å°†Modelå½•å…¥è¿›å…ƒæ•°æ®åº“ä¸­ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä¸ç”¨åœ¨å®é™…çš„é¡¹ç›®ä¹‹ä¸­å†ç¼–å†™entityç±»ï¼Œå› ä¸ºæ¨¡å‹modelå·²ç»å­˜åœ¨ï¼Œè€Œä¸”å¾—ç›Šäºrecordçš„æŠ½è±¡ã€‚Modelå¯ä»¥å»æ•°æ®åº“è¯»å–æ•°æ®ï¼Œè€Œè¿”å›çš„æ•°æ®å¯ä»¥ç”¨recordçš„å®¹çº³ã€‚"},{"title":"Linux IO åŸç†","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-19T08:40:37.000Z","comments":true,"path":"back_posts/old_posts/Linux/Linux-IO-åŸç†.html","permalink":"https://orechou.github.io/back_posts/old_posts/Linux/Linux-IO-%E5%8E%9F%E7%90%86.html","excerpt":"åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä¸»è¦ä»‹ç»äº† Java NIO ç›¸å…³åŸºç¡€å’Œ Reactor æ¨¡å¼ï¼ŒNIO çš„å®ç°åœ¨ä¸åŒçš„å¹³å°ä¸Šä¾èµ–äºæ“ä½œç³»ç»Ÿæ‰€æä¾›çš„ç³»ç»Ÿè°ƒç”¨ã€‚ä¸‹é¢å°†ä»‹ç» NIO åœ¨ Linux å¹³å°ä¸Šçš„åº•å±‚å®ç°åŸç†ã€‚","text":"åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ä¸»è¦ä»‹ç»äº† Java NIO ç›¸å…³åŸºç¡€å’Œ Reactor æ¨¡å¼ï¼ŒNIO çš„å®ç°åœ¨ä¸åŒçš„å¹³å°ä¸Šä¾èµ–äºæ“ä½œç³»ç»Ÿæ‰€æä¾›çš„ç³»ç»Ÿè°ƒç”¨ã€‚ä¸‹é¢å°†ä»‹ç» NIO åœ¨ Linux å¹³å°ä¸Šçš„åº•å±‚å®ç°åŸç†ã€‚ æ“ä½œç³»ç»ŸåŸºç¡€é¦–å…ˆäº†è§£ä¸€ä¸‹ç±» Unix æ“ä½œç³»ç»Ÿä½“ç³»ç»“æ„ä¸åŸºæœ¬æ¦‚å¿µã€‚ ç±» Unix çš„ä½“ç³»ç»“æ„ æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆkernelï¼‰çš„æœ¬è´¨æ˜¯ä¸€ä¸ªè½¯ä»¶ï¼šå¯ä»¥æ§åˆ¶è®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºï¼Œå¹¶æä¾›ä¸Šå±‚åº”ç”¨ç¨‹åºè¿è¡Œçš„ç¯å¢ƒã€‚å†…æ ¸æ‹¥æœ‰å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„ç©ºé—´å’Œåº•å±‚ç¡¬ä»¶è®¾å¤‡çš„æƒé™ã€‚ ç”¨æˆ·æ‰€ç¼–å†™çš„ç¨‹åºä¸èƒ½ç›´æ¥å»è®¿é—®å†…æ ¸ä»£ç ï¼Œéœ€è¦é€šè¿‡æ¥å£ï¼Œè¿™äº›æ¥å£è¢«è®¾è®¡ä¸ºç³»ç»Ÿè°ƒç”¨ï¼ˆsystem callï¼‰ã€‚å…¬ç”¨å‡½æ•°åº“å»ºç«‹åœ¨ç³»ç»Ÿè°ƒç”¨ä¹‹ä¸Šï¼Œåº”ç”¨ç¨‹åºå³å¯ä»¥ç›´æ¥ä½¿ç”¨å…¬ç”¨å‡½æ•°åº“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚ä¾‹å¦‚ fread æ˜¯ C æ ‡å‡†åº“å‡½æ•°ï¼Œread æ˜¯ç³»ç»Ÿè°ƒç”¨ã€‚ Shell æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åº”ç”¨ç¨‹åºï¼Œä¸ºè¿è¡Œå…¶ä»–åº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªæ¥å£ã€‚æœ€å¤–å±‚çš„æ˜¯åº”ç”¨ç¨‹åºã€‚ ç”¨æˆ·æ€ &amp; å†…æ ¸æ€ç±» Unix çš„ä½“ç³»æ¶æ„å¯ä»¥åˆ†ä¸ºç”¨æˆ·æ€å’Œå†…æ ¸æ€ã€‚æ“ä½œç³»ç»Ÿå°†è™šæ‹Ÿç©ºé—´åˆ’åˆ†æˆç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¹¶åˆ’åˆ†äº†ç‰¹æƒçº§ï¼ŒIntel x86 æ¶æ„çš„ cpu ä¸€å…±æœ‰ 0ï½3 å››ä¸ªç‰¹æƒçº§ï¼Œæ•°å­—è¶Šå°ï¼Œç‰¹æƒè¶Šé«˜ï¼Œåœ¨ Unix/Linux ä¸­æŒ‡ä½¿ç”¨äº† 0 å’Œ 3 ä¸¤ä¸ªç‰¹æƒçº§ï¼Œåˆ†åˆ«è¡¨ç¤ºå†…æ ¸æ€å’Œç”¨æˆ·æ€ã€‚ ç”¨æˆ·åº”ç”¨ç¨‹åºä¸€èˆ¬åœ¨ç”¨æˆ·æ€ä¸‹è¿è¡Œï¼Œå½“éœ€è¦æ“ä½œç³»ç»Ÿä»‹å…¥æ—¶ï¼Œå°±ä¼šåˆ‡æ¢åˆ°ç”¨æˆ·æ€ã€‚ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢æ–¹å¼ï¼š ç³»ç»Ÿè°ƒç”¨ï¼šç”¨æˆ·æ€è¿›ç¨‹ä¸»åŠ¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨ç”³è¯·æ“ä½œç³»ç»Ÿæä¾›çš„æœåŠ¡ç¨‹åºã€‚ï¼ˆç³»ç»Ÿè°ƒç”¨çš„æœ¬è´¨å…¶å®ä¹Ÿæ˜¯ä¸­æ–­ï¼Œç›¸å¯¹äºå¤–å›´è®¾å¤‡çš„ç¡¬ä¸­æ–­ï¼Œè¿™ç§ä¸­æ–­ç§°ä¸ºè½¯ä¸­æ–­ï¼‰ å¼‚å¸¸ï¼šå½“CPUæ­£åœ¨æ‰§è¡Œè¿è¡Œåœ¨ç”¨æˆ·æ€çš„ç¨‹åºæ—¶ï¼Œçªç„¶å‘ç”ŸæŸäº›é¢„å…ˆä¸å¯çŸ¥çš„å¼‚å¸¸äº‹ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘ä»å½“å‰ç”¨æˆ·æ€æ‰§è¡Œçš„è¿›ç¨‹è½¬å‘å†…æ ¸æ€æ‰§è¡Œç›¸å…³çš„å¼‚å¸¸äº‹ä»¶ï¼Œå…¸å‹çš„å¦‚ç¼ºé¡µå¼‚å¸¸ã€‚ å¤–è®¾ä¸­æ–­ï¼šå½“å¤–å›´è®¾å¤‡å®Œæˆç”¨æˆ·çš„è¯·æ±‚æ“ä½œåï¼Œä¼šåƒCPUå‘å‡ºä¸­æ–­ä¿¡å·ï¼Œæ­¤æ—¶ï¼ŒCPUå°±ä¼šæš‚åœæ‰§è¡Œä¸‹ä¸€æ¡å³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œè½¬è€Œå»æ‰§è¡Œä¸­æ–­ä¿¡å·å¯¹åº”çš„å¤„ç†ç¨‹åºï¼Œå¦‚æœå…ˆå‰æ‰§è¡Œçš„æŒ‡ä»¤æ˜¯åœ¨ç”¨æˆ·æ€ä¸‹ï¼Œåˆ™è‡ªç„¶å°±å‘ç”Ÿä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„è½¬æ¢ã€‚ Linux è¿›ç¨‹åœ°å€ç©ºé—´ä¸‹å›¾æ˜¯ Linux è¿›ç¨‹çš„å†…å­˜åœ°å€ç©ºé—´ï¼Œä»¥ 32 ä½çš„æ“ä½œç³»ç»Ÿä¸ºä¾‹ã€‚ åœ°å€ç©ºé—´åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œç”¨æˆ·ç©ºé—´ï¼ˆ0x00000000 ~ 0xBFFFFFFFï¼‰å’Œå†…æ ¸ç©ºé—´ï¼ˆ0xC0000000 ~ 0xFFFFFFFFï¼‰ã€‚ä¸åŒçš„è¿›ç¨‹ç”¨æˆ·ç©ºé—´æ˜¯ç§æœ‰çš„ã€‚å†…æ ¸ç©ºé—´æ˜¯æŒç»­å­˜åœ¨çš„ï¼Œå¹¶ä¸”æ˜¯å…±äº«çš„ï¼Œæ‰€æœ‰è¿›ç¨‹ä¸­éƒ½æ˜ å°„åˆ°åŒæ ·çš„ç‰©ç†å†…å­˜ï¼Œå†…æ ¸ä»£ç å’Œæ•°æ®æ€»æ˜¯å¯å¯»å€çš„ï¼Œéšæ—¶å‡†å¤‡å¤„ç†ä¸­æ–­å’Œç³»ç»Ÿè°ƒç”¨ã€‚ ç”¨æˆ·ç©ºé—´çš„ç”±å¦‚ä¸‹çš„å†…å®¹ç»„æˆï¼š Text Segmetï¼ˆELFï¼Œæ–‡æœ¬æ®µï¼‰ï¼šç¨‹åºä»£ç åœ¨å†…å­˜ä¸­çš„æ˜ å°„ï¼Œå­˜æ”¾äºŒè¿›åˆ¶ä»£ç ã€‚ Data Segmetï¼ˆåˆå§‹åŒ–è¿‡çš„æ•°æ®æ®µï¼‰ï¼šå­˜æ”¾ç¨‹åºè¿è¡Œæ—¶å·²ç»åˆå§‹åŒ–èµ‹å€¼çš„é™æ€å˜é‡æ•°æ®ï¼ˆè¢«ç¨‹åºå‘˜åˆå§‹åŒ–ï¼‰ã€‚ BSS Segmentï¼ˆæœªåˆå§‹åŒ–çš„æ•°æ®æ®µï¼‰ï¼šå­˜æ”¾ç¨‹åºè¿è¡Œæ—¶æœªè¢«åˆå§‹åŒ–çš„é™æ€å˜é‡æ•°æ®ã€‚ Heapï¼šå­˜å‚¨åŠ¨æ€å†…å­˜åˆ†é…ï¼Œéœ€è¦ç¨‹åºå‘˜æ‰‹å·¥åˆ†é…ï¼Œæ‰‹å·¥é‡Šæ”¾ã€‚ä¸æ•°æ®ç»“æ„ä¸­çš„å †æ˜¯ä¸¤å›äº‹ï¼Œåˆ†é…æ–¹å¼ç±»ä¼¼äºé“¾è¡¨ã€‚ æ ˆï¼šå½“æœ‰æ–¹æ³•çš„è°ƒç”¨çš„æ—¶å€™ä¼šäº§ç”Ÿä¸€ä¸ªæ–¹æ³•æ ˆå¸§è¿›è¡Œå‹æ ˆã€‚æ ˆå¸§ä¸­å­˜å‚¨å±€éƒ¨ã€ä¸´æ—¶å˜é‡ï¼Œå‡½æ•°è°ƒç”¨ï¼Œå­˜å‚¨å‡½æ•°çš„è¿”å›æŒ‡é’ˆï¼Œç”¨äºæ§åˆ¶å‡½æ•°çš„è°ƒç”¨å’Œè¿”å›ã€‚æ ˆå¸§åœ¨å‡½æ•°ç¨‹åºå—å¼€å§‹æ—¶è‡ªåŠ¨åˆ†é…å†…å­˜ï¼Œç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜ã€‚ æ•°æ®è¯»å†™Linux çš„æ•°æ®è¯»å†™æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¼ ç»Ÿçš„è¯»å†™ä¸é›¶æ‹·è´æŠ€æœ¯ã€‚ä¼ ç»Ÿçš„è¯»å†™æ•°æ®éœ€è¦å¤åˆ¶ä¸¤æ¬¡ï¼Œé›¶æ‹·è´æŠ€æœ¯åªéœ€è¦å¤åˆ¶ä¸€æ¬¡ã€‚ä¸‹é¢ä»¥æ–‡ä»¶è¯»å†™ä¸ºä¾‹ï¼Œç®€è¦è¯´æ˜ä¸€ä¸‹ä¼ ç»Ÿçš„è¯»å†™ã€‚ è¯»æ•°æ® å½“åº”ç”¨ç¨‹åºéœ€è¦è¯»å†™ç£ç›˜ä¸Šçš„æ•°æ®æ—¶ï¼Œä¼šä½¿ç”¨å†…æ ¸çš„ç³»ç»Ÿè°ƒç”¨ã€‚æ•°æ®é¦–å…ˆé€šè¿‡ DMAï¼ˆDirect Memory Accessï¼‰å°†ç£ç›˜ä¸Šçš„æ•°æ®å¤åˆ¶åˆ°å†…æ ¸çš„ç¼“å†²åŒºä¸­ï¼Œç„¶ååº”ç”¨ç¨‹åºå†ä»å†…æ ¸ç¼“å†²åŒºä¸­å°†æ•°æ®å¤åˆ¶åˆ°åº”ç”¨ç¼“å†²åŒºã€‚ å†™æ•°æ® å½“åº”ç”¨ç¨‹åºéœ€è¦å°†æ•°æ®ä¼ é€ç»™å¦å¤–ä¸€ä¸ªå®¢æˆ·ç«¯æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨å†…æ ¸çš„ç³»ç»Ÿè°ƒç”¨ã€‚åº”ç”¨ç¨‹åºé¦–å…ˆå°†æ•°æ®å†™å…¥åˆ°å†…æ ¸çš„ socket ç¼“å†²åŒºä¸­ï¼Œç„¶åå†é€šè¿‡ DMA å°†æ•°æ®å‘ç»™ socket è¿æ¥çš„å¦ä¸€ç«¯ã€‚ DMA copyã€‚è¿™æ˜¯ä¸€ç§é€šè¿‡ç¡¬ä»¶å®ç°çš„æ•°æ®ä¼ è¾“æœºåˆ¶ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯ä¸åœ¨CPUçš„å‚ä¸ä¸‹å®Œæˆæ•°æ®çš„ä¼ è¾“ã€‚ CPU copy ã€‚ ç›¸æ¯”DMAè€Œè¨€ï¼Œcopyçš„è¿‡ç¨‹éœ€è¦ç”¨åˆ°cpu å¯„å­˜å™¨ç­‰,é€Ÿåº¦è¾ƒæ…¢ã€‚ é›¶æ‹·è´æŠ€æœ¯è€ƒè™‘ä¸€ä¸ªåº”ç”¨åœºæ™¯ï¼ŒæœåŠ¡å™¨ç¨‹åºç»å¸¸éœ€è¦å°†ä¸€äº›æ•°æ®é€šè¿‡ç½‘ç»œä¼ è¾“ç»™å¦å¤–ä¸€ä¸ªç¨‹åºã€‚ ä¼ ç»Ÿæ–¹å¼ä¼ ç»Ÿçš„å¤„ç†æ–¹å¼æ˜¯å…ˆå°†æ•°æ®ä»ç£ç›˜ä¸Šè¯»å‡ºæ¥ï¼Œç„¶åå†å°†æ•°æ®é€šè¿‡ socket å†™å‡ºå»ã€‚è¿™ä¼šä½¿ç”¨ä¸¤ä¸ªå‡½æ•°ï¼š 12File.read(fileDesc, buf, len);Socket.send(socket, buf, len); æµç¨‹å›¾å¦‚ä¸‹ï¼š ç”±å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ•°æ®ä¸€å…±è¢«å¤åˆ¶äº† 4 æ¬¡ï¼š ç£ç›˜å¤åˆ¶åˆ°å†…æ ¸ Read Buffer Read Buffer å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ Buffer ç”¨æˆ·ç©ºé—´ Buffer å¤åˆ¶åˆ° Socket Buffer Socket Buffer å¤åˆ¶åˆ° NIC Buffer æ³¨ï¼šNICï¼ˆnetwork interface cardï¼‰ åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­æ•°æ®ä¸€å…±å¤åˆ¶äº† 4 æ¬¡ï¼Œç”¨æˆ·æ€-å†…æ ¸æ€åˆ‡æ¢äº† 4 æ¬¡ã€‚Read ä¸¤æ¬¡ï¼ŒSend ä¸¤æ¬¡ã€‚ é›¶æ‹·è´é›¶æ‹·è´æŠ€æœ¯è®©æ•´ä¸ªæ•°æ®å¤åˆ¶çš„è¿‡ç¨‹ä¸­ä¸éœ€è¦ç”¨æˆ·çš„å‚ä¸ï¼Œå³æ•°æ®ä¼ è¾“ç›´æ¥åœ¨å†…æ ¸ä¸­å®Œæˆï¼Œä¸éœ€è¦å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´çš„ç¼“å­˜ä¸­ã€‚ 12// out_fd: socket æˆ–è€… file éƒ½å¯ä»¥ç”¨ fd è¡¨ç¤ºssize_t sendfile(int out_fd, int in_fd, off_t *offset, size_t count); æµç¨‹å›¾å¦‚ä¸‹ï¼š æ•°æ®ä»ç£ç›˜å¤åˆ¶åˆ°å†…æ ¸ Read Buffer ä¸­åï¼Œç›´æ¥å¤åˆ¶åˆ° Socket Buffer ä¸­ã€‚ æ‰€ä»¥æ•´ä¸ªè¿‡ç¨‹ä¸­æ•°æ®åªéœ€è¦å¤åˆ¶ 3 æ¬¡ï¼Œç”¨æˆ·æ€-å†…æ ¸æ€åˆ‡æ¢äº†ä¸¤æ¬¡ã€‚ Linux IO æ¨¡å¼å¯¹äºä¸€æ¬¡ IO è®¿é—®ï¼ˆä»¥ read ä¸¾ä¾‹ï¼‰ï¼Œæ•°æ®ä¼šå…ˆè¢«æ‹·è´åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸çš„ç¼“å†²åŒºä¸­ï¼Œç„¶åæ‰ä¼šä»æ“ä½œç³»ç»Ÿå†…æ ¸çš„ç¼“å†²åŒºæ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´ã€‚æ‰€ä»¥è¯´ï¼Œå½“ä¸€ä¸ªreadæ“ä½œå‘ç”Ÿæ—¶ï¼Œå®ƒä¼šç»å†ä¸¤ä¸ªé˜¶æ®µï¼š ç­‰å¾…æ•°æ®å‡†å¤‡ (Waiting for the data to be ready)ï¼Œå³æ•°æ®å¤åˆ¶åˆ°å†…æ ¸çš„ç¼“å†²åŒºã€‚ å°†æ•°æ®ä»å†…æ ¸æ‹·è´åˆ°è¿›ç¨‹ä¸­ (Copying the data from the kernel to the process)ï¼Œå†…æ ¸ç¼“å†²åŒºåˆ°ç”¨æˆ·ç©ºé—´çš„ç¼“å†²åŒºã€‚ linux ä¸€å…±æœ‰ä¸‹é¢äº”ç§ IO æ¨¡å¼ï¼š é˜»å¡ IOï¼ˆblocking IOï¼‰ éé˜»å¡ IOï¼ˆnonblocking IOï¼‰ IO å¤šè·¯å¤ç”¨ï¼ˆ IO multiplexingï¼‰ ä¿¡å·é©±åŠ¨ IOï¼ˆ signal driven IOï¼‰ å¼‚æ­¥ IOï¼ˆasynchronous IOï¼‰ åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œä¿¡å·é©±åŠ¨ IO å¹¶ä¸å¸¸ç”¨ã€‚ æ–‡ä»¶æè¿°ç¬¦ï¼ˆFile descriptorï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­çš„ä¸€ä¸ªæœ¯è¯­ï¼Œæ˜¯ä¸€ä¸ªç”¨äºè¡¨è¿°æŒ‡å‘æ–‡ä»¶çš„å¼•ç”¨çš„æŠ½è±¡åŒ–æ¦‚å¿µã€‚ æ–‡ä»¶æè¿°ç¬¦åœ¨å½¢å¼ä¸Šæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚å®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªç´¢å¼•å€¼ï¼ŒæŒ‡å‘å†…æ ¸ä¸ºæ¯ä¸€ä¸ªè¿›ç¨‹æ‰€ç»´æŠ¤çš„è¯¥è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„è®°å½•è¡¨ã€‚å½“ç¨‹åºæ‰“å¼€ä¸€ä¸ªç°æœ‰æ–‡ä»¶æˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œå†…æ ¸å‘è¿›ç¨‹è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œä¸€äº›æ¶‰åŠåº•å±‚çš„ç¨‹åºç¼–å†™å¾€å¾€ä¼šå›´ç»•ç€æ–‡ä»¶æè¿°ç¬¦å±•å¼€ã€‚ä½†æ˜¯æ–‡ä»¶æè¿°ç¬¦è¿™ä¸€æ¦‚å¿µå¾€å¾€åªé€‚ç”¨äº Unixã€Linuxè¿™æ ·çš„æ“ä½œç³»ç»Ÿã€‚ é˜»å¡ IOï¼ˆBlocking IOï¼‰åœ¨ Linux ä¸­æ‰€æœ‰çš„ IO é»˜è®¤éƒ½æ˜¯é˜»å¡æ¨¡å¼ï¼Œé˜»å¡ IO çš„æµç¨‹å¦‚ä¸‹ï¼š recvfrom æ˜¯ä» socket æ¥å—æ•°æ®çš„ç³»ç»Ÿè°ƒç”¨ã€‚ 1234ssize_t recv(int sockfd, void *buf, size_t len, int flags);ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);ssize_t recvmsg(int sockfd, struct msghdr *msg, int flags); å½“ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œå†…æ ¸ä¼šä»‹å…¥å®Œæˆä¸¤éƒ¨åˆ†æ“ä½œï¼š å‡†å¤‡æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®è¢«æ‹·è´åˆ°æ“ä½œç³»ç»Ÿå†…æ ¸çš„ç¼“å†²åŒºä¸­æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œä¸ç®¡æ˜¯å¤åˆ¶ç£ç›˜æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œè¿˜æ˜¯æ¥æ”¶ socket ä¼ è¾“çš„æ•°æ®ã€‚è€Œç­‰å¾…è¿™ä¸€ä¸ªè¿‡ç¨‹ï¼Œç”¨æˆ·è¿›ç¨‹ä¼šå°†è‡ªå·±é˜»å¡ã€‚ å½“å†…æ ¸ä¸­çš„ç¼“å†²åŒºå·²ç»å°†æ•°æ®å¤åˆ¶å¥½ä¹‹åï¼Œå°±ä¼šå°†æ•°æ®ä»å†…æ ¸ä¸­çš„ç¼“å†²åŒºå¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ä¸­çš„ç¼“å†²åŒºã€‚å¤åˆ¶å®Œæˆä¹‹åè¿”å›ç»“æœï¼Œç”¨æˆ·è¿›ç¨‹ç»§ç»­æ‰§è¡Œã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç”¨æˆ·è¿›ç¨‹åœ¨ IO æ“ä½œçš„ä¸¤ä¸ªé˜¶æ®µä¸­éƒ½æ˜¯è¢«é˜»å¡çš„ã€‚ éé˜»å¡ IOï¼ˆNonBlocking IOï¼‰éé˜»å¡ IO çš„æµç¨‹å¦‚ä¸‹ï¼š åœ¨ Linux ä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼å°† IO è®¾ç½®ä¸ºéé˜»å¡ IOï¼š 123456789// 1.åˆ›å»ºsocketçš„æ—¶å€™ï¼ŒæŒ‡å®š socket æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨ type çš„å‚æ•°ä¸­è®¾ç½® SOCK_NONBLOCK æ ‡å¿—å³å¯ã€‚int socket(int domain, int type, int protocol);int s = socket(AF_INET, SOCK_STREAM | SOCK_NONBLOCK, IPPROTO_TCP);// 2.ä½¿ç”¨fcntlå‡½æ•°ã€‚fcntl(sockfd, F_SETFL, fcntl(sockfd, F_GETFL, 0) | O_NONBLOCK);// 3.ä½¿ç”¨ioctlå‡½æ•°ã€‚1:éé˜»å¡ 0:é˜»å¡ã€‚ioctl(sockfd, FIONBIO, 1); éé˜»å¡ IO ä¸é˜»å¡ IO çš„åŒºåˆ«åœ¨äºï¼Œåœ¨æ•°æ®å‡†å¤‡çš„é˜¶æ®µï¼Œç”¨æˆ·è¿›ç¨‹ä¸éœ€è¦ç­‰å¾…è¯¥é˜¶æ®µå®Œæˆã€‚ç”¨æˆ·è¿›ç¨‹ä¼šä¸æ–­åœ°å»è¯¢é—®è¿™ä¸ªè¿‡ç¨‹æ˜¯å¦å®Œæˆï¼Œè‹¥æœªå®Œæˆç”¨æˆ·è¿›ç¨‹ä¹Ÿä¼šæ”¶åˆ°ä¸€ä¸ªå›å¤ï¼Œè‹¥å·²å®Œæˆåˆ™å¼€å§‹ç¬¬äºŒé˜¶æ®µæ•°æ®çš„å¤åˆ¶ã€‚ å¤šè·¯å¤ç”¨ IOï¼ˆIO Multiplexingï¼‰å¤šè·¯å¤ç”¨ IO ä¹Ÿè¢«ç§°ä¸ºäº‹ä»¶é©±åŠ¨ IOï¼Œæµç¨‹å¦‚ä¸‹ï¼š IO å¤šè·¯å¤ç”¨é€šè¿‡ selectã€pollã€epoll å®ç°ã€‚IO å¤šè·¯å¤ç”¨ä¼˜ç‚¹åœ¨äºå•ä¸ª process å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªç½‘ç»œè¿æ¥çš„IOã€‚å®ƒçš„åŸºæœ¬åŸç†å°±æ˜¯ selectï¼Œpollï¼Œepoll å‡½æ•°ä¼šä¸æ–­çš„è½®è¯¢æ‰€è´Ÿè´£çš„æ‰€æœ‰è¿æ¥çš„ socketï¼Œå½“æŸä¸ª socket æœ‰æ•°æ®åˆ°è¾¾ï¼Œå°±é€šçŸ¥ç”¨æˆ·è¿›ç¨‹ã€‚ å½“ç”¨æˆ·è°ƒç”¨äº† select åï¼Œç”¨æˆ·è¿›ç¨‹éœ€è¦ç­‰å¾… select å‡½æ•°çš„è¿”å›ï¼Œå³æœ‰ socket çš„æ•°æ®å°±ç»ªã€‚åœ¨ Java ä¸­çš„ Selector æä¾›äº† select æ–¹æ³•å’Œ selectNow æ–¹æ³•ï¼Œå‰è€…éœ€è¦ç­‰å¾…æœ‰å°±ç»ªçš„è¯»å†™äº‹ä»¶ï¼Œè€Œåè€…å¯ä»¥ç›´æ¥è¿”å›ã€‚ 123456// allow a program to monitor multiple file descriptors, waiting until one or more of the file descriptors become &quot;ready&quot; for some class of I/O operationint select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout);// wait for some event on a file descriptorint poll(struct pollfd *fds, nfds_t nfds, int timeout); å¼‚æ­¥ IOï¼ˆAsynchronous IOï¼‰å¼‚æ­¥ IO æ˜¯çœŸæ­£çš„å¼‚æ­¥éé˜»å¡ IOï¼Œæµç¨‹å¦‚ä¸‹ï¼š ç”¨æˆ·è¿›ç¨‹å‘èµ· read æ“ä½œä¹‹åï¼Œå°±ç«‹åˆ»è¿”å›å¼€å§‹å»åšå…¶å®ƒçš„äº‹ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œä» kernel çš„è§’åº¦ï¼Œå½“å®ƒå—åˆ°ä¸€ä¸ªasynchronous read ä¹‹åï¼Œé¦–å…ˆå®ƒä¼šç«‹åˆ»è¿”å›ï¼Œæ‰€ä»¥ä¸ä¼šå¯¹ç”¨æˆ·è¿›ç¨‹äº§ç”Ÿä»»ä½• blockã€‚ç„¶åï¼Œkernelä¼šç­‰å¾…æ•°æ®å‡†å¤‡å®Œæˆï¼Œç„¶åå°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·å†…å­˜ï¼Œå½“è¿™ä¸€åˆ‡éƒ½å®Œæˆä¹‹åï¼Œkernelä¼šç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªsignalï¼Œå‘Šè¯‰å®ƒreadæ“ä½œå®Œæˆäº†ã€‚ å¯¹æ¯”åœ¨ non-blocking IO ä¸­ï¼Œè™½ç„¶è¿›ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¸ä¼šè¢« blockï¼Œä½†æ˜¯å®ƒä»ç„¶è¦æ±‚è¿›ç¨‹å»ä¸»åŠ¨çš„ checkï¼Œå¹¶ä¸”å½“æ•°æ®å‡†å¤‡å®Œæˆä»¥åï¼Œä¹Ÿéœ€è¦è¿›ç¨‹ä¸»åŠ¨çš„å†æ¬¡è°ƒç”¨ recvfrom æ¥å°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·å†…å­˜ã€‚è€Œ asynchronous IO åˆ™å®Œå…¨ä¸åŒã€‚å®ƒå°±åƒæ˜¯ç”¨æˆ·è¿›ç¨‹å°†æ•´ä¸ªIOæ“ä½œäº¤ç»™äº†ä»–äººï¼ˆkernelï¼‰å®Œæˆï¼Œç„¶åä»–äººåšå®Œåå‘ä¿¡å·é€šçŸ¥ã€‚åœ¨æ­¤æœŸé—´ï¼Œç”¨æˆ·è¿›ç¨‹ä¸éœ€è¦å»æ£€æŸ¥IOæ“ä½œçš„çŠ¶æ€ï¼Œä¹Ÿä¸éœ€è¦ä¸»åŠ¨çš„å»æ‹·è´æ•°æ®ã€‚ å¤šè·¯å¤ç”¨çš„åŸç†å‰é¢è¯´åˆ° Linux å®ç°å¤šè·¯å¤ç”¨æ˜¯é€šè¿‡ selectã€pollã€epoll å‡½æ•°å®ç°çš„ã€‚IO å¤šè·¯å¤ç”¨æ˜¯ä¸€ç§æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶æä¾›äº†å•ä¸ªè¿›ç¨‹ç›‘å¬å¤šä¸ª IO çš„èƒ½åŠ›ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡ç›‘å¬å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œä¸€æ—¦æŸä¸ªæè¿°ç¬¦çš„æŸç§äº‹ä»¶å°±ç»ªï¼ˆè¯»ã€å†™å°±ç»ªï¼‰ï¼Œå°±é€šçŸ¥ç¨‹åºè¿›ç¨‹è¯»å†™æ“ä½œã€‚ selectselect å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š 12// allow a program to monitor multiple file descriptors, waiting until one or more of the file descriptors become &quot;ready&quot; for some class of I/O operationint select (int n, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, struct timeval *timeout); select å…³æ³¨äº†ä¸‰ç§æè¿°ç¬¦ï¼Œreadfdsã€writefdsã€exceptfdsï¼Œåˆ†åˆ«æ˜¯è¯»ã€å†™å’Œå‘ç”Ÿå¼‚å¸¸çš„ã€‚å¯ä»¥é€šè¿‡è®¾ç½® timeout æ¥æŒ‡å®šç­‰å¾…äº‹ä»¶ï¼Œå½“å°† timeout è®¾ç½®ä¸º null æ—¶ï¼Œselect ä¼šç«‹å³è¿”å›ã€‚å‡½æ•°è¿”å›å€¼æ˜¯å°±ç»ªæ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡ï¼Œ0 è¡¨ç¤ºtimeoutï¼Œ-1 è¡¨ç¤ºå‡ºé”™ã€‚å‡½æ•°è¿”å›åè¦é€šè¿‡éå†çš„æ–¹å¼æ‰¾åˆ°å°±ç»ªçš„fdã€‚ select é‡‡ç”¨çš„æ˜¯è½®è¯¢çš„æ–¹å¼ç›‘å¬æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œå•ä¸ªè¿›ç¨‹èƒ½å¤Ÿç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦çš„æ•°é‡æœ‰æœ€å¤§é™åˆ¶ï¼Œåœ¨Unixä¸‹é€šå¸¸ä¸º256ï¼ŒLinux ä¸‹é€šå¸¸ä¸º1024ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ /sys/types.h å¤´æ–‡ä»¶ä¸­çš„ FD_SETSIZE å€¼ç„¶åé‡æ–°ç¼–è¯‘å†…æ ¸è¿›è¡Œä¿®æ”¹ã€‚ ç¼ºç‚¹ï¼š å¯ä»¥ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦æœ‰é™ã€‚ ä»¥è½®è¯¢çš„æ–¹å¼è¿›è¡Œæ£€æŸ¥æ˜¯å¦å°±ç»ªæ•ˆç‡ä½ã€‚ æ¯æ¬¡æ£€æŸ¥æ˜¯å¦å°±ç»ªè¦å°†æ‰€æœ‰éœ€è¦è¢«æ£€æŸ¥çš„ fd çš„æ•°æ®ç»“æ„å¤åˆ¶åˆ°å†…æ ¸ï¼Œå®Œæˆåä¿®æ”¹è¿™ä¸ªæ•°æ®ç»“æ„å¹¶è¿”å›ç»™ç¨‹åºï¼Œä»ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„æ¥å›æ‹·è´å°†å ç”¨å¤§é‡ CPUã€‚ ä¼˜ç‚¹ï¼šåœ¨æ‰€æœ‰çš„å¹³å°ä¸Šéƒ½æ”¯æŒ pollpoll å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š 12345678// wait for some event on a file descriptorint poll (struct pollfd *fds, unsigned int nfds, int timeout);struct pollfd &#123; int fd; /* file descriptor */ short events; /* requested events */ short revents; /* returned events */&#125;; poll ä¹Ÿæ˜¯ä»¥è½®è¯¢çš„æ–¹å¼è¿›è¡Œç›‘å¬ï¼Œä½†ä¸ select ä¸åŒçš„æ˜¯ poll æŠ›å¼ƒäº†ç”¨ä½å›¾å­˜å‚¨æ–‡ä»¶æè¿°ç¬¦çš„æ–¹å¼ï¼Œè€Œä½¿ç”¨ pollfdã€‚éœ€è¦ç›‘å¬ä»€ä¹ˆäº‹ä»¶ï¼Œåªéœ€è¦åˆå§‹åŒ– events å³å¯ï¼Œå½“ poll å‡½æ•°è¿”å›æ—¶ revents è¢«è®¾å®šä¸ºå®é™…å‘ç”Ÿçš„äº‹ä»¶ã€‚ ç¼ºç‚¹ï¼š ä»¥è®ºæ–‡çš„æ–¹å¼è¿›è¡Œæ£€æŸ¥æ˜¯å¦å°±ç»ªæ•ˆç‡ä½ã€‚ æ¯æ¬¡æ£€æŸ¥æ˜¯å¦å°±ç»ªè¦å°†æ‰€æœ‰éœ€è¦è¢«æ£€æŸ¥çš„ fd çš„æ•°æ®ç»“æ„å¤åˆ¶åˆ°å†…æ ¸ï¼Œå®Œæˆåä¿®æ”¹è¿™ä¸ªæ•°æ®ç»“æ„å¹¶è¿”å›ç»™ç¨‹åºï¼Œä»ç”¨æˆ·ç©ºé—´åˆ°å†…æ ¸ç©ºé—´çš„æ¥å›æ‹·è´å°†å ç”¨å¤§é‡ CPUã€‚ ä¼˜ç‚¹ï¼š ç›‘å¬æ²¡æœ‰æœ€å¤§æ•°é‡çš„é™åˆ¶ã€‚ select çš„å‡½æ•°è¿”å›å€¼æ˜¯ä¸‰ä¸ªé›†åˆä¸­å°±ç»ªæ€çš„ fd çš„æ•°é‡ä¹‹å’Œï¼Œå› æ­¤å¦‚æœåŒä¸€ä¸ª fd åœ¨ä¸æ­¢ä¸€ä¸ªé›†åˆä¸­åŒæ—¶è¢«æŒ‡å®šï¼Œä¸”å¯¹äºå¤šä¸ª I/O äº‹ä»¶éƒ½å¤„äºå°±ç»ªæ€çš„è¯å°±ä¼šè¢«ç»Ÿè®¡å¤šæ¬¡ï¼Œè€Œ poll çš„è¿”å›å€¼æ˜¯ä¸é‡å¤çš„ã€‚ select å’Œ poll éƒ½æ˜¯éœ€è¦é€šè¿‡éå†æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦æ¥è·å–å·²ç»å°±ç»ªçš„äº‹ä»¶ï¼Œä½†æ˜¯åŒæ—¶è¿æ¥çš„å¤§é‡å®¢æˆ·ç«¯åœ¨ä¸€æ—¶åˆ»å¯èƒ½åªæœ‰å¾ˆå°‘çš„å¤„äºå°±ç»ªçŠ¶æ€ï¼Œå› æ­¤éšç€ç›‘è§†çš„æè¿°ç¬¦æ•°é‡çš„å¢é•¿ï¼Œå…¶æ•ˆç‡ä¹Ÿä¼šçº¿æ€§ä¸‹é™ã€‚ epollepoll æ˜¯åœ¨2.6å†…æ ¸ä¸­æå‡ºçš„ï¼Œæ˜¯ä¹‹å‰çš„ select å’Œ poll çš„å¢å¼ºç‰ˆæœ¬ã€‚epollæ›´åŠ çµæ´»ï¼Œæ²¡æœ‰æè¿°ç¬¦é™åˆ¶ã€‚epoll ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ç®¡ç†å¤šä¸ªæè¿°ç¬¦ï¼Œå…¶ä»–çš„æ–‡ä»¶æè¿°ç¬¦æ³¨å†Œåˆ°è¿™ä¸ªæè¿°ç¬¦ä¸Šï¼Œå°†ç”¨æˆ·å…³ç³»çš„æ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶å­˜æ”¾åˆ°å†…æ ¸çš„ä¸€ä¸ªäº‹ä»¶è¡¨ä¸­ï¼Œè¿™æ ·åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ copy åªéœ€ä¸€æ¬¡ã€‚ epoll æœ‰ä¸‰ä¸ªå‡½æ•°ï¼š 1234567891011// åˆ›å»ºä¸€ä¸ª epoll çš„å¥æŸ„ï¼ˆå®ä¾‹ï¼‰ï¼Œsize ç”¨æ¥å‘Šè¯‰å†…æ ¸è¿™ä¸ªç›‘å¬çš„æ•°ç›®ä¸€å…±æœ‰å¤šå¤§int epoll_create(int size)ï¼›// ä¿®æ”¹ epfd æ‰€ä»£è¡¨çš„ epoll å®ä¾‹çš„å…´è¶£åˆ—è¡¨ï¼Œå³å¯ä»¥å‘ epoll å®ä¾‹æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ fdï¼Œå¹¶è®¾å®šæ„Ÿå…´è¶£çš„äº‹ä»¶int epoll_ctl(int epfd, int op, int fd, struct epoll_event *event)ï¼›// è¿”å› epoll å®ä¾‹ä¸­å¤„äºå°±ç»ªæ€çš„ fd ä¿¡æ¯int epoll_wait(int epfd, struct epoll_event * events, int maxevents, int timeout);struct epoll_event &#123; uint32_t events; /*æŒ‡å®šäº†å¾…æ£€æŸ¥çš„fdæ‰€æ„Ÿå…´è¶£çš„äº‹ä»¶é›†åˆï¼Œç”¨ä½æ©ç è¡¨ç¤º*/ epoll_data_t data; /*ç”¨æ¥åœ¨å°±ç»ªåç»™è°ƒç”¨è¿›ç¨‹ä¼ é€’ä¿¡æ¯*/&#125;; æ­¥éª¤epoll_createè°ƒç”¨è¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªå¥æŸ„ï¼ˆç§°ä¸º epoll å¥æŸ„ï¼Œepfdï¼‰ï¼ŒæŒ‡å®šçš„ size ç”¨æ¥å‘Šè¯‰å†…æ ¸è¿™ä¸ªç›‘å¬çš„æ•°ç›®çš„å¤§å°ã€‚size ä¸æ˜¯é™åˆ¶ epoll ç›‘å¬æè¿°ç¬¦çš„æœ€å¤§æ•°é‡ï¼Œè€Œæ˜¯å†…æ ¸å¯¹å†…å­˜ä½¿ç”¨å¤§å°çš„ä¸€ä¸ªå»ºè®®ã€‚ epoll å¥æŸ„æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå®ƒä¼šå ç”¨ä¸€ä¸ª fd å€¼ã€‚åœ¨ Linux ä¸­é€šè¿‡ /proc/pid/fd/ å¯çœ‹åˆ°è¯¥å€¼ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ epoll çš„ç¨‹åºä¸­ï¼Œä½¿ç”¨å®Œä¹‹ååº”ç”¨ close æ–¹æ³•å…³é—­ epollï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ fd è¢«æ¶ˆè€—æ®†å°½ã€‚ epoll_ctlé¦–å…ˆå°†ä¸€ä¸‹å‡½æ•°ä¸­å„ä¸ªå‚æ•°çš„æ„ä¹‰ï¼š å‚æ•° å«ä¹‰ epfd è°ƒç”¨ epoll_create å‡½æ•°äº§ç”Ÿçš„ epoll å¥æŸ„ op ç”¨ä¸‰ä¸ªå®æ¥è¡¨ç¤ºï¼šæ·»åŠ EPOLL_CTL_ADDï¼Œåˆ é™¤EPOLL_CTL_DELï¼Œä¿®æ”¹EPOLL_CTL_MODã€‚åˆ†åˆ«æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹å¯¹ fd çš„ç›‘å¬äº‹ä»¶ã€‚ fd ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦ fd epoll_event ç›‘å¬ fd çš„äº‹ä»¶ å‡½æ•°å¯¹æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ fd æ‰§è¡ŒæŒ‡å®šçš„ op æ“ä½œã€‚ event é›†åˆå¦‚ä½•ï¼š 123456EPOLLIN ï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¯»ï¼ˆåŒ…æ‹¬å¯¹ç«¯SOCKETæ­£å¸¸å…³é—­ï¼‰ï¼›EPOLLOUTï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥å†™ï¼›EPOLLPRIï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦æœ‰ç´§æ€¥çš„æ•°æ®å¯è¯»ï¼ˆè¿™é‡Œåº”è¯¥è¡¨ç¤ºæœ‰å¸¦å¤–æ•°æ®åˆ°æ¥ï¼‰ï¼›EPOLLERRï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿé”™è¯¯ï¼›EPOLLHUPï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦è¢«æŒ‚æ–­ï¼›EPOLLETï¼š å°†EPOLLè®¾ä¸ºè¾¹ç¼˜è§¦å‘(Edge Triggered)æ¨¡å¼ï¼Œè¿™æ˜¯ç›¸å¯¹äºæ°´å¹³è§¦å‘(Level Triggered)æ¥è¯´çš„ã€‚EPOLLONESHOTï¼šåªç›‘å¬ä¸€æ¬¡äº‹ä»¶ï¼Œå½“ç›‘å¬å®Œè¿™æ¬¡äº‹ä»¶ä¹‹åï¼Œå¦‚æœè¿˜éœ€è¦ç»§ç»­ç›‘å¬è¿™ä¸ªsocketçš„è¯ï¼Œéœ€è¦å†æ¬¡æŠŠè¿™ä¸ªsocketåŠ å…¥åˆ°EPOLLé˜Ÿåˆ—é‡Œ epoll_waitå‚æ•°åŠæ„ä¹‰å¦‚ä¸‹ï¼š å‚æ•° å«ä¹‰ epfd è°ƒç”¨ epoll_create å‡½æ•°äº§ç”Ÿçš„ epoll å¥æŸ„ events ä»å†…æ ¸å¾—åˆ°çš„äº‹ä»¶é›†åˆ maxevents å‘Šè¯‰å†…æ ¸è¿™ä¸ª events æœ‰å¤šå¤§ï¼Œè¯¥å€¼ä¸èƒ½å¤§äºåˆ›å»º epoll_create() æ—¶çš„ size timeout è¶…æ—¶æ—¶é—´ è¯¥å‡½æ•°ç­‰å¾… epfd ä¸Šçš„ IO äº‹ä»¶ã€‚ å·¥ä½œæ¨¡å¼epoll å¯¹æ–‡ä»¶æè¿°ç¬¦çš„æ“ä½œæœ‰ä¸¤ç§æ¨¡å¼ï¼šLTï¼ˆlevel triggerï¼‰å’Œ ETï¼ˆedge triggerï¼‰ã€‚ å‚è€ƒèµ„æ–™[Linux IOæ¨¡å¼åŠ selectã€pollã€epollè¯¦è§£]"},{"title":"Linux å‘½ä»¤","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-27T12:33:48.000Z","comments":true,"path":"back_posts/old_posts/Linux/Linux-å‘½ä»¤.html","permalink":"https://orechou.github.io/back_posts/old_posts/Linux/Linux-%E5%91%BD%E4%BB%A4.html","excerpt":"Linux å‘½ä»¤æ—¶åˆ»éƒ½ä¼šç”¨åˆ°ï¼Œé™¤äº† lsã€cdã€chmod ç­‰ï¼Œå¸¸ç”¨çš„å¯ä»¥åˆ†æˆä¸¤ç±»ï¼Œç³»ç»Ÿæ€§èƒ½ç›‘æ§ç›¸å…³çš„å‘½ä»¤å’Œæ–‡æœ¬å¤„ç†ç›¸å…³çš„å‘½ä»¤ã€‚","text":"Linux å‘½ä»¤æ—¶åˆ»éƒ½ä¼šç”¨åˆ°ï¼Œé™¤äº† lsã€cdã€chmod ç­‰ï¼Œå¸¸ç”¨çš„å¯ä»¥åˆ†æˆä¸¤ç±»ï¼Œç³»ç»Ÿæ€§èƒ½ç›‘æ§ç›¸å…³çš„å‘½ä»¤å’Œæ–‡æœ¬å¤„ç†ç›¸å…³çš„å‘½ä»¤ã€‚ å¸¸ç”¨ç³»ç»Ÿç›¸å…³çš„å‘½ä»¤ï¼š å‘½ä»¤ è¯´æ˜ top èƒ½å¤Ÿå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µï¼Œç±»ä¼¼äºWindowsçš„ä»»åŠ¡ç®¡ç†å™¨ ps ç”¨äºæ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„çŠ¶æ€ã€‚ iostat å¯¹ç³»ç»Ÿçš„ç£ç›˜æ“ä½œæ´»åŠ¨è¿›è¡Œç›‘è§†ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯æ±‡æŠ¥ç£ç›˜æ´»åŠ¨ç»Ÿè®¡æƒ…å†µï¼ŒåŒæ—¶ä¹Ÿä¼šæ±‡æŠ¥å‡ºCPUä½¿ç”¨æƒ…å†µã€‚ free æ˜¾ç¤ºç³»ç»Ÿä½¿ç”¨å’Œç©ºé—²çš„å†…å­˜æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜ã€äº¤äº’åŒºå†…å­˜(swap)å’Œå†…æ ¸ç¼“å†²åŒºå†…å­˜ã€‚å…±äº«å†…å­˜å°†è¢«å¿½ç•¥ã€‚ vmstat å¯å¯¹æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€CPU æ´»åŠ¨è¿›è¡Œç›‘æ§ã€‚å®ƒæ˜¯å¯¹ç³»ç»Ÿçš„æ•´ä½“æƒ…å†µè¿›è¡Œç»Ÿè®¡ï¼Œä¸è¶³ä¹‹å¤„æ˜¯æ— æ³•å¯¹æŸä¸ªè¿›ç¨‹è¿›è¡Œæ·±å…¥åˆ†æã€‚ lsof ï¼ˆlist open filesï¼‰åˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·ã€‚åœ¨linuxç¯å¢ƒä¸‹ï¼Œä»»ä½•äº‹ç‰©éƒ½ä»¥æ–‡ä»¶çš„å½¢å¼å­˜åœ¨ï¼Œé€šè¿‡æ–‡ä»¶ä¸ä»…ä»…å¯ä»¥è®¿é—®å¸¸è§„æ•°æ®ï¼Œè¿˜å¯ä»¥è®¿é—®ç½‘ç»œè¿æ¥å’Œç¡¬ä»¶ã€‚ç”¨äºæŸ¥çœ‹ä½ è¿›ç¨‹å¼€æ‰“çš„æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶çš„è¿›ç¨‹ï¼Œè¿›ç¨‹æ‰“å¼€çš„ç«¯å£( TCPã€UDP )ã€‚ netstat æ˜¾ç¤ºä¸ IPã€TCPã€UDP å’Œ ICMP åè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µã€‚ å¸¸ç”¨æ–‡ä»¶ã€æ–‡æœ¬å¤„ç†ç›¸å…³çš„å‘½ä»¤ï¼š å‘½ä»¤ è¯´æ˜ catã€moreã€lessã€headã€tail ä¸ç”¨å¤šè¯´ï¼ŒæŸ¥çœ‹æ–‡ä»¶ã€‚ find åœ¨ç›®å½•ç»“æ„ä¸­æœç´¢æ–‡ä»¶ï¼Œå¹¶æ‰§è¡ŒæŒ‡å®šçš„æ“ä½œã€‚ grep ä¸»è¦ç”¨äºæ–‡æœ¬å†…å®¹çš„æŸ¥æ‰¾ï¼Œå®ƒæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ã€‚ cut å¯ä»¥æŒ‰åˆ—æ¥åˆ‡åˆ†æ–‡ä»¶ï¼Œå¯ç”¨äºå¤„ç†ä½¿ç”¨å›ºå®šå®½åº¦å­—æ®µçš„æ–‡ä»¶ã€‚ sed ï¼ˆstream editorï¼‰æµç¼–è¾‘å™¨ï¼Œå¸¸ç”¨çš„ç”¨æ³•æ˜¯è¿›è¡Œæ–‡æœ¬æ›¿æ¢ã€‚ awk å¯è¿›è¡Œé«˜çº§æ–‡æœ¬å¤„ç†ã€‚é€šå¸¸ç”± 3 ä¸ªéƒ¨åˆ†ç»„æˆï¼šBEGINã€END å’Œå¸¦æ¨¡å¼åŒ¹é…é€‰é¡¹çš„å…¬å…±è¯­å¥å—ï¼Œä½†æ˜¯ä¸‰ä¸ªéƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ã€‚awk ä»¥é€è¡Œçš„å½¢å¼å¤„ç†æ–‡ä»¶ã€‚ï¼ˆ1ï¼‰é¦–å…ˆæ‰§è¡Œ BEGIN è¯­å¥å—ä¸­çš„è¯­å¥ï¼›ï¼ˆ2ï¼‰æ¥ç€ä»æ–‡ä»¶æˆ– stdin ä¸­è¯»å–ä¸€è¡Œï¼Œå¦‚æœèƒ½æ”¹åŒ¹é… patternï¼Œåˆ™æ‰§è¡Œéšåçš„è¯­å¥å—ä¸­çš„è¯­å¥ã€‚é‡å¤è¯¥è¿‡ç¨‹ç›´åˆ°æ•°æ®è¯»å–ç»“æŸã€‚ï¼ˆ3ï¼‰å½“è¯»åˆ°è¾“å…¥æ•°æ®æµçš„ç»“æŸä¹‹åï¼Œæ‰§è¡Œ END è¯­å¥å—ã€‚ which æŸ¥æ‰¾æŸä¸ªå‘½ä»¤çš„ä½ç½®ã€‚ whereis è·Ÿ which ç±»ä¼¼ï¼Œè¿˜èƒ½æ”¹æ‰“å°å‡ºå…¶å¯¹åº”çš„å‘½ä»¤æ‰‹å†Œä»¥åŠæºä»£ç çš„è·¯å¾„ã€‚ ä¸€äº›å‚æ•°ï¼š -fï¼šæŒ‡å®šå­—ç¬¦"},{"title":"Socket å…¥é—¨","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-27T13:08:52.000Z","comments":true,"path":"back_posts/old_posts/Linux/Socket-å…¥é—¨.html","permalink":"https://orechou.github.io/back_posts/old_posts/Linux/Socket-%E5%85%A5%E9%97%A8.html","excerpt":"Socket è‹±æ–‡æœ‰æ’åº§çš„æ„æ€ï¼Œå¯ä»¥æƒ³è±¡ç«¯å£å°±æ˜¯æ’åº§ä¸Šçš„å£ï¼Œç«¯å£ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚æƒ³è±¡ Socket ç±»ä¼¼äºæ“ä½œæŸä¸ª IP åœ°å€ä¸Šçš„æŸä¸ªç«¯å£ä»¥è¾¾åˆ°ç‚¹å¯¹ç‚¹é€šä¿¡çš„ç›®çš„ï¼Œéœ€è¦ç»‘å®šåˆ°æŸä¸ªå…·ä½“çš„è¿›ç¨‹å’Œç«¯å£ã€‚ Socket åŸæœ¬ä»£è¡¨çš„æ˜¯ Unix ä¸Šçš„åŸå§‹å¥—æ¥å­—ï¼ˆRawSocketï¼‰ç”¨äºæè¿°æ–‡ä»¶çš„å†…å­˜é•œåƒï¼Œä½†å› ä¸º Unix çš„è®¾è®¡å“²å­¦æ˜¯â€œä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶â€ï¼Œæ‰€ä»¥åæ¥çš„ç½‘ç»œç‰ˆçš„è¿›ç¨‹é—´é€šä¿¡ä¹Ÿå°±è¢«å† åä¸ºæ–‡ä»¶æè¿°ç¬¦ã€‚æœ¬è´¨ä¸Šè®² Socket æ˜¯ Unix ç³»ç»Ÿè®¾è®¡çš„ä¸€ç§æ€æƒ³ã€‚ Socket æ²¡æœ‰å±‚çš„æ¦‚å¿µï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯å¯¹ TCP/IP åè®®ç°‡çš„ä¸€ä¸ªé—¨é¢æ¨¡å¼çš„å°è£…ã€‚å¯ä»¥è®©ç¼–ç¨‹å˜å¾—æ›´åŠ ç®€å•ã€‚","text":"Socket è‹±æ–‡æœ‰æ’åº§çš„æ„æ€ï¼Œå¯ä»¥æƒ³è±¡ç«¯å£å°±æ˜¯æ’åº§ä¸Šçš„å£ï¼Œç«¯å£ä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚æƒ³è±¡ Socket ç±»ä¼¼äºæ“ä½œæŸä¸ª IP åœ°å€ä¸Šçš„æŸä¸ªç«¯å£ä»¥è¾¾åˆ°ç‚¹å¯¹ç‚¹é€šä¿¡çš„ç›®çš„ï¼Œéœ€è¦ç»‘å®šåˆ°æŸä¸ªå…·ä½“çš„è¿›ç¨‹å’Œç«¯å£ã€‚ Socket åŸæœ¬ä»£è¡¨çš„æ˜¯ Unix ä¸Šçš„åŸå§‹å¥—æ¥å­—ï¼ˆRawSocketï¼‰ç”¨äºæè¿°æ–‡ä»¶çš„å†…å­˜é•œåƒï¼Œä½†å› ä¸º Unix çš„è®¾è®¡å“²å­¦æ˜¯â€œä¸€åˆ‡éƒ½æ˜¯æ–‡ä»¶â€ï¼Œæ‰€ä»¥åæ¥çš„ç½‘ç»œç‰ˆçš„è¿›ç¨‹é—´é€šä¿¡ä¹Ÿå°±è¢«å† åä¸ºæ–‡ä»¶æè¿°ç¬¦ã€‚æœ¬è´¨ä¸Šè®² Socket æ˜¯ Unix ç³»ç»Ÿè®¾è®¡çš„ä¸€ç§æ€æƒ³ã€‚ Socket æ²¡æœ‰å±‚çš„æ¦‚å¿µï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæ˜¯å¯¹ TCP/IP åè®®ç°‡çš„ä¸€ä¸ªé—¨é¢æ¨¡å¼çš„å°è£…ã€‚å¯ä»¥è®©ç¼–ç¨‹å˜å¾—æ›´åŠ ç®€å•ã€‚ åŸºç¡€æ–‡ä»¶æè¿°ç¬¦æ–‡ä»¶æè¿°ç¬¦åœ¨å½¢å¼ä¸Šæ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚å®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªç´¢å¼•å€¼ï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿è¡Œçš„è¿›ç¨‹ç»´æŠ¤ä¸€å¼ å•ç‹¬çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ã€‚å½“ç¨‹åºæ‰“å¼€ä¸€ä¸ªç°æœ‰æ–‡ä»¶æˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶æ—¶ï¼Œç³»ç»ŸæŠŠä¸€ä¸ªæŒ‡å‘æ­¤è¯¥æ–‡ä»¶å†…éƒ¨æ•°æ®ç»“æ„çš„æŒ‡é’ˆå†™å…¥æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Œå¹¶æŠŠè¯¥è¡¨çš„ç´¢å¼•å€¼è¿”å›ç»™è°ƒç”¨è€… ã€‚åº”ç”¨ç¨‹åºåªéœ€è®°ä½è¿™ä¸ªæè¿°ç¬¦ï¼Œå¹¶åœ¨ä»¥åæ“ä½œè¯¥æ–‡ä»¶æ—¶ä½¿ç”¨å®ƒã€‚æ“ä½œç³»ç»ŸæŠŠè¯¥æè¿°ç¬¦ä½œä¸ºç´¢å¼•ï¼Œç”¨æ¥è®¿é—®è¿›ç¨‹æè¿°ç¬¦è¡¨ï¼Œé€šè¿‡æŒ‡é’ˆæ‰¾åˆ°ä¿å­˜è¯¥æ–‡ä»¶æ‰€æœ‰çš„ä¿¡æ¯çš„æ•°æ®ç»“æ„ã€‚ ç³»ç»Ÿåˆ›å»ºä¸€ä¸ª socket è¿æ¥ï¼Œä¹Ÿæ˜¯ä¼šæ‰“å¼€ä¸€ä¸ª Socket æ–‡ä»¶æè¿°ç¬¦ã€‚ å‡½æ•°Socket é€šä¿¡åŒæ–¹çš„å‡½æ•°å¦‚ä¸‹ï¼š socket1int socket(int domain, int type, int protocol); socket() å‡½æ•°å¯¹åº”äºæ™®é€šæ–‡ä»¶çš„æ‰“å¼€æ“ä½œã€‚æ™®é€šæ–‡ä»¶çš„æ‰“å¼€æ“ä½œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°å­—ï¼Œè€Œ socket() ç”¨äºåˆ›å»ºä¸€ä¸ª socket æè¿°ç¬¦ï¼ˆsocket descriptorï¼‰ï¼Œå®ƒå”¯ä¸€æ ‡è¯†ä¸€ä¸ªsocketã€‚ æ‰“å¼€ä¸€ä¸ªç½‘ç»œé€šè®¯ç«¯å£ï¼Œå¦‚æœæˆåŠŸçš„è¯ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥åƒè¯»å†™æ–‡ä»¶ä¸€æ ·ç”¨ read/write åœ¨ç½‘ç»œä¸Šæ”¶å‘æ•°æ®ï¼Œå¦‚æœ socket() è°ƒç”¨å‡ºé”™åˆ™è¿”å›-1ã€‚ bind1int bind(int sockfd, const struct sockaddr *myaddr, socklen_t addrlen); æœåŠ¡å™¨éœ€è¦è°ƒç”¨ bind ç»‘å®šä¸€ä¸ªå›ºå®šçš„ç½‘ç»œåœ°å€å’Œç«¯å£å·ã€‚æœåŠ¡å™¨ç¨‹åºæ‰€ç›‘å¬çš„ç½‘ç»œåœ°å€å’Œç«¯å£å·é€šå¸¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå®¢æˆ·ç«¯ç¨‹åºå¾—çŸ¥æœåŠ¡å™¨ç¨‹åºçš„åœ°å€å’Œç«¯å£å·åå°±å¯ä»¥å‘æœåŠ¡å™¨å‘èµ·è¿æ¥ã€‚ bind() çš„ä½œç”¨æ˜¯å°†å‚æ•° sockfd å’Œ myaddr ç»‘å®šåœ¨ä¸€èµ·ï¼Œä½¿ sockfd è¿™ä¸ªç”¨äºç½‘ç»œé€šè®¯çš„æ–‡ä»¶æè¿°ç¬¦ç›‘å¬ myaddr æ‰€æè¿°çš„åœ°å€å’Œç«¯å£å·ã€‚ listen1int listen(int sockfd, int backlog);// backlogå–å€¼0~5. listen() å£°æ˜ sockfd å¤„äºç›‘å¬çŠ¶æ€ï¼Œå¹¶ä¸”æœ€å¤šå…è®¸æœ‰ backlog ä¸ªå®¢æˆ·ç«¯å¤„äºè¿æ¥å¾…çŠ¶æ€ï¼Œå¦‚æœæ¥æ”¶åˆ°æ›´å¤šçš„è¿æ¥è¯·æ±‚å°±å¿½ç•¥ã€‚ listen() æˆåŠŸè¿”å› 0ï¼Œå¤±è´¥è¿”å› -1ã€‚ accept1int accept(int sockfd, struct sockaddr *cliaddr, socklen_t *addrlen); ä¸‰æ–¹æ¡æ‰‹å®Œæˆåï¼ŒæœåŠ¡å™¨è°ƒç”¨ accept() æ¥å—è¿æ¥ï¼Œå¦‚æœæœåŠ¡å™¨è°ƒç”¨ accept() æ—¶è¿˜æ²¡æœ‰å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œå°±é˜»å¡ç­‰å¾…ç›´åˆ°æœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥ã€‚"},{"title":"Java NIO","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-16T14:52:38.000Z","comments":true,"path":"back_posts/old_posts/Java/Java NIO.html","permalink":"https://orechou.github.io/back_posts/old_posts/Java/Java%20NIO.html","excerpt":"Java IO ç›¸å…³çš„æ–‡ç« ï¼Œåœ¨ç½‘ç»œä¸Šå¯ä»¥æœç´¢åˆ°ä¸€å¤§å †ï¼Œå¹¶ä¸” ã€ŠJava NIOã€‹å’Œã€ŠNetty æƒå¨æŒ‡å—ã€‹ä¸¤æœ¬ä¹¦å¯ä»¥åŒ…è¯»è€…ä»å…¥é—¨åˆ°è¿›é˜¶ã€‚å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„åœ¨äºè®©è‡ªå·±æ€»ç»“ä¸€ä¸‹ Java IO çŸ¥è¯†ï¼Œä»æ€»ç»“ä¸­å­¦ä¹ ã€‚ Java çš„ IO å¤§è‡´å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š ç£ç›˜æ“ä½œï¼šFile å­—èŠ‚æ“ä½œï¼šInputStream &amp; OutputStream å­—ç¬¦æ“ä½œï¼šReader &amp; Writer ç½‘ç»œæ“ä½œï¼šSocket æœ€å¼€å§‹ Java åªæä¾›äº† BIOï¼ˆBlock IOï¼‰ï¼ŒBlock IO çš„æ„æ€æ˜¯çº¿ç¨‹è°ƒç”¨ IO æ“ä½œçš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šé˜»å¡ç­‰å¾… IO å®Œæˆã€‚åœ¨è¿™ä¸ªæœŸé—´ï¼Œçº¿ç¨‹é™¤äº†ç­‰å¾…æ— æ³•å®Œæˆå…¶ä»–çš„äº‹æƒ…ã€‚å› ä¸ºè¿™ç§ IO æ¨¡å¼ï¼Œä¹‹å‰çš„ Java æ¡†æ¶åœ¨ç¼–å†™æœåŠ¡å™¨çš„æ—¶å€™ï¼Œä¼šå¯¹æ¯ä¸€ä¸ª Socket çš„è¯·æ±‚æ–°å»ºä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚å› ä¸ºçº¿ç¨‹çš„æ–°å»ºä¸é”€æ¯æ˜¯éœ€è¦æ¶ˆè€—ç³»ç»Ÿèµ„æºçš„ï¼Œæ‰€ä»¥è‹¥ç³»ç»Ÿé¢‘ç¹åœ°åˆ›å»ºä¸é”€æ¯çº¿ç¨‹ï¼Œé‚£ä¹ˆä¼šå¯¹ç³»ç»Ÿèµ„æºé€ æˆå¾ˆå¤§çš„æµªè´¹ã€‚åœ¨è¿™ç§ IO æ¨¡å¼ä¸‹çš„æ”¹è¿›æ–¹å¼æ˜¯åˆ©ç”¨æ± åŒ–æŠ€æœ¯ï¼Œé€šè¿‡çº¿ç¨‹æ± çš„æ–¹å¼æ¥ç®¡ç†çº¿ç¨‹ï¼Œå‡å°‘çº¿ç¨‹é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰æ”¹å˜æœ€æ ¹æœ¬çš„é—®é¢˜ï¼Œå³ä¸€ä¸ªæœåŠ¡è¯·æ±‚çš„è¿æ¥éƒ½éœ€è¦ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œé˜»å¡ IO çš„å®ç°è‚¯å®šæ— æ³•æ»¡è¶³æ€§èƒ½çš„éœ€æ±‚ã€‚ é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œåœ¨ JDK 1.4 ä¸­ NIO å°±ç™»åœºäº†ã€‚","text":"Java IO ç›¸å…³çš„æ–‡ç« ï¼Œåœ¨ç½‘ç»œä¸Šå¯ä»¥æœç´¢åˆ°ä¸€å¤§å †ï¼Œå¹¶ä¸” ã€ŠJava NIOã€‹å’Œã€ŠNetty æƒå¨æŒ‡å—ã€‹ä¸¤æœ¬ä¹¦å¯ä»¥åŒ…è¯»è€…ä»å…¥é—¨åˆ°è¿›é˜¶ã€‚å†™è¿™ç¯‡æ–‡ç« çš„ç›®çš„åœ¨äºè®©è‡ªå·±æ€»ç»“ä¸€ä¸‹ Java IO çŸ¥è¯†ï¼Œä»æ€»ç»“ä¸­å­¦ä¹ ã€‚ Java çš„ IO å¤§è‡´å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š ç£ç›˜æ“ä½œï¼šFile å­—èŠ‚æ“ä½œï¼šInputStream &amp; OutputStream å­—ç¬¦æ“ä½œï¼šReader &amp; Writer ç½‘ç»œæ“ä½œï¼šSocket æœ€å¼€å§‹ Java åªæä¾›äº† BIOï¼ˆBlock IOï¼‰ï¼ŒBlock IO çš„æ„æ€æ˜¯çº¿ç¨‹è°ƒç”¨ IO æ“ä½œçš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šé˜»å¡ç­‰å¾… IO å®Œæˆã€‚åœ¨è¿™ä¸ªæœŸé—´ï¼Œçº¿ç¨‹é™¤äº†ç­‰å¾…æ— æ³•å®Œæˆå…¶ä»–çš„äº‹æƒ…ã€‚å› ä¸ºè¿™ç§ IO æ¨¡å¼ï¼Œä¹‹å‰çš„ Java æ¡†æ¶åœ¨ç¼–å†™æœåŠ¡å™¨çš„æ—¶å€™ï¼Œä¼šå¯¹æ¯ä¸€ä¸ª Socket çš„è¯·æ±‚æ–°å»ºä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚å› ä¸ºçº¿ç¨‹çš„æ–°å»ºä¸é”€æ¯æ˜¯éœ€è¦æ¶ˆè€—ç³»ç»Ÿèµ„æºçš„ï¼Œæ‰€ä»¥è‹¥ç³»ç»Ÿé¢‘ç¹åœ°åˆ›å»ºä¸é”€æ¯çº¿ç¨‹ï¼Œé‚£ä¹ˆä¼šå¯¹ç³»ç»Ÿèµ„æºé€ æˆå¾ˆå¤§çš„æµªè´¹ã€‚åœ¨è¿™ç§ IO æ¨¡å¼ä¸‹çš„æ”¹è¿›æ–¹å¼æ˜¯åˆ©ç”¨æ± åŒ–æŠ€æœ¯ï¼Œé€šè¿‡çº¿ç¨‹æ± çš„æ–¹å¼æ¥ç®¡ç†çº¿ç¨‹ï¼Œå‡å°‘çº¿ç¨‹é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰æ”¹å˜æœ€æ ¹æœ¬çš„é—®é¢˜ï¼Œå³ä¸€ä¸ªæœåŠ¡è¯·æ±‚çš„è¿æ¥éƒ½éœ€è¦ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œé˜»å¡ IO çš„å®ç°è‚¯å®šæ— æ³•æ»¡è¶³æ€§èƒ½çš„éœ€æ±‚ã€‚ é’ˆå¯¹è¿™ä¸€é—®é¢˜ï¼Œåœ¨ JDK 1.4 ä¸­ NIO å°±ç™»åœºäº†ã€‚ å¾ˆå¤šäººå°† NIO ç§°ä¸º New IO æˆ–è€… Not Block IOï¼Œåè€…åº”è¯¥æ›´è´´åˆ‡ä¸€ç‚¹ã€‚ é¦–å…ˆæ˜¯ NIO é‡Œé¢æœ‰å“ªäº›ä¸œè¥¿ã€‚ åŸºæœ¬ç»„ä»¶Bufferï¼ˆç¼“å†²åŒºï¼‰NIO å¤„ç†çš„æ•°æ®å­˜å‚¨åœ¨ Buffer é‡Œï¼Œä¸€ä¸ª Buffer å¯¹è±¡æ˜¯ä¸€ä¸ªå›ºå®šæ•°é‡çš„æ•°æ®å®¹å™¨ï¼Œä¹Ÿå¯ä»¥è§†ä½œæ•°æ®ä¼ è¾“çš„æ¥æºæˆ–è€…ç›®æ ‡ã€‚ åŸºæœ¬å±æ€§ç¼“å†²åŒºçš„å‡ ä¸ªå±æ€§å¦‚ä¸‹ï¼š Capacityï¼ˆå®¹é‡ï¼‰ï¼šåœ¨åˆ›å»ºæ—¶è®¾å®šï¼Œæ— æ³•åœ¨åç»­ä¿®æ”¹ã€‚è¡¨ç¤ºèƒ½å¤Ÿå®¹çº³çš„æ•°æ®å…ƒç´ çš„æœ€å¤§æ•°é‡ã€‚ Limitï¼ˆä¸Šç•Œï¼‰ï¼šç¼“å†²åŒºä¸­ç°å­˜å…ƒç´ çš„è®¡æ•°ï¼Œä¹Ÿè¡¨ç¤ºäº†ç¬¬ä¸€ä¸ªä¸èƒ½è¯»å†™çš„å…ƒç´ çš„ä½ç½®ã€‚ Positionï¼ˆä½ç½®ï¼‰ï¼šä¸‹ä¸€ä¸ªè¦è¯»æˆ–è€…è¦å†™çš„ä½ç½®ã€‚ Markï¼ˆæ ‡è®°ï¼‰ï¼šä¸€ä¸ªå¤‡å¿˜çš„ä½ç½®ã€‚ è¿‡ç¨‹æ–°å»º Bufferå‡è®¾åˆ›å»ºä¸€ä¸ªå®¹é‡ä¸º 10 çš„ç¼“å†²åŒºã€‚ 12345ByteBuffer buffer = ByteBuffer.allocateDirect(10);// capacity: 10// limit: 10// position: 0// mark: x å¡«å…… Bufferå‘ç¼“å†²åŒºå¡«å…… 5 æ¬¡æ•°æ®ã€‚ 12345buffer.put((byte)&#x27;H&#x27;).put((byte)&#x27;e&#x27;).put((byte)&#x27;l&#x27;).put((byte)&#x27;l&#x27;).put((byte)&#x27;o&#x27;);// capacity: 10// limit: 10// position: 5 (å³å¯è§†ä¸ºå½“å‰ put åˆ°æ•°æ®ä¸­çš„æ•°é‡ï¼Œä¹Ÿå¯è§†ä¸ºä¸‹ä¸ªå…ƒç´  put çš„ä½ç½®)// mark: x ç¿»è½¬ Bufferå½“æˆ‘ä»¬è¦å»è¯»å– Buffer çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç¿»è½¬ï¼ˆflipï¼‰ Bufferã€‚ 123buffer.flip();// ä»£ç ç­‰ä»·äºå¦‚ä¸‹ï¼Œå³æŠŠ limit ä½ç½®è®¾ç½®æˆ positionçš„ä½ç½®ï¼Œå†å°† position è®¾ç½®ä¸º 0buffer.limit(buffer.position()).position(0); å‹ç¼© Bufferå½“è¯»å–ç¼“å†²åŒºä¸­ä¸¤ä¸ªå…ƒç´ ä¹‹åï¼Œç¼“å†²åŒºå¦‚ä¸‹ã€‚ æ­¤åˆ»ä»ç¼“å†²åŒºä¸­é‡Šæ”¾ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ï¼Œç„¶åé‡æ–°å¡«å……ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæœªè¯»çš„æ•°æ®å…ƒç´ éœ€è¦ä¸‹ç§»ä»¥ä½¿ç¬¬ä¸€ä¸ªå…ƒç´ ç´¢å¼•ä¸º 0ã€‚ä»è€Œå°† Buffer è¿›è¡Œå‹ç¼©ï¼ˆcompactï¼‰ã€‚ 1buffer.compact(); æ ¹æ®å›¾ç¤ºï¼Œæ•°æ®å…ƒç´  2-5 è¢«å¤åˆ¶åˆ° 0-3 ä½ç½®ï¼Œ4 ä»¥åçš„ä½ç½®è¶…å‡ºäº† positionï¼Œæ‰€ä»¥åœ¨åé¢ buffer å†™å…¥æ•°æ®çš„æ—¶å€™è¢«è¦†ç›–æ‰ã€‚ æ ‡è®° Bufferä½¿ç”¨æ ‡è®°å‡½æ•°å°† mark è®¾ç½®ä¸ºå½“å‰ position çš„å€¼ã€‚å½“æˆ‘ä»¬éœ€è¦é‡å¤è¯»å– Buffer ä¸­æŸæ®µæ•°æ®çš„æ—¶å€™ä¼šå¯ä»¥æ´¾ä¸Šç”¨åœºã€‚ 1buffer.position(2).mark().position(4); é€šé“ï¼ˆChannelï¼‰é€šé“ä½äºç¼“å†²åŒºä¸é€šä¿¡çš„å¦ä¸€æ–¹ï¼ˆæ–‡ä»¶æˆ– socketï¼‰ä¹‹é—´ï¼Œæä¾›å…¨åŒå·¥çš„æ•°æ®ä¼ è¾“ã€‚JDK 1.4 æä¾›çš„é€šé“ç§ç±»å¦‚ä¸‹ï¼š FileChannel SocketChannel ServerSocketChannel DatagramChannel æ‰“å¼€ FileChannel å¿…é¡»é€šè¿‡åœ¨ RandomAccessFileã€FileInputStream å’Œ FileOutputStream å¯¹è±¡ä¸Šè°ƒç”¨ getChannelã€‚è€Œå¦å¤–ä¸‰ä¸ªå…³äº socket çš„é€šé“åˆ™å¯ä»¥é€šè¿‡ç›¸åº”çš„é™æ€å·¥å‚æ–¹æ³•æ‰“å¼€ã€‚åŸå› åœ¨äºï¼Œåˆ›å»ºæ–‡ä»¶é€šé“çš„æ—¶å€™ï¼Œä¸€å®šè¦æœ‰æ˜ç¡®çš„æ–‡ä»¶ç›®æ ‡ï¼Œå³å…ˆæœ‰äº†ç›®æ ‡æ–‡ä»¶æ‰å»ä¸ä¹‹å»ºç«‹æ•°æ®çš„é€šé“ã€‚ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶é€šé“å¯¹åº”äº†ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è€Œå¼€å¯ Socket é€šé“çš„æ—¶å€™è¿˜ä¸çŸ¥é“è°æ¥å»ºç«‹è¿æ¥ï¼Œä¸è°å»ºç«‹è¿æ¥ã€‚ Socket é€šé“å¯ä»¥é€‰æ‹©ä¸¤ç§æ¨¡å¼ï¼Œé˜»å¡æ¨¡å¼å’Œéé˜»å¡æ¨¡å¼ã€‚ 12SocketChannel sc = SocketChannel.open( );sc.configureBlocking (false); // nonblocking NIO Socket æä¾›çš„éé˜»å¡æ¨¡å¼ï¼Œæ˜¯ç¼–å†™é«˜æ€§èƒ½ IO åº”ç”¨çš„å…³é”®ã€‚å¯¹äº Java ç¼–å†™çš„æœåŠ¡å™¨æ¥è¯´ï¼Œèƒ½å¤Ÿå®ç°å•çº¿ç¨‹å¯¹å¤šä¸ª Socket è¿æ¥çš„ç®¡ç†ï¼Œå¹¶ä¸”æ–¹å¼ç®€å•ã€‚ é€‰æ‹©å™¨ï¼ˆSelectorï¼‰é€šè¿‡å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ Selectorä¸Šï¼Œå¹¶ç»‘å®šç›¸å…³çš„äº‹ä»¶ï¼Œåœ¨åé¢å°±å¯ä»¥é€šè¿‡é€‰æ‹©å™¨æ‰¾åˆ°è¿™äº›é€šé“å°±ç»ªçš„ç›¸å…³äº‹ä»¶ã€‚SelectionKey å°è£…äº†ä¸€ä¸ªé€šé“å’Œé€‰æ‹©å™¨çš„æ³¨å†Œå…³ç³»ã€‚ 123456789101112131415161718192021// step 1Selector selector = Selector.open();// step 2ServerSocketChannel ssChannel = ServerSocketChannel.open();ssChannel.configureBlocking(false); // é€šé“å¿…é¡»è®¾ç½®ä¸ºéé˜»å¡çš„æ¨¡å¼ssChannel.register(selector, SelectionKey.OP_ACCEPT); // è¿™é‡Œæ³¨å†Œäº†æ¥å—äº‹ä»¶...// step 3// å½“æœ‰å°±ç»ªçš„é€šé“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ selectedKeys() æ–¹æ³•è·å–åˆ°è¿™äº› keyï¼Œå¹¶è¿›è¡Œå¤„ç†int num = selector.select();Set&lt;SelectionKey&gt; keys = selector.selectedKeys();Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator();while (keyIterator.hasNext()) &#123; SelectionKey key = keyIterator.next(); if (key.isAcceptable()) &#123; // ... &#125; else if (key.isReadable()) &#123; // ... &#125; keyIterator.remove();&#125; äº‹ä»¶çš„ç§ç±»å¦‚ä¸‹ï¼š SelectionKey.OP_CONNECT SelectionKey.OP_ACCEPT SelectionKey.OP_READ SelectionKey.OP_WRITE 1234567public static final int OP_READ = 1 &lt;&lt; 0;public static final int OP_WRITE = 1 &lt;&lt; 2;public static final int OP_CONNECT = 1 &lt;&lt; 3;public static final int OP_ACCEPT = 1 &lt;&lt; 4;// å¯ä»¥çœ‹å‡ºæ¯ä¸ªäº‹ä»¶å¯ä»¥è¢«å½“æˆä¸€ä¸ªä½åŸŸï¼Œä»è€Œç»„æˆäº‹ä»¶é›†æ•´æ•°int interestSet = SelectionKey.OP_READ | SelectionKey.OP_WRITE; Selector çš„åŸç†å›¾å¦‚ä¸‹ï¼š Reactor æ¨¡å¼å½“ä½¿ç”¨ NIO ç¼–å†™ Java æœåŠ¡å™¨ç›¸å…³çš„ç¨‹åºçš„æ—¶å€™ï¼Œé€šå¸¸ä¼šé‡‡ç”¨åä¸º Reactor çš„è®¾è®¡æ¨¡å¼ã€‚ Wikipedia: The reactor design pattern is an event handling pattern for handling service requests delivered concurrently by one or more inputs. The service handler then demultiplexes the incoming requests and dispatches them synchronously to associated request handlers. ç”»ä¸ªå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºå½“æœ‰å¤–éƒ¨äº‹ä»¶å‘ç”Ÿåï¼Œè¿™äº›äº‹ä»¶å‘é€ç»™ Service Handlerï¼ŒService Handler çš„ä½œç”¨æ˜¯åšä¸€ä¸ªåˆ†å‘ï¼Œå°†è¿™äº›è¯·æ±‚åˆ†å‘ç»™å…·ä½“çš„ Handler è¿›è¡Œå¤„ç†ã€‚ é‚£ä¹ˆå°† Reactor æ¨¡å¼åº”ç”¨åˆ° NIO çš„æœåŠ¡å™¨ç¼–ç¨‹ä¸Šï¼Œå¯ä»¥æœ‰ä¸‰ç§æ–¹æ¡ˆã€‚ å•çº¿ç¨‹ Reactor Reactor çº¿ç¨‹è¦åšå¾ˆå¤šäº‹æƒ…ï¼ŒåŒ…æ‹¬ï¼š æ¥å—è¯·æ±‚ï¼Œæ³¨å†Œäº‹ä»¶ å°†å°±ç»ªäº‹ä»¶åˆ†åˆ«å¤„ç† è¿™ç§æ¨¡å¼ä¸‹ï¼ŒReactor çº¿ç¨‹åˆè¦ç»´æŠ¤è¿æ¥ï¼Œåˆè¦åšç›¸åº”çš„å·¥ä½œã€‚ å¸¦çº¿ç¨‹æ± çš„ Reactor å•çº¿ç¨‹ Reactor æ¨¡å¼ï¼Œæœ€ç›´è§‚çš„æ”¹è¿›æ–¹å¼å°±æ˜¯åœ¨äº‹ä»¶å¤„ç†çš„éƒ¨åˆ†å¼•å…¥å·¥ä½œé˜Ÿåˆ— + çº¿ç¨‹æ± ã€‚æˆ‘ä»¬å°†å°±ç»ªä»»åŠ¡è¿›è¡Œåˆ†ç±»ï¼Œå¯¹æ¯ä¸€ç§ç±»åˆ«çš„ä»»åŠ¡ï¼Œæäº¤åˆ°ä¸“å±çš„çº¿ç¨‹æ± ä¸­å»å¤„ç†ã€‚è¿™æ · Reactor çº¿ç¨‹åªéœ€è¦åšæ¥å—è¯·æ±‚ï¼Œæ³¨å†Œç›‘å¬äº‹ä»¶çš„ä»»åŠ¡ã€‚è€Œä»»åŠ¡çš„å¤„ç†æäº¤ç»™å…¶ä»–çº¿ç¨‹ï¼Œä¸ä»…å¯ä»¥å‡å° Reactor çš„å‹åŠ›ï¼Œä¹Ÿèƒ½å¤Ÿæé«˜ä»»åŠ¡å¤„ç†çš„é€Ÿåº¦ã€‚ ä¸»ä»å¤š Reactor ä½¿ç”¨ä¸€ä¸ª Reactor çº¿ç¨‹æ¥æ¥å—è¯·æ±‚ï¼Œæ³¨å†Œç›‘å¬æ‰€æœ‰çš„è¯»å†™äº‹ä»¶ï¼Œå½“è¯»å†™äº‹ä»¶å˜å¤šæ—¶ï¼Œä½†çº¿ç¨‹å¯èƒ½æ— æ³•æ»¡è¶³æ€§èƒ½çš„éœ€æ±‚ã€‚å¯ä»¥å¼•å…¥äº†å¤š Reactorï¼Œä¹Ÿå³ä¸€ä¸ªä¸» Reactor è´Ÿè´£ç›‘æ§æ‰€æœ‰çš„è¿æ¥è¯·æ±‚ï¼Œå¤šä¸ªå­ Reactor è´Ÿè´£ç›‘æ§å¹¶å¤„ç†è¯»/å†™è¯·æ±‚ï¼Œå‡è½»äº†ä¸» Reactor çš„å‹åŠ›ï¼Œé™ä½äº†ä¸» Reactor å‹åŠ›å¤ªå¤§è€Œé€ æˆçš„å»¶è¿Ÿã€‚å¹¶ä¸”æ¯ä¸ªå­ Reactor åˆ†åˆ«å±äºä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼Œæ¯ä¸ªæˆåŠŸè¿æ¥åçš„ Channel çš„æ‰€æœ‰æ“ä½œç”±åŒä¸€ä¸ªçº¿ç¨‹å¤„ç†ã€‚è¿™æ ·ä¿è¯äº†åŒä¸€è¯·æ±‚çš„æ‰€æœ‰çŠ¶æ€å’Œä¸Šä¸‹æ–‡åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œé¿å…äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿äº†ç›‘æ§è¯·æ±‚å“åº”çŠ¶æ€ã€‚ æ€»ç»“Java NIO çš„å®ç°åŸºäºåº•å±‚æ“ä½œç³»ç»Ÿæä¾›çš„ç›¸å…³ APIï¼Œä¾‹å¦‚ Linux æä¾›äº† selectã€pollã€epoll ç­‰ç³»ç»Ÿè°ƒç”¨ã€‚Java NIO æ— ç–‘ä¸ºç¼–å†™çš„ IO ç¨‹åºæé«˜äº†æ€§èƒ½ï¼Œä½†æ˜¯å…¶ç¼ºç‚¹åœ¨äºå®ç°å¤æ‚ï¼Œç»´æŠ¤å’Œç®¡ç†å›°éš¾ã€‚è¿™ä¹Ÿæ˜¯ Netty æ¡†æ¶è‡´åŠ›äºè§£å†³çš„ç¼ºç‚¹ã€‚"},{"title":"Java åŸºç¡€ï¼šè¯¦è§£ HashCode","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-25T11:15:10.000Z","comments":true,"path":"back_posts/old_posts/Java/Java-åŸºç¡€è¯¦è§£-HashCode.html","permalink":"https://orechou.github.io/back_posts/old_posts/Java/Java-%E5%9F%BA%E7%A1%80%E8%AF%A6%E8%A7%A3-HashCode.html","excerpt":"Java ä¸­æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ª Object ç±»ï¼ŒObject ç±»ä¸­æœ‰ä¸ªè¿”å› hashCode çš„æœ¬åœ°æ–¹æ³•ã€‚ 1public native int hashCode(); åœ¨æ–‡æ¡£çš„æ³¨é‡Šä¸­å¾ˆæ¸…æ¥šçš„è¯´æ˜äº† hashCode çš„ä½œç”¨ï¼Œå’Œå®ƒåº”è¯¥æ»¡è¶³çš„ä¸€äº›è¦æ±‚ã€‚","text":"Java ä¸­æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ª Object ç±»ï¼ŒObject ç±»ä¸­æœ‰ä¸ªè¿”å› hashCode çš„æœ¬åœ°æ–¹æ³•ã€‚ 1public native int hashCode(); åœ¨æ–‡æ¡£çš„æ³¨é‡Šä¸­å¾ˆæ¸…æ¥šçš„è¯´æ˜äº† hashCode çš„ä½œç”¨ï¼Œå’Œå®ƒåº”è¯¥æ»¡è¶³çš„ä¸€äº›è¦æ±‚ã€‚ ä½œç”¨ï¼šç»™ä¸€ä¸ªå¯¹è±¡è¿”å›ä¸€ä¸ª hashCode å€¼ï¼Œè¿™ä¸ªå€¼åœ¨ hash table çš„æ•°æ®ç»“æ„ä¸­æœ‰é‡è¦çš„ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œç¡®å®šæ”¾ç½®åœ¨ hash table å“ªä¸ªç´¢å¼•ä½ç½®ï¼Œhash å†²çªçš„é¢‘ç‡ã€‚ è¦æ±‚ï¼š åŒä¸€ä¸ª Java å¯¹è±¡ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ã€‚è¯¥å¯¹è±¡è¿”å›çš„ hashCode åº”è¯¥ç›¸åŒã€‚ ä½¿ç”¨ equals æ–¹æ³•ï¼Œåˆ¤æ–­ä¸ºä¸¤ä¸ªç›¸ç­‰çš„å¯¹è±¡ï¼Œå…¶è¿”å›çš„ hashCode åº”è¯¥ç›¸åŒã€‚ ä½¿ç”¨ equals æ–¹æ³•ï¼Œåˆ¤æ–­ä¸ºä¸¤ä¸ªä¸ç›¸åŒçš„å¯¹è±¡ï¼Œå…¶è¿”å›çš„ hashCode åº”è¯¥ä¸ç›¸åŒã€‚ é€šå¸¸çš„ hashCode ç”Ÿæˆæ–¹æ³•æ˜¯å°†å¯¹è±¡çš„å†…å­˜åœ°å€è½¬æ¢æˆä¸€ä¸ªæ•´å‹æ•°ï¼Œè¿™æ ·å°±èƒ½ä¸ºä¸åŒçš„å¯¹è±¡è¿”å›ä¸€ä¸ªä¸ä¸€æ ·çš„ hashCodeã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•ä¸èƒ½æ»¡è¶³ä¸Šé¢çš„ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œæ‰€ä»¥è¿™ç§å®ç°ä¹Ÿä¸æ˜¯ Java è¯­è¨€æ‰€å¿…é¡»çš„å®ç°æ–¹æ³•ã€‚ åœ¨ String ä¸­çš„å®ç°String ç±»ä¹Ÿæ˜¯ç»§æ‰¿è‡ª Object ç±»ï¼Œå®ƒé‡å†™äº† hashCode() æ–¹æ³•ã€‚ 123456789101112131415/** Cache the hash code for the string */private int hash; // Default to 0public int hashCode() &#123; int h = hash; if (h == 0 &amp;&amp; value.length &gt; 0) &#123; char val[] = value; for (int i = 0; i &lt; value.length; i++) &#123; h = 31 * h + val[i]; &#125; hash = h; &#125; return h;&#125; åœ¨ String ä¸­è®¡ç®—çš„ hashCode ä¼šå­˜å‚¨åœ¨ hash å˜é‡ä¸­ï¼Œå¹¶ä¸”åªä¼šè®¡ç®—ä¸€æ¬¡ã€‚å› ä¸º String æ˜¯ final çš„ï¼Œå¹¶ä¸”ä¸€ä¸ª String å¯¹è±¡è¢«åˆå§‹åŒ–åæ— æ³•ä¿®æ”¹ï¼Œæ‰€ä»¥å®ƒçš„ hashCode ä¸ä¼šå˜åŒ–ã€‚ for å¾ªç¯è®¡ç®— hashCode çš„æ–¹æ³•æ˜¯æ ¹æ®ä»¥ä¸‹å¼å­ï¼šs[0]*31^(n-1) + s[1]*31^(n-2) + â€¦ + s[n-1]ã€‚ ä½¿ç”¨ 31 çš„åŸå› 31 æ˜¯ä¸€ä¸ªè´¨æ•°ï¼ˆPrime numberï¼‰ï¼Œè´¨æ•°ä¹Ÿç§°ä¸ºç´ æ•°ã€‚è´¨æ•°æ˜¯å¤§äº 1 çš„è‡ªç„¶æ•°ï¼Œä¸”åªèƒ½è¢« 1 å’Œå…¶æœ¬èº«æ•´é™¤ã€‚ é€‰æ‹© 31 çš„åŸå› å¤§æ¦‚æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š ä¸€ä¸ªæ•°ä¹˜è´¨æ•°åçš„ç»“æœï¼Œåªèƒ½è¢« 1 ã€è´¨æ•°ã€ä¹˜æ•°è¿˜æœ‰ç»“æœæœ¬èº«æ•´é™¤ã€‚è®¡ç®— hashCode é€‰æ‹©ä¸€ä¸ªä¼˜è´¨è´¨æ•°å¯ä»¥é™ä½ hash çš„å†²çªç‡ã€‚ 31 ï¼ˆ2 &lt;&lt; 5 - 1ï¼‰ï¼Œåœ¨è®¡ç®—çš„è¿‡ç¨‹ä¸­å¯ä»¥è¢« JVM ä¼˜åŒ–ã€‚ ç›¸ä¿¡ç¬¬äºŒç‚¹å¾ˆå¤šåŒå­¦éƒ½èƒ½å¤Ÿç†è§£ï¼Œç°åœ¨è§£é‡Šä¸€ä¸‹ç¬¬ä¸€ç‚¹ã€‚ æˆ‘ä»¬åˆ—ä¸¾ä¸€ä¸‹ 100 ä»¥å†…å·¦å³çš„è´¨æ•°ï¼š2ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ11ï¼Œ13ï¼Œ17ï¼Œ19ï¼Œ23ï¼Œ29ï¼Œ31ï¼Œ37ï¼Œ41ï¼Œ43ï¼Œ47ï¼Œ53ï¼Œ59ï¼Œ61ï¼Œ67ï¼Œ71ï¼Œ73ï¼Œ79ï¼Œ83ï¼Œ89ï¼Œ97ã€‚ ä»ä¸Šé¢çš„è´¨æ•°ä¸­é€‰æ‹©ä¸‰ä¸ªå°ä¸­å¤§è´¨æ•°ï¼š2ï¼Œ31ï¼Œ97ã€‚åˆ†æå…¬å¼ s[0]*31^(n-1) + s[1]*31^(n-2) + â€¦ + s[n-1] ä¸­çš„æ¯ä¸€é¡¹ï¼Œéƒ½æ˜¯ä¸€ä¸ªæ•°ä¹˜è´¨æ•°çš„å¹³æ–¹é¡¹ã€‚æ‰€ä»¥æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹æ¯ä¸ªè´¨æ•°çš„ n æ¬¡æ–¹ï¼Œæˆ‘ä»¬é€‰æ‹© n = 5ã€‚é‚£ä¹ˆç»“æœå¦‚ä¸‹ï¼š è´¨æ•° ç»“æœ 2 2^5 = 32 31 31^5 = 28,629,151 97 97^5 = 8,587,340,257 å¯ä»¥çœ‹åˆ°é€šè¿‡è´¨æ•° 2 è®¡ç®—åçš„ hashCode å€¼æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„å€¼ï¼Œè€Œé€šè¿‡è´¨æ•° 97 è®¡ç®—åçš„ hashCode æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å€¼ï¼Œè€Œ 31 æ¯”è¾ƒé€‚ä¸­ã€‚ æˆ‘ä»¬å¯ä»¥è®¤ä¸º hashCode çš„èŒƒå›´è‹¥å¤ªå°ï¼Œå¯èƒ½ä¼šå¢åŠ  hash å†²çªçš„æ¦‚ç‡ã€‚è€Œè®¡ç®— hashCode çš„è®¡ç®—ä¹˜å­å¤ªå¤§å®¹æ˜“å¯¼è‡´æ•´å‹æ•°çš„æº¢å‡ºï¼ˆè¿™é‡Œå¹¶ä¸æ˜¯è¯´é€‰æ‹© 31 ä¸ä¼šå¯¼è‡´æº¢å‡ºï¼Œæ˜¯æŒ‡ä¸€ä¸ªå¯¼è‡´æº¢å‡ºçš„é€Ÿç‡ï¼‰ï¼Œä»è€Œä¹Ÿä¼šå¯¼è‡´ hash å†²çªçš„æ¦‚ç‡ã€‚31 å¯ä»¥æœ‰æ•ˆçš„å‡è½»è¿™ä¸¤ç‚¹ã€‚ æ›´è¯¦ç»†çš„å†…å®¹å¯ä»¥çœ‹ä¸€ä¸‹ stackoverflow ä¸Šé¢çš„è¿™ä¸ªé—®é¢˜ï¼šWhy does Javaâ€™s hashCode() in String use 31 as a multiplier? è®¾è®¡ hashCode ç®—æ³•æ ¹æ®ã€ŠEffective Javaã€‹ç¬¬äºŒç‰ˆä¸­çš„ç¬¬ 9 æ¡ï¼Œå¯¹äºæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ç±»ï¼Œè¦†ç›– equals æ–¹æ³•æ—¶éœ€è¦è¦†ç›– hashCode æ–¹æ³•ã€‚åŸå› åœ¨å‰é¢è¯´è¿‡ã€‚ é‚£ä¹ˆå¦‚ä½•è®¾è®¡ä¸€ä¸ª hashCode ç®—æ³•ï¼Œä¹¦ä¸­è®¾è®¡äº†ä¸€ä¸ªç®—æ³•ï¼š æŠŠæŸä¸ªé 0 çš„å¸¸æ•°å€¼ï¼Œæ¯”å¦‚ 17ï¼Œä¿å­˜åœ¨ä¸€ä¸ªåä¸º result çš„ int ç±»å‹çš„å˜é‡ä¸­ã€‚ å¯¹äºå¯¹è±¡ä¸­çš„æ¯ä¸ªåŸŸï¼Œåšå¦‚ä¸‹æ“ä½œï¼š ä¸ºè¯¥åŸŸè®¡ç®— int ç±»å‹çš„å“ˆå¸Œå€¼ c ï¼š å¦‚æœè¯¥åŸŸæ˜¯ boolean ç±»å‹ï¼Œåˆ™è®¡ç®— (f?1:0) å¦‚æœè¯¥åŸŸæ˜¯ byteã€charã€short æˆ–è€… int ç±»å‹ï¼Œåˆ™è®¡ç®— (int)f å¦‚æœè¯¥åŸŸæ˜¯ long ç±»å‹ï¼Œåˆ™è®¡ç®— (int)(f^(f&gt;&gt;&gt;32)) å¦‚æœè¯¥åŸŸæ˜¯ float ç±»å‹ï¼Œåˆ™è®¡ç®— Float.floatToIntBits(f) å¦‚æœè¯¥åŸŸæ˜¯ double ç±»å‹ï¼Œåˆ™è®¡ç®— Double.doubleToLongBits(f)ï¼Œç„¶åé‡å¤ç¬¬ä¸‰ä¸ªæ­¥éª¤ã€‚ å¦‚æœè¯¥åŸŸæ˜¯ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ï¼Œå¹¶ä¸”è¯¥ç±»çš„ equals æ–¹æ³•é€šè¿‡é€’å½’è°ƒç”¨ equals æ–¹æ³•æ¥æ¯”è¾ƒè¿™ä¸ªåŸŸï¼ŒåŒæ ·ä¸ºè¿™ä¸ªåŸŸé€’å½’çš„è°ƒç”¨ hashCodeï¼Œå¦‚æœè¿™ä¸ªåŸŸä¸º nullï¼Œåˆ™è¿”å›0ã€‚ å¦‚æœè¯¥åŸŸæ˜¯æ•°ç»„ï¼Œåˆ™è¦æŠŠæ¯ä¸€ä¸ªå…ƒç´ å½“ä½œå•ç‹¬çš„åŸŸæ¥å¤„ç†ï¼Œé€’å½’çš„è¿ç”¨ä¸Šè¿°è§„åˆ™ï¼Œå¦‚æœæ•°ç»„åŸŸä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¾ˆé‡è¦ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ Arrays.hashCode æ–¹æ³•ã€‚ æŒ‰ç…§å…¬å¼ result = 31 * result + cï¼ŒæŠŠä¸Šé¢æ­¥éª¤ 2.1 ä¸­è®¡ç®—å¾—åˆ°çš„æ•£åˆ—ç  c åˆå¹¶åˆ° result ä¸­ã€‚ è¿”å› result å‚è€ƒç§‘æ™®ï¼šä¸ºä»€ä¹ˆ String hashCode æ–¹æ³•é€‰æ‹©æ•°å­—31ä½œä¸ºä¹˜å­ Why does Javaâ€™s hashCode() in String use 31 as a multiplier? ã€ŠEffective Javaã€‹"},{"title":"è®¡ç®—æœºç½‘ç»œï¼šä¼ è¾“å±‚åè®®","date":"2021-10-29T06:35:18.520Z","updated":"2018-09-26T09:25:50.000Z","comments":true,"path":"back_posts/old_posts/Networks/è®¡ç®—æœºç½‘ç»œï¼šä¼ è¾“å±‚åè®®.html","permalink":"https://orechou.github.io/back_posts/old_posts/Networks/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE.html","excerpt":"åœ¨è®¡ç®—æœºç½‘ç»œçš„åˆ†å±‚åè®®çš„ä½“ç³»ç»“æ„ä¸­ï¼Œä¸ç®¡æ˜¯ OSI ä½“ç³»ç»“æ„ã€äº”å±‚ä½“ç³»ç»“æ„è¿˜æ˜¯ TCP/IP ä½“ç³»ç»“æ„ï¼Œå®ƒä»¬éƒ½æœ‰ä¼ è¾“å±‚ã€‚ä¼ è¾“å±‚æä¾›äº†è¿›ç¨‹é—´çš„é€šç”¨æ•°æ®ä¼ è¾“æœåŠ¡ã€‚åº”ç”¨å±‚çš„åè®®å¾ˆå¤šï¼Œå®šä¹‰é€šç”¨çš„ä¼ è¾“å±‚åè®®å°±å¾ˆé‡è¦ï¼Œèƒ½å¤Ÿæ”¯æŒä¸æ–­å¢å¤šçš„åº”ç”¨å±‚åè®®ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTCP/IP åè®®ç°‡å‘ˆç°æ²™æ¼çš„å½¢çŠ¶ï¼ŒTCP å’Œ IP åè®®èµ·åˆ°äº†ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ç½‘ç»œå±‚ IP åè®®æä¾›äº†å°½æœ€å¤§åŠªåŠ›äº¤ä»˜çš„åŠŸèƒ½ï¼Œè€Œè¦ä¿è¯æ•°æ®çš„æ­£ç¡®ä¼ è¾“ï¼Œéœ€è¦ TCP åè®®æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚ ä¼ è¾“å±‚ä¸€å…±æä¾›äº†ä¸¤ç§åè®®ï¼š ä¼ è¾“æ§åˆ¶åè®® ç”¨æˆ·æ•°æ®æŠ¥åè®®","text":"åœ¨è®¡ç®—æœºç½‘ç»œçš„åˆ†å±‚åè®®çš„ä½“ç³»ç»“æ„ä¸­ï¼Œä¸ç®¡æ˜¯ OSI ä½“ç³»ç»“æ„ã€äº”å±‚ä½“ç³»ç»“æ„è¿˜æ˜¯ TCP/IP ä½“ç³»ç»“æ„ï¼Œå®ƒä»¬éƒ½æœ‰ä¼ è¾“å±‚ã€‚ä¼ è¾“å±‚æä¾›äº†è¿›ç¨‹é—´çš„é€šç”¨æ•°æ®ä¼ è¾“æœåŠ¡ã€‚åº”ç”¨å±‚çš„åè®®å¾ˆå¤šï¼Œå®šä¹‰é€šç”¨çš„ä¼ è¾“å±‚åè®®å°±å¾ˆé‡è¦ï¼Œèƒ½å¤Ÿæ”¯æŒä¸æ–­å¢å¤šçš„åº”ç”¨å±‚åè®®ã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒTCP/IP åè®®ç°‡å‘ˆç°æ²™æ¼çš„å½¢çŠ¶ï¼ŒTCP å’Œ IP åè®®èµ·åˆ°äº†ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ç½‘ç»œå±‚ IP åè®®æä¾›äº†å°½æœ€å¤§åŠªåŠ›äº¤ä»˜çš„åŠŸèƒ½ï¼Œè€Œè¦ä¿è¯æ•°æ®çš„æ­£ç¡®ä¼ è¾“ï¼Œéœ€è¦ TCP åè®®æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚ ä¼ è¾“å±‚ä¸€å…±æä¾›äº†ä¸¤ç§åè®®ï¼š ä¼ è¾“æ§åˆ¶åè®® ç”¨æˆ·æ•°æ®æŠ¥åè®® UDPç”¨æˆ·æ•°æ®æŠ¥åè®® UDP ï¼ˆUser Datagram Protocolï¼‰æ˜¯æ— è¿æ¥çš„åè®®ï¼Œå®ƒæä¾›å°½æœ€å¤§å¯èƒ½çš„äº¤ä»˜ï¼Œé¢å‘æŠ¥æ–‡ã€‚æ²¡æœ‰æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶ï¼Œæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„é€šä¿¡æ¨¡å¼ã€‚ é¦–éƒ¨æ ¼å¼ é¦–éƒ¨å­—æ®µåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼ŒåŒ…æ‹¬æºç«¯å£ã€ç›®çš„ç«¯å£ã€é•¿åº¦ã€æ£€éªŒå’Œã€‚åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨ UDP ç”¨æˆ·æ•°æ®æŠ¥ä¹‹å‰å¢åŠ  12 ä¸ªå­—èŠ‚çš„ä¼ªé¦–éƒ¨ã€‚â€œä¼ªé¦–éƒ¨â€å¹¶ä¸æ˜¯ç”¨æˆ·æ•°æ®æŠ¥çœŸæ­£çš„é¦–éƒ¨ï¼Œåªæ˜¯åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œä¸´æ—¶æ·»åŠ åœ¨ UDP æ•°æ®æŠ¥å‰é¢ï¼Œå¾—åˆ°ä¸€ä¸ªä¸´æ—¶ UDP æ•°æ®æŠ¥ã€‚ä¼ªé¦–éƒ¨æ—¢ä¸å‘ä¸‹ä¼ é€ä¹Ÿä¸å‘ä¸Šé€’äº¤ï¼Œä»…ä»…æ˜¯ä¸ºäº†è®¡ç®—æ£€éªŒå’Œã€‚ æ ¹æ® UDP æŠ¥æ–‡æ ¼å¼å¯ä»¥çœ‹å‡ºå®ƒæ²¡æœ‰åƒ TCP é‚£æ ·çš„åºå·ï¼Œæ‰€ä»¥ä¸€ä»½ UDP æŠ¥æ–‡å°±æ˜¯ä¸€ä»½æ•°æ®ã€‚è€Œ IP æ•°æ®æŠ¥æœ€å¤§é•¿åº¦ä¸º 65535 å­—èŠ‚ï¼Œå»é™¤ 20 ä¸ª IP é¦–éƒ¨å’Œ 8 ä¸ªå­—èŠ‚çš„ UDP é¦–éƒ¨ï¼ŒUDP æ•°æ®æŠ¥ä¸­æ•°æ®çš„æœ€å¤§é•¿åº¦ä¸º 65507 å­—èŠ‚ã€‚æ‰€ä»¥ UDP æ˜¯æœ‰æœ€å¤§æŠ¥æ–‡é•¿åº¦é™åˆ¶çš„ã€‚ é€‚ç”¨åœºæ™¯é¦–å…ˆæ˜ç¡®ä¸€ä¸‹ UDP çš„ç‰¹ç‚¹ï¼Œæ— è¿æ¥ã€å¤šç§é€šä¿¡æ¨¡å¼å’Œå…·æœ‰æœ€å¤§æŠ¥æ–‡é•¿åº¦çš„é™åˆ¶ã€‚æ— è¿æ¥çš„å…·æœ‰é€Ÿåº¦å¿«çš„ä¼˜ç‚¹ï¼Œç¼ºç‚¹æ˜¯å®¹æ˜“ä¸¢å¤±æŠ¥æ–‡ï¼Œä¸”æŠ¥æ–‡ä¸€æ—¦ä¸¢å¤±å°±å†ä¹Ÿæ— æ³•æ¥æ”¶åˆ°äº†ã€‚æ‰€ä»¥è¦æ±‚å®æ—¶æ€§å¹¶ä¸”æ¥å—ä¸€å®šç¨‹åº¦çš„æ•°æ®ä¸¢å¤±çš„åº”ç”¨åœºæ™¯å¯ä»¥ä½¿ç”¨ UDPï¼Œä¾‹å¦‚å®æ—¶é€šè®¯ã€åœ¨çº¿è§†é¢‘ç­‰ã€‚å¦å¤– UDP æ”¯æŒä¸€å¯¹å¤šå’Œå¤šå¯¹å¤šçš„é€šä¿¡æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨å¤šæ’­é€šä¿¡çš„åœºæ™¯ä¸­ã€‚ TCPä¼ è¾“æ§åˆ¶åè®® TCP ï¼ˆTransmission Control Protocolï¼‰æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œå®ƒæä¾›äº†å¯é çš„äº¤ä»˜ï¼Œé¢å‘å­—èŠ‚æµã€‚å…·æœ‰æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶çš„åŠŸèƒ½ï¼Œæä¾›ä¸€å¯¹ä¸€å…¨åŒå·¥çš„é€šä¿¡æ¨¡å¼ã€‚ é¦–éƒ¨æ ¼å¼ TCP çš„é¦–éƒ¨å†…å®¹æ¯” UDP è¦å¤šä¸€äº›ã€‚é¦–å…ˆæœ‰ 20 å­—èŠ‚çš„å›ºå®šé•¿åº¦çš„å†…å®¹ï¼š æºç«¯å£ &amp; ç›®çš„ç«¯å£ åºå· seqï¼šå½“å‰æŠ¥æ–‡çš„åºå·ã€‚TCP æ˜¯é¢å‘å­—èŠ‚æµçš„ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ªæŠ¥æ–‡ï¼Œä¼šç»™ç¬¬ä¸€ä¸ªå­—èŠ‚ç¼–ä¸Šä¸€ä¸ªåºå·ï¼Œä¾‹å¦‚ seq = 300ã€‚è‹¥æŠ¥æ–‡çš„æºå¸¦çš„å­—èŠ‚æµçš„é•¿åº¦ä¸º 100ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„ seq åˆ™ä¸º 400ã€‚ ç¡®è®¤å· ackï¼šæœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡çš„åºå·ã€‚ä¾‹å¦‚æ¥æ”¶æ–¹æ”¶åˆ°åºå·ä¸º 300ï¼Œé•¿åº¦ä¸º 100 çš„æŠ¥æ–‡ã€‚é‚£ä¹ˆä»–è¿”å›çš„ ack ä¸º 400ã€‚ æ•°æ®åç§»ï¼šæŒ‡çš„æ˜¯æ•°æ®éƒ¨åˆ†è·ç¦»æŠ¥æ–‡èµ·å§‹å¤„çš„åç§»é‡ï¼Œä¹Ÿå¯ä»¥å½“åšæ˜¯æŠ¥æ–‡é¦–éƒ¨çš„é•¿åº¦ã€‚ ç¡®è®¤ ACKï¼šå½“ ACK=1 æ—¶ç¡®è®¤å·å­—æ®µæœ‰æ•ˆï¼Œå¦åˆ™æ— æ•ˆã€‚TCP è§„å®šï¼Œåœ¨è¿æ¥å»ºç«‹åæ‰€æœ‰ä¼ é€çš„æŠ¥æ–‡æ®µéƒ½å¿…é¡»æŠŠ ACK ç½® 1ã€‚ åŒæ­¥ SYNï¼šåœ¨è¿æ¥å»ºç«‹æ—¶ç”¨æ¥åŒæ­¥åºå·ã€‚å½“ SYN=1ï¼ŒACK=0 æ—¶è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚è‹¥å¯¹æ–¹åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å“åº”æŠ¥æ–‡ä¸­ SYN=1ï¼ŒACK=1ã€‚ ç»ˆæ­¢ FINï¼šç”¨æ¥é‡Šæ”¾ä¸€ä¸ªè¿æ¥ï¼Œå½“ FIN=1 æ—¶ï¼Œè¡¨ç¤ºæ­¤æŠ¥æ–‡æ®µçš„å‘é€æ–¹çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾è¿æ¥ã€‚ çª—å£ï¼šçª—å£å€¼ä½œä¸ºæ¥æ”¶æ–¹è®©å‘é€æ–¹è®¾ç½®å…¶å‘é€çª—å£çš„ä¾æ®ã€‚ä¹‹æ‰€ä»¥è¦æœ‰è¿™ä¸ªé™åˆ¶ï¼Œæ˜¯å› ä¸ºæ¥æ”¶æ–¹çš„æ•°æ®ç¼“å­˜ç©ºé—´æ˜¯æœ‰é™çš„ã€‚ ä¸‰æ¬¡æ¡æ‰‹TCP å»ºç«‹è¿æ¥è¦ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œå‡è®¾å­˜åœ¨å®¢æˆ·ç«¯ A å’ŒæœåŠ¡ç«¯ Bï¼Œå®ƒä»¬æ¡æ‰‹çš„æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹ï¼š è¿‡ç¨‹ æœåŠ¡ç«¯ B å¤„äº LISTENï¼ˆç›‘å¬ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥è¯·æ±‚ã€‚ å®¢æˆ·ç«¯ A å‘æœåŠ¡ç«¯ B å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼ŒSYN=1ï¼ŒACK=0ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªåºåˆ—å· xã€‚ æœåŠ¡ç«¯ B æ¥æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡ï¼Œè‹¥åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘å®¢æˆ·ç«¯ A å‘é€ç¡®è®¤æŠ¥æ–‡ã€‚å¹¶ä¸”é€‰æ‹©ä¸€ä¸ªæŠ¥æ–‡åºåˆ—å· yã€‚ A æ”¶åˆ° B çš„ç¡®è®¤æŠ¥æ–‡ä¹‹åï¼Œå‘ B å‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œç¡®è®¤å·ä¸º y+1, åºåˆ—å·ä¸º x+1ã€‚ B æ”¶åˆ° A çš„ç¡®è®¤æŠ¥æ–‡åï¼Œè¿æ¥å»ºç«‹ã€‚ ä¸‰æ¬¡æ¡æ‰‹åŸå› ä¸‰æ¬¡æ¡æ‰‹åœ¨äºä¸ºäº†é˜²æ­¢å¤±æ•ˆçš„è¯·æ±‚è¿æ¥åˆ°è¾¾æœåŠ¡å™¨ï¼Œè®©æœåŠ¡å™¨ä»¥ä¸ºå®¢æˆ·ç«¯åˆç”³è¯·è¿æ¥ï¼Œä»è€Œé”™è¯¯åœ°æ‰“å¼€äº†è¿æ¥ã€‚ å› ä¸ºç½‘ç»œçš„ç¯å¢ƒæ˜¯ä¸ç¡®å®šçš„ï¼Œå½“è¯·æ±‚æ–¹å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚è¿æ¥æŠ¥æ–‡åœ¨ç½‘ç»œä¸­æ»ç•™ï¼Œå®¢æˆ·ç«¯åœ¨ç­‰å¾…è¶…æ—¶ä¹‹åä¼šç»§ç»­é‡æ–°å‘é€è¯·æ±‚è¿æ¥ã€‚è‹¥ä¸è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼Œå½“å®¢æˆ·ç«¯åé¢çš„è¯·æ±‚è¿æ¥å»ºç«‹é€šè®¯å®Œæˆä¹‹åï¼Œæœ€å¼€å§‹å‘é€çš„æ»ç•™æŠ¥æ–‡è¢«ä¼ é€’ç»™äº†æœåŠ¡ç«¯ã€‚æœåŠ¡ç«¯ä¼šä»¥ä¸ºå®¢æˆ·ç«¯ç”³è¯·äº†æ–°çš„è¿æ¥ï¼Œä»è€Œæ‰“å¼€è¿æ¥å ç”¨èµ„æºã€‚è‹¥ä½¿ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡ç«¯å°±ä¼šå»ç¡®è®¤è¿™ä¸ªè¯·æ±‚è¿æ¥æ˜¯å¦æ˜¯å®¢æˆ·ç«¯è¦å‘èµ·å»ºç«‹çš„ï¼Œé¿å…é”™è¯¯åœ°æ‰“å¼€è¿æ¥ã€‚ åŠè¿æ¥å’Œå…¨è¿æ¥é˜Ÿåˆ—TCP è¯·æ±‚ä¸­æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼ŒåŠè¿æ¥é˜Ÿåˆ—ï¼ˆsyns queueï¼‰å’Œå…¨è¿æ¥é˜Ÿåˆ—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨æ¡æ‰‹çš„ç¬¬ä¸€æ­¥ä¸­ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°è¿æ¥çš„è¯·æ±‚åï¼Œä¼šå°†ç›¸å…³çš„ä¿¡æ¯å­˜å‚¨åˆ°åŠè¿æ¥é˜Ÿåˆ—ä¸­ã€‚ åœ¨æ¡æ‰‹çš„æœ€åä¸€æ­¥ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ ACK åï¼Œä¼šå°†ç›¸å…³ä¿¡æ¯ä»åŠè¿æ¥é˜Ÿåˆ—ä¸­å–å‡ºå­˜å…¥åˆ°å…¨è¿æ¥é˜Ÿåˆ—ä¸­ã€‚ syn floods æ”»å‡»å°±æ˜¯é’ˆå¯¹ TCP åŠè¿æ¥é˜Ÿåˆ—ï¼Œå¯¼è‡´è¯¥é˜Ÿåˆ—æ»¡ï¼Œä»è€Œæ— æ³•æ¥å—å…¶ä»–æ­£å¸¸çš„è¿æ¥è¯·æ±‚ã€‚ å½“æœåŠ¡ç«¯æ¥æ”¶åˆ°è¿æ¥è¯·æ±‚æ—¶ï¼Œå‘ç°å…¨è¿æ¥é˜Ÿåˆ—æ»¡å·²æ»¡ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯ä¼šè¿‡ä¸€æ®µæ—¶é—´æ‰ä¼šå‘é€ FIN ACK æŠ¥æ–‡ç»™è¯·æ±‚æ–¹ã€‚ é˜Ÿåˆ—é•¿åº¦å¯ä»¥é€šè¿‡ backlog å‚æ•°è¿›è¡Œè®¾ç½®ã€‚æˆ‘åœ¨è¿™é‡Œç†è§£çš„é•¿åº¦æ˜¯åŠè¿æ¥é˜Ÿåˆ— + å…¨è¿æ¥é˜Ÿåˆ—çš„å‚è€ƒé•¿åº¦ã€‚ 1int listen(int sockfd, int backlog); å››æ¬¡æŒ¥æ‰‹TCP æ–­å¼€è¿æ¥éœ€è¦è¿›è¡Œå››æ¬¡æŒ¥æ‰‹ï¼Œæ•´ä¸ªæŒ¥æ‰‹çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š è¿‡ç¨‹å‡è®¾å®¢æˆ·ç«¯ A é¦–å…ˆå‘é€å®Œæ•°æ®ã€‚ å®¢æˆ·ç«¯ A ä¼šå‘é€ç»ˆæ­¢æŠ¥æ–‡ï¼ŒFIN=1ï¼Œåºåˆ—å·ä¸º uã€‚æ­¤åˆ» A ä¼šè¿›å…¥FIN-WAIT-1 çš„çŠ¶æ€ã€‚ æœåŠ¡ç«¯ B æ”¶åˆ°ç»ˆæ­¢æŠ¥æ–‡åå‘é€ç¡®è®¤æŠ¥æ–‡ï¼Œæ­¤æ—¶ TCP å¤„äºåŠå…³é—­çŠ¶æ€ï¼ŒB å¯ä»¥å‘ A å‘é€æ•°æ®ä½† A ä¸èƒ½å‘ B å‘é€æ•°æ®ã€‚B è¿›å…¥ CLOSE-WAIT çŠ¶æ€ã€‚ å®¢æˆ·ç«¯ A æ”¶åˆ° B çš„ç¡®è®¤æŠ¥æ–‡ä¹‹åï¼Œè¿›å…¥ FIN-WAIT-2 çš„çŠ¶æ€ï¼Œå¹¶æ¥å— B æœªä¼ é€’å®Œçš„æ•°æ®ã€‚ å½“ B å‘é€å®Œæ•°æ®ä¹‹åå‘å‡ºç»ˆæ­¢æŠ¥æ–‡ï¼Œè¿›å…¥ LAST-ACK çŠ¶æ€ã€‚ A æ¥æ”¶åˆ° B çš„ç»ˆæ­¢æŠ¥æ–‡åï¼Œå‘å‡ºç¡®è®¤æŠ¥æ–‡ã€‚å¹¶è¿›å…¥ TIME-WAIT çŠ¶æ€ã€‚ B æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡åå…³é—­è¿æ¥ï¼Œè‹¥ A åœ¨ TIME-WAIT çŠ¶æ€ä¸‹ç­‰å¾… 2MSL æ—¶é—´æœªæ”¶åˆ° B çš„é‡ä¼ æŠ¥æ–‡ï¼Œåˆ™å…³é—­è¿æ¥ã€‚ å››æ¬¡æŒ¥æ‰‹çš„åŸå› è¿›è¡Œå››æ¬¡æŒ¥æ‰‹çš„åŸå› åœ¨äºï¼ŒTCP çš„é€šè®¯æ˜¯å…¨åŒå·¥çš„ï¼Œé€šä¿¡çš„åŒæ–¹éƒ½éœ€è¦å‘é€ä¸€æ¬¡ç»ˆæ­¢è¿æ¥çš„æŠ¥æ–‡ï¼Œè€Œæ¥å—çš„å¦ä¸€æ–¹éœ€è¦å‘é€ç¡®è®¤æŠ¥æ–‡æ‰å¯ä»¥å‘ŠçŸ¥å¯¹é¢æˆ‘å·²ç»æ”¶åˆ°æ–­å¼€æŠ¥æ–‡çš„è¯·æ±‚ã€‚ ç­‰å¾… 2MSL åŸå› MSLï¼ˆMaximum Segmet Lifetimeï¼‰æŒ‡çš„æ˜¯æŠ¥æ–‡åœ¨ç½‘ç»œä¸­èƒ½å¤Ÿå­˜åœ¨çš„æœ€é•¿æ—¶é—´ã€‚ å®¢æˆ·ç«¯å¤„äº FIN-WAIT-2 çŠ¶æ€æ—¶æ”¶åˆ°æœåŠ¡ç«¯çš„ç»ˆæ­¢æŠ¥æ–‡åæ‚”è¿›å…¥ TIME-WAIT çŠ¶æ€ï¼Œå¹¶ç­‰å¾…ä¸¤ä¸ª MSLï¼Œè¿™æ ·åšçš„åŸå› æœ‰ä¸¤ä¸ªï¼š ç¡®ä¿æœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡èƒ½å¤Ÿè¢«å¯¹æ–¹æ¥å—ã€‚è‹¥ B æœªæ¥æ”¶åˆ° A å‘é€çš„ç¡®è®¤æŠ¥æ–‡ï¼Œé‚£ä¹ˆ B å°±ä¼šé‡æ–°å‘é€ç»ˆæ­¢æŠ¥æ–‡ç»™ Aã€‚A è‹¥å†æ¬¡æ”¶åˆ°ç»ˆæ­¢æŠ¥æ–‡ï¼Œé‚£ä¹ˆå°±çŸ¥é“ B å¹¶æ²¡æœ‰æ¥æ”¶åˆ° A çš„ç¡®è®¤æŠ¥æ–‡ï¼Œå°±èƒ½å¤Ÿç»§ç»­å‘é€ã€‚ ç­‰å¾…çš„è¿™æ®µæ—¶é—´å†…å¯ä»¥ç¡®è®¤è¿™æ¬¡è¿æ¥ä¸­æ‰€å‘é€çš„æ‰€æœ‰æŠ¥æ–‡éƒ½ä¼šåœ¨ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œå½“å»ºç«‹ä¸‹ä¸€æ¬¡è¿æ¥çš„æ—¶å€™ï¼Œå¯ä»¥ç¡®å®šä¸ä¼šæ¥æ”¶åˆ°ä¸Šä¸€æ¬¡è¿æ¥ä¸­æ‰€å‘é€çš„æŠ¥æ–‡ã€‚ å¯é ä¼ è¾“TCP ç›¸æ¯”ä¸ UDP æœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼ŒTCP èƒ½å¤Ÿä¿è¯ä¼ è¾“æ˜¯å¯é çš„ã€‚å¯é ä¼ è¾“é€šè¿‡è¶…æ—¶é‡ä¼ ã€æ ¡éªŒå’Œã€æµé‡æ§åˆ¶ã€æ‹¥å¡æ§åˆ¶æ¥å®ç°ã€‚ è¶…æ—¶é‡ä¼ å‘é€æ–¹å‘é€ä¸€ä¸ªæŠ¥æ–‡åï¼Œä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ã€‚è‹¥å·²ä¸ªå·²ç»å‘é€çš„æŠ¥æ–‡åœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå°±é‡ä¼ è¿™ä¸€ä¸ªæŠ¥æ–‡ã€‚ æ ¡éªŒå’ŒTCP æŠ¥æ–‡å¤´éƒ¨ä¸­æœ‰éƒ¨åˆ†æ˜¯æ ¹æ®é¦–éƒ¨å’Œæ•°æ®è®¡ç®—çš„æ ¡éªŒå’Œï¼Œæ¥æ”¶æ–¹å¯ä»¥è®¡ç®—æ ¡éªŒå’Œç„¶åè¿™ä¸ªæ ¡éªŒå’Œç›¸æ¯”è¾ƒï¼Œåˆ¤æ–­æ•°æ®åœ¨æ•´ä¸ªä¼ è¾“çš„è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚è‹¥æ¥æ”¶æ–¹æ¥æ”¶åˆ°çš„æ ¡éªŒå’Œæœ‰å·®é”™ï¼Œé‚£ä¹ˆå°±ä¸¢å¼ƒè¯¥æŠ¥æ–‡ï¼Œè®©å‘é€æ–¹å†æ¬¡é‡ä¼ ã€‚ æ§åˆ¶æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶éƒ½è¦åŸºäºæ»‘åŠ¨çª—å£çš„æœºåˆ¶ã€‚ æ»‘åŠ¨çª—å£çª—å£å±äºç¼“å­˜ï¼Œç”¨æ¥æš‚å­˜å­—èŠ‚æµã€‚å‘é€æ–¹å’Œæ¥æ”¶æ–¹å„æœ‰ä¸€ä¸ªçª—å£ï¼Œæ¥æ”¶æ–¹é€šè¿‡ TCP æŠ¥æ–‡æ®µä¸­çš„çª—å£å­—æ®µå‘Šè¯‰å‘é€æ–¹è‡ªå·±çš„çª—å£å¤§å°ï¼Œå‘é€æ–¹æ ¹æ®è¿™ä¸ªå€¼å’Œå…¶å®ƒä¿¡æ¯è®¾ç½®è‡ªå·±çš„çª—å£å¤§å°ã€‚ å‘é€çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«å‘é€ï¼Œæ¥æ”¶çª—å£å†…çš„å­—èŠ‚éƒ½å…è®¸è¢«æ¥æ”¶ã€‚å¦‚æœå‘é€çª—å£å·¦éƒ¨çš„å­—èŠ‚å·²ç»å‘é€å¹¶ä¸”æ”¶åˆ°äº†ç¡®è®¤ï¼Œé‚£ä¹ˆå°±å°†å‘é€çª—å£å‘å³æ»‘åŠ¨ä¸€å®šè·ç¦»ï¼Œç›´åˆ°å·¦éƒ¨ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸æ˜¯å·²å‘é€å¹¶ä¸”å·²ç¡®è®¤çš„çŠ¶æ€ï¼›æ¥æ”¶çª—å£çš„æ»‘åŠ¨ç±»ä¼¼ï¼Œæ¥æ”¶çª—å£å·¦éƒ¨å­—èŠ‚å·²ç»å‘é€ç¡®è®¤å¹¶äº¤ä»˜ä¸»æœºï¼Œå°±å‘å³æ»‘åŠ¨æ¥æ”¶çª—å£ã€‚ æ¥æ”¶çª—å£åªä¼šå¯¹çª—å£å†…æœ€åä¸€ä¸ªæŒ‰åºåˆ°è¾¾çš„å­—èŠ‚è¿›è¡Œç¡®è®¤ï¼Œä¾‹å¦‚æ¥æ”¶çª—å£å·²ç»æ”¶åˆ°çš„å­—èŠ‚ä¸º {31, 34, 35}ï¼Œå…¶ä¸­ {31} æŒ‰åºåˆ°è¾¾ï¼Œè€Œ {34, 35} å°±ä¸æ˜¯ï¼Œå› æ­¤åªå¯¹å­—èŠ‚ 31 è¿›è¡Œç¡®è®¤ã€‚å‘é€æ–¹å¾—åˆ°ä¸€ä¸ªå­—èŠ‚çš„ç¡®è®¤ä¹‹åï¼Œå°±çŸ¥é“è¿™ä¸ªå­—èŠ‚ä¹‹å‰çš„æ‰€æœ‰å­—èŠ‚éƒ½å·²ç»è¢«æ¥æ”¶ã€‚ æµé‡æ§åˆ¶æµé‡æ§åˆ¶æ˜¯ä¸ºäº†æ§åˆ¶å‘é€æ–¹å‘é€é€Ÿç‡ï¼Œä¿è¯æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚æ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤æŠ¥æ–‡ä¸­çš„çª—å£å­—æ®µå¯ä»¥ç”¨æ¥æ§åˆ¶å‘é€æ–¹çª—å£å¤§å°ï¼Œä»è€Œå½±å“å‘é€æ–¹çš„å‘é€é€Ÿç‡ã€‚å°†çª—å£å­—æ®µè®¾ç½®ä¸º 0ï¼Œåˆ™å‘é€æ–¹ä¸èƒ½å‘é€æ•°æ®ã€‚ æ‹¥å¡æ§åˆ¶TCP æ‹¥å¡æ§åˆ¶ç›®çš„åœ¨äºå½“ç½‘ç»œä¸­å‡ºç°äº†æ‹¥å¡ï¼Œè‹¥å‘é€æ–¹ç»§ç»­é‡ä¼ æŠ¥æ–‡å’Œå‘é€æ–°æŠ¥æ–‡ï¼Œåˆ™ä¼šå¯¼è‡´ç½‘ç»œä¸­çš„æ‹¥å¡ç¨‹åº¦å˜å¾—æ›´é«˜ã€‚æ‰€ä»¥å½“ç½‘ç»œå‡ºç°æ‹¥å¡çš„æ—¶å€™ï¼Œéœ€è¦æ§åˆ¶å‘é€æ–¹çš„é€Ÿç‡ã€‚ TCP é€šè¿‡å››ä¸ªæ–¹æ³•æ¥è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼šæ»¡å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤ã€‚ å‘é€æ–¹éœ€è¦ç»´æŠ¤ä¸€ä¸ªå«åšæ‹¥å¡çª—å£ï¼ˆcwndï¼‰çš„çŠ¶æ€å˜é‡ï¼Œæ³¨æ„æ‹¥å¡çª—å£ä¸å‘é€æ–¹çª—å£çš„åŒºåˆ«ï¼šæ‹¥å¡çª—å£åªæ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ï¼Œå®é™…å†³å®šå‘é€æ–¹èƒ½å‘é€å¤šå°‘æ•°æ®çš„æ˜¯å‘é€æ–¹çª—å£ã€‚ æ…¢å¼€å§‹ &amp; æ‹¥å¡é¿å…å‘é€çš„æœ€åˆæ‰§è¡Œæ…¢å¼€å§‹ï¼Œä»¤ cwnd = 1ï¼Œå‘é€æ–¹åªèƒ½å‘é€ 1 ä¸ªæŠ¥æ–‡æ®µï¼›å½“æ”¶åˆ°ç¡®è®¤åï¼Œå°† cwnd åŠ å€ï¼Œå› æ­¤ä¹‹åå‘é€æ–¹èƒ½å¤Ÿå‘é€çš„æŠ¥æ–‡æ®µæ•°é‡ä¸ºï¼š2ã€4ã€8 â€¦ æ³¨æ„åˆ°æ…¢å¼€å§‹æ¯ä¸ªè½®æ¬¡éƒ½å°† cwnd åŠ å€ï¼Œè¿™æ ·ä¼šè®© cwnd å¢é•¿é€Ÿåº¦éå¸¸å¿«ï¼Œä»è€Œä½¿å¾—å‘é€æ–¹å‘é€çš„é€Ÿåº¦å¢é•¿é€Ÿåº¦è¿‡å¿«ï¼Œç½‘ç»œæ‹¥å¡çš„å¯èƒ½æ€§ä¹Ÿå°±æ›´é«˜ã€‚è®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ ssthreshï¼Œå½“ cwnd &gt;= ssthresh æ—¶ï¼Œè¿›å…¥æ‹¥å¡é¿å…ï¼Œæ¯ä¸ªè½®æ¬¡åªå°† cwnd åŠ  1ã€‚ å¦‚æœå‡ºç°äº†è¶…æ—¶ï¼Œåˆ™ä»¤ ssthresh = cwnd / 2ï¼Œç„¶åé‡æ–°æ‰§è¡Œæ…¢å¼€å§‹ã€‚ å¿«é‡ä¼  &amp; å¿«æ¢å¤åœ¨æ¥æ”¶æ–¹ï¼Œè¦æ±‚æ¯æ¬¡æ¥æ”¶åˆ°æŠ¥æ–‡æ®µéƒ½åº”è¯¥å¯¹æœ€åä¸€ä¸ªå·²æ”¶åˆ°çš„æœ‰åºæŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ã€‚ä¾‹å¦‚å·²ç»æ¥æ”¶åˆ° M1 å’Œ M2ï¼Œæ­¤æ—¶æ”¶åˆ° M4ï¼Œåº”å½“å‘é€å¯¹ M2 çš„ç¡®è®¤ã€‚ åœ¨å‘é€æ–¹ï¼Œå¦‚æœæ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µä¸¢å¤±ï¼Œæ­¤æ—¶æ‰§è¡Œå¿«é‡ä¼ ï¼Œç«‹å³é‡ä¼ ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚ä¾‹å¦‚æ”¶åˆ°ä¸‰ä¸ª M2ï¼Œåˆ™ M3 ä¸¢å¤±ï¼Œç«‹å³é‡ä¼  M3ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªæ˜¯ä¸¢å¤±ä¸ªåˆ«æŠ¥æ–‡æ®µï¼Œè€Œä¸æ˜¯ç½‘ç»œæ‹¥å¡ã€‚å› æ­¤æ‰§è¡Œå¿«æ¢å¤ï¼Œä»¤ ssthresh = cwnd / 2 ï¼Œcwnd = ssthreshï¼Œæ³¨æ„åˆ°æ­¤æ—¶ç›´æ¥è¿›å…¥æ‹¥å¡é¿å…ã€‚ æ…¢å¼€å§‹å’Œå¿«æ¢å¤çš„å¿«æ…¢æŒ‡çš„æ˜¯ cwnd çš„è®¾å®šå€¼ï¼Œè€Œä¸æ˜¯ cwnd çš„å¢é•¿é€Ÿç‡ã€‚æ…¢å¼€å§‹ cwnd è®¾å®šä¸º 1ï¼Œè€Œå¿«æ¢å¤ cwnd è®¾å®šä¸º ssthreshã€‚"}],"posts":[{"title":"ã€è¯»ä¹¦ã€‘ã€Šè¢«è®¨åŒçš„å‹‡æ°”ï¼šâ€œè‡ªæˆ‘å¯å‘ä¹‹çˆ¶â€é˜¿å¾·å‹’çš„å“²å­¦è¯¾ã€‹","slug":"reading/è¢«è®¨åŒçš„å‹‡æ°”ï¼šâ€œè‡ªæˆ‘å¯å‘ä¹‹çˆ¶â€é˜¿å¾·å‹’çš„å“²å­¦è¯¾","date":"2022-08-13T07:37:00.000Z","updated":"2022-08-13T07:40:45.264Z","comments":true,"path":"2022/08/13/reading/è¢«è®¨åŒçš„å‹‡æ°”ï¼šâ€œè‡ªæˆ‘å¯å‘ä¹‹çˆ¶â€é˜¿å¾·å‹’çš„å“²å­¦è¯¾/","link":"","permalink":"https://orechou.github.io/2022/08/13/reading/%E8%A2%AB%E8%AE%A8%E5%8E%8C%E7%9A%84%E5%8B%87%E6%B0%94%EF%BC%9A%E2%80%9C%E8%87%AA%E6%88%91%E5%90%AF%E5%8F%91%E4%B9%8B%E7%88%B6%E2%80%9D%E9%98%BF%E5%BE%B7%E5%8B%92%E7%9A%84%E5%93%B2%E5%AD%A6%E8%AF%BE/","excerpt":"","text":"ä¸‰å¥è¯æ€»ç»“æœ¬ä¹¦ äººç”Ÿç›®çš„è®ºã€‚ä½ ç°åœ¨æ‰€åšæ‰€ä¸ºï¼Œæ‰€ç»å†ã€é­é‡çš„ä¸€åˆ‡éƒ½ä¸æ˜¯è¿‡å»çš„åŸå› é€ æˆçš„ï¼Œè€Œæ˜¯å—ç°åœ¨ä½ çš„ç›®çš„å½±å“ã€‚ï¼ˆè¿‡å»å·²ç»å‘ç”Ÿï¼Œä½ æ‰€èƒ½åšçš„å”¯æœ‰æ”¹å˜è‡ªå·±çš„ç›®çš„ã€å¿ƒæ€ï¼‰ è¯¾é¢˜åˆ†ç¦»ï¼ˆç†æ¸…æ¥šè¯¾é¢˜å±äºè°ï¼‰ã€ä»–è€…è´¡çŒ®ï¼ˆè‡ªå·±æœ‰è´¡çŒ®æ„Ÿå³å¯ï¼Œä¸éœ€è¦å…³æ³¨åˆ«äººçš„çœ‹æ³•ï¼‰ã€‚ å°†äººç”Ÿçš„èšå…‰ç¯æ‰“åœ¨å½“ä¸‹ï¼Œè¿‡å¥½æ­¤æ—¶æ­¤åˆ»ï¼Œä¸è¦ç‰¹åˆ«åœ¨æ„è¿‡å»ï¼ˆè¿‡å»å·²ç»å‘ç”Ÿçš„æ— æ³•æ”¹å˜ï¼‰å’Œæœªæ¥ï¼ˆå½“ä¸‹åšçš„æ¯ä¸€ä»¶äº‹éƒ½å½±å“ç€æœªæ¥ï¼‰ã€‚ ç®€å•æ€»ç»“å’Œæ„Ÿå—ä¹¦çš„å†…å®¹ç®€å• &amp; ç›´è§‚ï¼Œä»¥ä¸€ä¸ªé’å¹´äººä¸ä¸€ä¸ªå“²äººçš„å¯¹è¯çš„å½¢å¼å±•å¼€ã€‚å†…å®¹ä¸å¤šã€ç« èŠ‚å¾ˆçŸ­ï¼Œè®©äººçœ‹ç€ä¸ç´¯ï¼Œæˆ‘ä¹Ÿè®¸ä¹…æ²¡æœ‰å®Œæ•´çœ‹å®Œè¿‡ä¸€æœ¬ä¹¦äº†ã€‚æ›´ä¸ºä¸»è¦çš„æ˜¯æœ€è¿‘å·¥ä½œ &amp; ç”Ÿæ´»å‹åŠ›æ¯”è¾ƒå¤§ï¼Œå¤–ç•Œå™ªéŸ³ä¹Ÿæ¯”è¾ƒå¤šï¼Œå¾ˆéš¾æœ‰æ—¶é—´èƒ½å¤Ÿé™ä¸‹å¿ƒæ¥å®¡è§†è‡ªå·±çš„å†…å¿ƒã€‚ æœ€ç²¾åçš„3å¥ä¹¦æ‘˜ â€å³ä½¿ä½ é€ƒé¿äººç”Ÿè¯¾é¢˜ã€ä¾èµ–äººç”Ÿè°è¨€ï¼Œé‚£ä¹Ÿä¸æ˜¯å› ä¸ºä½ æ²¾æŸ“äº†â€œæ¶â€ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªåº”è¯¥ä»é“å¾·æ–¹é¢æ¥è°´è´£çš„é—®é¢˜ï¼Œå®ƒåªæ˜¯â€œå‹‡æ°”â€çš„é—®é¢˜ã€‚â€œåŸè°…è‡ªå·±ã€ä¸è‡ªå·±å’Œè§£ï¼šæœ‰äº›åœºåˆã€æœ‰äº›äº‹æƒ…ã€æœ‰äº›å…³ç³»ï¼Œæˆ‘å®³æ€•å»åšã€å»æ‹–å»¶ã€å»ç»´æŠ¤ï¼Œå¿ƒé‡Œæœ‰å¾ˆå¤§çš„è´Ÿç½ªæ„Ÿã€å¯¹è‡ªå·±å¤±æœ›ï¼Œè®¤ä¸ºè‡ªå·±å·²ç»ä¸è¡Œäº†ã€‚å…¶å®è®¤æ¸…è¿™æ˜¯ä¸ªå‹‡æ°”çš„é—®é¢˜ï¼Œç„¶åè§£å†³å‹‡æ°”çš„é—®é¢˜å°±å¥½äº†ï¼Œä¸è¦å¯¹è‡ªå·±å¤±æœ›å¾ˆé‡è¦ã€‚ â€œæœ‰äº›ç”·äººä¼šéª‚å®¶åº­ä¸»å¦‡â€åˆä¸æŒ£é’±ï¼â€œæˆ–è€…â€æ˜¯è°å…»ç€ä½ å‘€ï¼Ÿâ€œä¹‹ç±»çš„è¯ï¼Œä¹Ÿå¬åˆ°è¿‡æœ‰äººè¯´â€é’±éšä¾¿ä½ èŠ±ï¼Œè¿˜æœ‰ä»€ä¹ˆä¸æ»¡çš„å‘€ï¼Ÿâ€œä¹‹ç±»çš„è¯ï¼Œè¿™éƒ½æ˜¯å¤šä¹ˆæ— æƒ…çš„è¯å‘€ï¼ç»æµåœ°ä½è·Ÿäººçš„ä»·å€¼æ¯«æ— å…³ç³»ã€‚å…¬å¸èŒå‘˜å’Œå®¶åº­ä¸»å¦‡åªæ˜¯åŠ³åŠ¨åœºæ‰€å’Œä»»åŠ¡ä¸åŒï¼Œå®Œå…¨æ˜¯â€è™½ä¸åŒä½†å¹³ç­‰â€œã€‚â€æˆ‘å·²ç»æˆå®¶ç«‹ä¸šï¼Œä¸å¦»å­ä¹Ÿå³å°†è¿æ¥çˆ±æƒ…çš„ç»“æ™¶ã€‚æ‘˜å½•è¿™æ®µé—®é¢˜æ˜¯æé†’è‡ªå·±ä¸è¦å˜æˆè¿™ç§è®¨åŒã€æ— æƒ…çš„äººã€‚ â€œè·¨å‡ºå®¶é—¨çš„é‚£ä¸€ç¬é—´ï¼Œâ€œæ—…è¡Œâ€å·²ç»å¼€å§‹ï¼Œæœç€ç›®çš„åœ°å‡ºå‘é€”ä¸­çš„æ¯ä¸€ä¸ªç¬é—´éƒ½æ˜¯æ—…è¡Œã€‚å½“ç„¶ï¼Œå³ä½¿å› ä¸ºæŸäº›äº‹æƒ…è€Œæ²¡èƒ½å¤Ÿåˆ°è¾¾é‡‘å­—å¡”ï¼Œé‚£ä¹Ÿå¹¶éæ²¡æœ‰æ—…è¡Œã€‚è¿™å°±æ˜¯ç°å®æ€§çš„äººç”Ÿã€‚â€æˆ‘ä¸€ç›´éƒ½åœ¨æ—…é€”ä¸­ï¼Œå¸Œæœ›è‡ªå·±æŠŠèšå…‰ç¯æ‰“åœ¨å½“ä¸‹ï¼Œè¿‡å¥½æ¯ä¸€å¤©ã€åšå¥½æ¯ä¸€ä»¶äº‹ï¼Œåˆ«æªç€è¿‡å»ä¸æ”¾ï¼Œåˆä¸€ç›´å¯¹æœªæ¥åœç•™åœ¨å¹»æƒ³ã€‚","categories":[],"tags":[{"name":"Reading","slug":"Reading","permalink":"https://orechou.github.io/tags/Reading/"}]},{"title":"ã€ç”Ÿæ´»ã€‘æ‰‹æœºåº”ç”¨å®‰è£… & ä½¿ç”¨æŒ‡å—","slug":"life/æ‰‹æœºåº”ç”¨å®‰è£… & ä½¿ç”¨æŒ‡å—","date":"2022-06-04T16:20:00.000Z","updated":"2022-06-05T07:48:04.198Z","comments":true,"path":"2022/06/05/life/æ‰‹æœºåº”ç”¨å®‰è£… & ä½¿ç”¨æŒ‡å—/","link":"","permalink":"https://orechou.github.io/2022/06/05/life/%E6%89%8B%E6%9C%BA%E5%BA%94%E7%94%A8%E5%AE%89%E8%A3%85%20&%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","excerpt":"","text":"å¦‚ä»Šçš„ä¸–ç•Œï¼Œæ‰‹æœºå·²ç»å±äºå‡ºè¡Œã€å·¥ä½œã€å¨±ä¹ã€ç”Ÿæ´»æ‰€å¿…ä¸å¯ç¼ºå°‘çš„è®¾å¤‡ã€‚å„ç§åº”ç”¨è½¯ä»¶ï¼Œä¾‹å¦‚çŸ¥ä¹ã€æŠ–éŸ³ã€æ·˜å®ç­‰å æ®äº†äººç”Ÿçš„å¤§éƒ¨åˆ†æ—¶é—´ã€‚æˆ‘ä½œä¸ºç”µå­äº§å“çš„é‡åº¦ç”¨æˆ·ï¼Œåœ¨æ¯å¤©ä¸ç”µå­è®¾å¤‡çš„æ¥è§¦è¿‡ç¨‹ä¸­ï¼Œä¸ä»…è€—è´¹äº†å¤§é‡çš„æ—¶é—´ã€ä¹Ÿè®©èº«ä½“å‡ºç°ä¸€äº›é—®é¢˜ã€‚é‰´äºæ­¤ï¼Œæˆ‘å†³å®šä¼˜åŒ–æ‰‹æœºåº”ç”¨è½¯ä»¶çš„å®‰è£…ã€ä½¿ç”¨ï¼Œå°†æ‰‹æœºçš„å¨±ä¹å±æ€§å‰”é™¤ï¼Œé™ä½ä¸€äº›æ— æ•ˆæ—¶é—´çš„æ¶ˆè€—ã€‚ åŸåˆ™No.1 å¸è½½æ‰€æœ‰æ¸¸æˆæˆ‘ä¸è®¤ä¸ºèƒ½åœ¨æ‰‹æœºä¸Šç©åˆ°çœŸæ­£çš„å¥½æ¸¸æˆï¼ŒèŠ±ç‚¹é’±ä¹° PS5 ã€Switch ä½ ä¼šæœ‰æ›´å¥½çš„æ¸¸æˆä½“éªŒã€‚æ‰‹æœºæ¸¸æˆçš„æœ€å¤§ä¼˜åŠ¿æ˜¯èƒ½å¤Ÿåœ¨ä»»ä½•æ—¶å€™æ€æ‰ä½ çš„æ—¶é—´ã€‚ No.2 åŠ²é‡ä½¿ç”¨å›½å¤–çš„è½¯ä»¶ &amp; æœåŠ¡å¦‚æœä¸æƒ³è¢«å°ç¦ã€è¢« 404ï¼ŒåŠ²é‡é€‰ç”¨å›½å¤–çš„è½¯ä»¶ &amp; æœåŠ¡ï¼Œåšä¸€ä¸ªæ•°å­—ç§»æ°‘ã€‚ No.3 è½¯ä»¶ &amp; æœåŠ¡å¦‚æœèƒ½é€šè¿‡ç”µè„‘è®¿é—®ï¼ŒåŠ²é‡å‡å°‘æ‰‹æœºç‰ˆå®‰è£…æ­¤æ¡è§„åˆ™ä¸»è¦æ˜¯é’ˆå¯¹ä¸€äº›éå®æ—¶æ€§çŸ¥è¯†è½¯ä»¶ï¼Œä¾‹å¦‚ï¼šçŸ¥ä¹ã€B ç«™ã€‚æˆ‘åœ¨æ‰‹æœºä¸Šåˆ·çŸ¥ä¹å’Œ B ç«™å¤§éƒ¨åˆ†æ˜¯å¨±ä¹å†…å®¹ã€ç¢ç‰‡åŒ–çš„è®¯æ¯ï¼Œè¿‡äº†ä¸€éå¤§è„‘ä»€ä¹ˆéƒ½ä¸ä¼šç•™ä¸‹ã€‚å¦‚æœä½¿ç”¨ç”µè„‘ï¼Œæˆ‘æ‰ä¼šæ˜¯ä¸»åŠ¨æœ‰ç›®çš„æ€§çš„å»äº†è§£ä¸€äº›å†…å®¹ã€‚ No.4 å¸è½½é•¿æ—¶é—´ä¸ç”¨çš„è½¯ä»¶ï¼Œè®©æ‰‹æœºç®€å•é•¿æ—¶é—´ä¸ç”¨çš„è½¯ä»¶å¤§æ¦‚ç‡ä¹‹åä¹Ÿä¸ä¼šä½¿ç”¨ï¼Œè€Œä¸”ç°åœ¨æµé‡å¾ˆä¾¿å®œï¼Œå…ˆå¸è½½ä¹Ÿæ²¡ç”¨ä»»ä½•å…³ç³»ã€‚ ä¸€äº›è½¯ä»¶æ¨èé˜…è¯»iBooksç›®å‰å¯¹äºæ•°å­—ä¹¦ç±ï¼Œå·²ç»å¼ƒå‘äº† kindle ã€å¾®ä¿¡è¯»ä¹¦ç­‰ä¸€ä¼—ç¡¬è½¯ä»¶ã€‚ç›®å‰ä½¿ç”¨ epub æ ¼å¼ç”µå­ä¹¦ + iBooks + iCloudï¼Œå¯ä»¥åœ¨ iPhoneã€iPad å’Œ mac ä¸Šæ— ç¼åˆ‡æ¢ï¼ŒåŒæ­¥é˜…è¯»è®°å½•ã€è¿›åº¦ã€‚ é‡‘èæŠ•èµ„Futubullé›ªçƒBinance","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"https://orechou.github.io/tags/Life/"}]},{"title":"ã€Javaã€‘è‡ªå®šä¹‰ Spring Security é‰´æƒ","slug":"java/Java_è‡ªå®šä¹‰ Spring Security é‰´æƒ","date":"2022-06-01T09:00:00.000Z","updated":"2022-06-04T16:06:49.912Z","comments":true,"path":"2022/06/01/java/Java_è‡ªå®šä¹‰ Spring Security é‰´æƒ/","link":"","permalink":"https://orechou.github.io/2022/06/01/java/Java_%E8%87%AA%E5%AE%9A%E4%B9%89%20Spring%20Security%20%E9%89%B4%E6%9D%83/","excerpt":"","text":"èƒŒæ™¯å½“æˆ‘ä»¬ä½¿ç”¨ Spring æŠ€æœ¯æ ˆæ­å»ºå•ä½“çš„ç³»ç»Ÿæˆ–æœåŠ¡æ—¶ï¼Œè‹¥ç³»ç»Ÿæ¶‰åŠåˆ°ç™»å½•é‰´æƒç­‰åŠŸèƒ½ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ SpringSecurity æ­é…ä¸€ä¸ª RBAC çš„æƒé™æ¨¡å‹ï¼Œå¾ˆå®¹æ˜“å®ç°ä¸€å¥— OAuth2 é‰´æƒã€æˆæƒçš„æµç¨‹ã€‚éšç€ä¸šåŠ¡æ‰©å±•ï¼Œå•ä½“çš„æœåŠ¡ä½œä¸ºä¸€ä¸ªå¾®æœåŠ¡å¹¶å…¥ä¸€ä¸ªå¤§çš„ç³»ç»Ÿä¹‹åã€‚æˆ‘ä»¬ä¸ºä¿è¯å…¶ä»–ä¸šåŠ¡èƒ½å¤Ÿè°ƒç”¨è¯¥å•ä½“æœåŠ¡ï¼Œä½†æ˜¯åˆæ— æ³•è®©å…¶ä»–ç³»ç»Ÿæ¥ä½¿ç”¨è¯¥æœåŠ¡å·²æœ‰é‰´æƒï¼Œä»è€Œå¼•å…¥å…¶ä»–å¾®æœåŠ¡éƒ½ç”¨åŸºç¡€çš„é‰´æƒæœåŠ¡ã€‚æ ¹æ®ä¸šåŠ¡åœºæ™¯çš„åŒºåˆ†ï¼Œå½“å•ä½“æœåŠ¡å†…éƒ¨ä½¿ç”¨çš„æ—¶å€™èµ° SpringSecurity çš„é‰´æƒï¼Œå•ä½“æœåŠ¡å¤–éƒ¨è°ƒç”¨çš„æ—¶å€™ä½¿ç”¨åŸºç¡€é‰´æƒæœåŠ¡é‰´æƒã€‚ åŸºç¡€è¦æ ¹æ®ä¸åŒçš„åœºæ™¯å¯ç”¨æˆ–ç»•è¿‡ SpringSecurityã€‚æˆ‘ä»¬å¯ä»¥é¦–å…ˆæƒ³åˆ°èƒ½å¦é€šè¿‡ URL æ¥åŒºåˆ†ä¸åŒçš„åœºæ™¯ï¼Œä½¿ç”¨ HttpSecurity çš„ permitAll() å’Œ authenticated() æ¥è®©ä¸åŒè·¯å¾„çš„æ¥å£æ˜¯å¦éœ€è¦èµ°é‰´æƒã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥å»ä¿®æ”¹ SpringSecurity çš„ Filter ï¼Œä½¿ç”¨è‡ªå®šä¹‰ Filter æˆ–è€…ç”¨åŠ¨æ€ä»£ç†å¯¹ Filter è¿›è¡Œå¢å¼ºã€‚ å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768@Aspect@Component@Slf4jpublic class AuthorizationHeaderAspect &#123; /** * åŸºç¡€é‰´æƒæœåŠ¡ Feign è°ƒç”¨ä¸šåŠ¡ */ @Autowired private OauthFeignBiz oauthFeignBiz; @Pointcut(&quot;execution(* org.springframework.security.oauth2.provider.authentication.OAuth2AuthenticationProcessingFilter.doFilter(..))&quot;) public void securityOauth2DoFilter() &#123; &#125; @Pointcut(&quot;execution(* org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(..))&quot;) public void securitySecurityInterceptor2DoFilter() &#123; &#125; @Around(&quot;securityOauth2DoFilter()&quot;) public void enhanceSecurityOauth2DoFilter(ProceedingJoinPoint joinPoint) throws Throwable &#123; Object[] args = joinPoint.getArgs(); if (args == null || args.length != 3 || !(args[0] instanceof HttpServletRequest &amp;&amp; args[1] instanceof javax.servlet.ServletResponse &amp;&amp; args[2] instanceof FilterChain)) &#123; joinPoint.proceed(); return; &#125; HttpServletRequest request = (HttpServletRequest) args[0]; String accessToken = request.getHeader(&quot;Authorization&quot;); if (StringUtils.isNotBlank(request.getParameter(&quot;sceneId&quot;)) &amp;&amp; StringUtils.isNotBlank(request.getParameter(&quot;sceneType&quot;))) &#123; // è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯ç¡®å®šèµ°å“ªç§é‰´æƒæ–¹å¼ SecurityUtils.setBaseAuth(true); &#125; else &#123; SecurityUtils.setBaseAuth(false); &#125; if (SecurityUtils.isBaseAuth()) &#123; Response&lt;CheckTokenResponse&gt; checkTokenResponse = oauthFeignBiz.checkToken(accessToken); if (checkTokenResponse.getCode() == 0) &#123; SecurityUtils.setBaseAuth((true)); ((FilterChain) args[2]).doFilter((ServletRequest) args[0], (ServletResponse) args[1]); &#125; else &#123; throw new Exception(&quot;é‰´æƒå¤±è´¥&quot;); &#125; &#125; else &#123; // è®©åŸ Filter çš„é€»è¾‘ç»§ç»­æ‰§è¡Œ joinPoint.proceed(); &#125; &#125; @Around(&quot;securitySecurityInterceptor2DoFilter()&quot;) public void enhanceSecuritySecurityInterceptor2DoFilter(ProceedingJoinPoint joinPoint) throws Throwable &#123; Object[] args = joinPoint.getArgs(); if (args == null || args.length != 3 || !(args[0] instanceof HttpServletRequest &amp;&amp; args[1] instanceof javax.servlet.ServletResponse &amp;&amp; args[2] instanceof FilterChain)) &#123; joinPoint.proceed(); return; &#125; if (!SecurityUtils.isBaseOauth()) &#123; joinPoint.proceed(); return; &#125; ((FilterChain) args[2]).doFilter((ServletRequest) args[0], (ServletResponse) args[1]); &#125;&#125;","categories":[],"tags":[{"name":"Java","slug":"Java","permalink":"https://orechou.github.io/tags/Java/"}]},{"title":"ã€èµ„æºã€‘Batcave Resources ç¬¬ä¸€æœŸ","slug":"other/ç½‘ç»œèµ„æº","date":"2022-05-13T15:40:00.000Z","updated":"2022-07-12T07:41:33.804Z","comments":true,"path":"2022/05/13/other/ç½‘ç»œèµ„æº/","link":"","permalink":"https://orechou.github.io/2022/05/13/other/%E7%BD%91%E7%BB%9C%E8%B5%84%E6%BA%90/","excerpt":"","text":"ä¸‹é¢è®°å½•ä¸€äº›å¹³æ—¶æ”¶å½•çš„ä¸€äº›èµ„æºã€‚ èµ„æºç«™[1]Z-Library: å…¨çƒæœ€å¤§çš„æ•°å­—å›¾ä¹¦é¦†ç›®å‰å¯¹äºæ•°å­—ä¹¦ç±ï¼Œå·²ç»å¼ƒå‘äº† kindle ã€å¾®ä¿¡è¯»ä¹¦ç­‰ä¸€ä¼—ç¡¬è½¯ä»¶ã€‚ç›®å‰ä½¿ç”¨ epub æ ¼å¼ç”µå­ä¹¦ + iBooks + iCloudï¼Œå¯ä»¥åœ¨ iPhoneã€iPad å’Œ mac ä¸Šæ— ç¼åˆ‡æ¢ï¼ŒåŒæ­¥é˜…è¯»è®°å½•ã€è¿›åº¦ã€‚ å°å·¥å…·[1]Batman-Logo: æ–°è™è ä¾  Logo ç”Ÿæˆå™¨ [2]earth.fm: è†å¬ä¸–ç•Œçš„ç™½å™ªéŸ³ [3]muselink: æç®€æ•°å­—åç‰‡ï¼Œåªä¸ºåˆ›ä½œè€… [4]imgg: ä»¥å›¾ç‰‡çš„æ–¹å¼æˆªå–å¹¶åˆ†äº«ä¸‡ç‰©ï¼Œç®€å•ï¼Œç¾è§‚ä¸”éšç§å®‰å…¨ [5]ActivityWatch: ä¸€æ¬¾å…è´¹çš„è‡ªåŠ¨è¿½è¸ªåœ¨ä½ è®¾å¤‡ä¸Šä½¿ç”¨æ—¶é—´çš„è½¯ä»¶","categories":[],"tags":[{"name":"Other","slug":"Other","permalink":"https://orechou.github.io/tags/Other/"}]},{"title":"ã€æ­Œæ›²ã€‘Deadman's Gun && That's The Way It Is","slug":"life/Deadman's Gun","date":"2022-04-27T16:25:00.000Z","updated":"2022-07-30T09:27:42.092Z","comments":true,"path":"2022/04/28/life/Deadman's Gun/","link":"","permalink":"https://orechou.github.io/2022/04/28/life/Deadman's%20Gun/","excerpt":"","text":"æˆé•¿é“è·¯æ˜¯æ¯”è¾ƒç—›è‹¦çš„ï¼Œä»é’å¹´ä¸€è·¯èµ°è¿‡æ¥ï¼Œè‡ªå·±çš„æ£±è§’è¢«ç£¨åœ†ï¼Œæ²¡æœ‰äº†ä»¥å¾€çš„ç¥æ°”ã€‚å¾€å¾€åœ¨æ·±å¤œçš„æ—¶å€™ï¼Œæƒ³èµ·æ›¾ç»é‚£äº›å–œæ¬¢çš„è‹±é›„ï¼Œéƒ½å·²è¿‡å»ï¼Œéƒ½å·²é€å»ã€‚è€Œæˆ‘æ‰åçŸ¥åè§‰ï¼Œå¿˜äº†å‘Šåˆ«ã€‚ æ­Œæ›² Deadmanâ€™s Gun çš„ YouTube åœ°å€ã€‚æ­Œè¯å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041Your hands uponA deadman&#x27;s gun, and you&#x27;reLookin&#x27; down the sightsYour heart is warmAnd the seams are torn, and they&#x27;veGiven you a reason to fightAnd you&#x27;re not gonna takeWhat they&#x27;ve got to giveAnd you&#x27;re not gonna let &#x27;em take your will to liveBecause they&#x27;ve taken enoughAnd you&#x27;ve given them all you can giveAnd luck won&#x27;t save them tonightThey&#x27;ve given you a reason to fightAnd all the storms you&#x27;ve been chasin&#x27;About to rain down tonightAnd all that pain you&#x27;ve been facin&#x27;About to come into the lightYour hands uponA deadman&#x27;s gun, and you&#x27;reLookin&#x27; down the sightsYour heart is warmAnd the seams are torn, and they&#x27;veGiven you a reason to fightAnd you&#x27;re not gonna takeWhat they&#x27;ve got to giveAnd you&#x27;re not gonna let &#x27;em take your will to liveBecause they&#x27;ve taken enoughAnd you&#x27;ve given them all you can giveAnd luck won&#x27;t save them tonightThey&#x27;ve given you a reason to fightAnd all the storms you&#x27;ve been chasin&#x27;About to rain down tonightAnd all that pain you&#x27;ve been facin&#x27;About to come into the light æ­Œæ›² Thatâ€™s The Way It Is çš„ YouTube åœ°å€ã€‚æ­Œè¯å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041[Verse 1]The many miles we walkedThe many things we learnedThe building of a shrineOnly just to burnMay the wind be at your backGood fortune touch your handMay the cards lay out a straightAll from your command[Chorus]That&#x27;s the way it isThatâ€™s the way it isThat&#x27;s the way it isThat&#x27;s the way it is[Verse 2]Blue heron leaves the northern skyTrusts the journey to new heightsWhatâ€™s the meaning of the scarIf we don&#x27;t know how to healShould we ever be apartThen how does it feel[Chorus]That&#x27;s the way it isThat&#x27;s the way it isThat&#x27;s the way it isThat&#x27;s the way it is[Bridge]Shine light into darknessShine light into darkness[Chorus]That&#x27;s the way it isThat&#x27;s the way it is (So many miles to walk)Thatâ€™s the way it is (So many things weâ€™ve got to learn)That&#x27;s the way it is (Oh, thatâ€™s the way it is)That&#x27;s the way it is (Oh)That&#x27;s the way it is","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"https://orechou.github.io/tags/Life/"},{"name":"Song","slug":"Song","permalink":"https://orechou.github.io/tags/Song/"}]},{"title":"ã€ç”Ÿæ´»ã€‘EDC æ¸…å•","slug":"life/EDC æ¸…å•","date":"2022-04-12T15:40:00.000Z","updated":"2022-04-12T15:48:44.637Z","comments":true,"path":"2022/04/12/life/EDC æ¸…å•/","link":"","permalink":"https://orechou.github.io/2022/04/12/life/EDC%20%E6%B8%85%E5%8D%95/","excerpt":"","text":"EDC means everyday carryï¼Œå³æ˜¯æ¯æ—¥é€šå‹¤æºå¸¦çš„ç‰©ä»¶ã€‚ä¹‹å‰çœ‹è¿‡ä¸€æœ¬ä¹¦ã€Šåªè¿‡å¿…è¦ç”Ÿæ´»ã€‹ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå»ºè®®æ˜¯å°†ä½ æ¯å¤©ä¼šç”¨åˆ°çš„ç‰©å“éƒ½æ”¾åˆ°é€šå‹¤èƒŒåŒ…ä¸­æ¯å¤©æºå¸¦ã€‚è¿™ç¯‡åšæ–‡å°±æ˜¯æ•´ç†æˆ‘å¦‚ä»Šæ¯å¤©å¿…ç”¨ã€å¿…å¸¦çš„ç‰©å“ã€‚ æ•°ç ç‰©å“No.1 MacBook Pro 13å…¬å¸é…å‘çš„ MacBook Pro (13-inch, 2020)ï¼ŒIntel i7ï¼Œ32Gã€‚ç”¨é€”ï¼šå†™ä»£ç ï¼Œå†™åšå®¢ã€‚ No.2 iPhone13 Pro Maxè‡ªç”¨æ‰‹æœºï¼Œ128Gã€‚ç”¨é€”ï¼šç¤¾äº¤ï¼ŒæŠ•èµ„ï¼Œèµ„è®¯ã€‚ No.3 Apple Watch Series 6è‡ªç”¨æ‰‹è¡¨ï¼Œ44 æ¯«ç±³æ¬¾ã€‚ç”¨é€”ï¼šçœ‹æ—¶é—´ï¼Œè®°å½•æ•°æ®ã€‚ éæ•°ç ç‰©å“No.1 æ–°ç§€ä¸½èƒŒåŒ…","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"https://orechou.github.io/tags/Life/"}]},{"title":"ã€iOSã€‘åœ¨åœ°å›¾ä¸­ç»˜åˆ¶åæ ‡è½¨è¿¹","slug":"iOS/iOS_åœ¨åœ°å›¾ä¸­ç»˜åˆ¶åæ ‡è½¨è¿¹","date":"2022-03-27T09:43:00.000Z","updated":"2022-03-27T11:15:57.214Z","comments":true,"path":"2022/03/27/iOS/iOS_åœ¨åœ°å›¾ä¸­ç»˜åˆ¶åæ ‡è½¨è¿¹/","link":"","permalink":"https://orechou.github.io/2022/03/27/iOS/iOS_%E5%9C%A8%E5%9C%B0%E5%9B%BE%E4%B8%AD%E7%BB%98%E5%88%B6%E5%9D%90%E6%A0%87%E8%BD%A8%E8%BF%B9/","excerpt":"","text":"ä¸€ç›´æœ‰æƒ³åšå±äºè‡ªå·±çš„ App çš„æƒ³æ³•ï¼Œé›¶é›¶æ•£æ•£åœ°æœ‰å­¦ä¹ ä¸€äº›å†…å®¹ï¼Œç°åœ¨å†³å®šå¼€å¯ä¸€ä¸ªè®°å½•å­¦ä¹ è¿‡ç¨‹çš„ç³»åˆ—åšæ–‡ï¼Œä»¥æ­¤æ¥å·©å›ºè‡ªå·±æ‰€å­¦åˆ°çš„ iOS å¼€å‘çŸ¥è¯†å’Œæ¿€åŠ±è‡ªå·±æŠŠç¬¬ä¸€ä¸ª App å®ç°å‡ºæ¥ã€‚è„‘æµ·ä¸­ä¸€ç›´æœ‰ä¸ªåšåœ°å›¾ç±»åº”ç”¨çš„æƒ³æ³•ï¼Œæœ¬ç§‘åšç§»åŠ¨è½¨è¿¹ç›¸å…³çš„æ¯•ä¸šè®¾è®¡ã€‚æ­¤ç±»åº”ç”¨ä¸»è¦åŒ…æ‹¬åœ°å›¾ï¼ˆMapï¼‰ã€åæ ‡ç‚¹ï¼ˆLocationï¼‰ã€ç»˜åˆ¶è½¨è¿¹ï¼ˆPolylineï¼‰å‡ ä¸ªè¦ç´ ã€‚è¿™ç¯‡åšæ–‡å°†ä¼šä½¿ç”¨ SwiftUI åœ¨åœ°å›¾ä¸Šè¿æ¥åæ ‡ç‚¹ç»˜åˆ¶å‡ºè½¨è¿¹ã€‚GPS åæ ‡æ•°æ®å¯ä»¥åœ¨ microsoft ä¸Šä¸‹è½½ã€‚æ•ˆæœå¦‚ä¸‹ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ª SwiftUI å·¥ç¨‹çš„é¡¹ç›®ï¼Œé¡¹ç›®çš„æ–‡ä»¶ç»„ç»‡å¦‚ä¸‹ï¼šå…ˆå®šä¹‰åæ ‡ç‚¹çš„æ•°æ®ç»“æ„ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910import Foundationstruct Location: Hashable, Codable, Identifiable &#123; var id: Int // ç»åº¦ var longitude: Double // çº¬åº¦ var latitude: Double var isValid: Bool&#125; åæ ‡æ•°æ®çš„ ViewModelï¼Œæˆ‘ä»¬å°†ä» location.json ä¸­åŠ è½½æ‰€æœ‰çš„åæ ‡ç‚¹ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829import Foundationfinal class LocationViewModel: ObservableObject &#123; @Published var locations: [Location] = load(&quot;location.json&quot;) &#125;func load&lt;T: Decodable&gt;(_ fileName: String) -&gt; T &#123; // The data value type allows simple byte buffers to take on behavior of Foundation objects. let data: Data guard let file = Bundle.main.url(forResource: fileName, withExtension: nil) else &#123; fatalError(&quot;Couldn&#x27;t find \\(fileName) in main bundle.&quot;) &#125; do &#123; data = try Data(contentsOf: file) &#125; catch &#123; fatalError(&quot;Couldn&#x27;t load \\(fileName) from main bundle:\\n\\(error)&quot;) &#125; do &#123; let decoder = JSONDecoder() return try decoder.decode(T.self, from: data) &#125; catch &#123; fatalError(&quot;Couldn&#x27;t parse \\(fileName) as \\(T.self):\\n\\(error)&quot;) &#125;&#125; æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ©ç”¨ UIViewRepresentable è¿™ä¸ªåè®®å®ç°å°† UIKit çš„ UIView é›†æˆåˆ° SwiftUI ä¸­ä½¿ç”¨ã€‚UIViewRepresentable åªåŒ…å«å››ä¸ªæ–¹æ³•ã€‚å…¶ä¸­ makeUIView , updateUIView ç”¨äºåˆ›å»ºå’Œæ›´æ–°è§†å›¾ã€‚makeCoordinator åˆ›å»ºåè°ƒå™¨ï¼Œç”¨äºé€šçŸ¥å…¶å®ƒ UI ä¸è¯¥ View ä¹‹é—´çš„å˜åŒ–æ›´æ–°ã€‚dismantleUIView ç”¨äºåœ¨ç§»é™¤ View æ—¶åšä¸€äº›å–„åæ“ä½œã€‚å››ä¸ªæ–¹æ³•åœ¨ UIViewRepresentable ç”Ÿå‘½å‘¨æœŸä¸­çš„è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼šæˆ‘ä»¬çš„ MapView ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import SwiftUIimport MapKitstruct MapView: UIViewRepresentable &#123; private let locationViewModel = LocationViewModel() private let mapZoomEdgeInsets = UIEdgeInsets(top: 30.0, left: 30.0, bottom: 30.0, right: 30.0) func makeCoordinator() -&gt; MapViewCoordinator &#123; MapViewCoordinator(self) &#125; func makeUIView(context: Context) -&gt; MKMapView &#123; let mapView = MKMapView() mapView.showsUserLocation = true mapView.delegate = context.coordinator return mapView &#125; func updateUIView(_ uiView: MKMapView, context: UIViewRepresentableContext&lt;MapView&gt;) &#123; updateOverlays(from: uiView) &#125; private func updateOverlays(from mapView: MKMapView) &#123; mapView.removeOverlays(mapView.overlays) var coordinates = [CLLocationCoordinate2D]() for i in 0..&lt;locationViewModel.locations.count &#123; let location = locationViewModel.locations[i] coordinates.append(CLLocationCoordinate2D(latitude: location.latitude, longitude: location.longitude)) &#125; let polyline = MKPolyline(coordinates: coordinates, count: locationViewModel.locations.count) mapView.addOverlay(polyline) setMapZoomArea(map: mapView, polyline: polyline, edgeInsets: mapZoomEdgeInsets, animated: true) &#125; private func setMapZoomArea(map: MKMapView, polyline: MKPolyline, edgeInsets: UIEdgeInsets, animated: Bool = false) &#123; map.setVisibleMapRect(polyline.boundingMapRect, edgePadding: edgeInsets, animated: animated) &#125;&#125;struct MapView_Previews: PreviewProvider &#123; static var previews: some View &#123; MapView() &#125;&#125; åè°ƒå™¨ MayViewCoordinator ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728import Foundationimport MapKitfinal class MapViewCoordinator: NSObject, MKMapViewDelegate &#123; private let mapView: MapView init(_ control: MapView) &#123; self.mapView = control &#125; func mapView(_ mapView: MKMapView, didAdd views: [MKAnnotationView]) &#123; if let annotationView = views.first, let annotation = annotationView.annotation &#123; if annotation is MKUserLocation &#123; let region = MKCoordinateRegion(center: annotation.coordinate, latitudinalMeters: 1000, longitudinalMeters: 1000) mapView.setRegion(region, animated: true) &#125; &#125; &#125; func mapView(_ mapView: MKMapView, rendererFor overlay: MKOverlay) -&gt; MKOverlayRenderer &#123; let renderer = MKPolylineRenderer(overlay: overlay) // set the line properties such as color and width renderer.strokeColor = .blue renderer.lineWidth = 3.0 return renderer &#125;&#125; å‚è€ƒé“¾æ¥https://www.fatbobman.com/posts/uikitInSwiftUI/https://medium.com/@mauvazquez/decoding-a-polyline-and-drawing-it-with-swiftui-mapkit-611952bd0ecb","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"https://orechou.github.io/tags/iOS/"},{"name":"SwiftUI","slug":"SwiftUI","permalink":"https://orechou.github.io/tags/SwiftUI/"}]},{"title":"ã€ç”Ÿæ´»ã€‘è®°äº‹ä¸€åˆ™","slug":"life/è®°äº‹ä¸€åˆ™","date":"2022-02-13T07:40:00.000Z","updated":"2022-05-13T15:52:31.736Z","comments":true,"path":"2022/02/13/life/è®°äº‹ä¸€åˆ™/","link":"","permalink":"https://orechou.github.io/2022/02/13/life/%E8%AE%B0%E4%BA%8B%E4%B8%80%E5%88%99/","excerpt":"","text":"ä¸‹åˆï¼Œyoyo å’Œä¸¤æ”¯å°ğŸ±è™åœ¨ğŸ˜´ã€‚æˆ‘ååœ¨å®¢å…å†™ä¸€äº›æ–‡å­—ï¼Œè®°å½•ä¸€ä¸‹å¿ƒæƒ…ã€‚ é¦–å…ˆè¦è¯´çš„æ˜¯ï¼Œå¹´å‰æˆ‘å’Œ yoyo åœ¨è€å®¶ä¸¾åŠå®Œäº†å©šç¤¼ï¼Œè™½ç„¶æˆ‘ä»¬è¿˜æ²¡æœ‰é¢†è¯ï¼Œä½†ç»ˆäºæˆ‘ä»¬ä¹Ÿç®—æ˜¯å®Œæˆäº†å»å¹´æœ€å¤§ã€æœ€é‡è¦çš„ä¸€ä¸ª OKRã€‚ç°åœ¨ yoyo ä¹ŸğŸ¤°ğŸ»äº†ï¼Œè™½ç„¶è¿™ä¹Ÿæ˜¯ä¹‹å‰ä¸€ç›´è®¡åˆ’çš„äº‹æƒ…ï¼Œä½†å½“ ta çœŸçš„æ¥äº†çš„äº‹æƒ…ï¼Œæˆ‘å†…å¿ƒé™¤äº†æƒŠå–œ maxï¼Œè¿˜æ˜¯æœ‰äº›æ…Œå¼ çš„ã€‚è¿™ç§æ…Œå¼ ä¸èƒ½è®© yoyo çœ‹å‡ºæ¥ã€‚å¹´åæ²¡å‡ å¤©æˆ‘è·Ÿ yoyo å°±å·¥ä½œåŸå¸‚æ·±åœ³äº†ï¼Œè¿™åº§åŸå¸‚æ˜¯å¾ˆå¿™ç¢Œã€åŠ³ç´¯çš„ã€‚æ‰€ä»¥è¿™æ®µæ—¶é—´ï¼Œæˆ‘ä¹Ÿä¸€ç›´åœ¨è€ƒè™‘æ€ä¹ˆè®©æˆ‘ä»¬æ›´åŠ è½»æ¾ä¸€äº›ã€‚æ‰€ä»¥ç°åœ¨å…³æ³¨äº†æœ¬èº«å·¥ä½œä¹‹å¤–çš„ä¸€äº›å†…å®¹ï¼Œä¾‹å¦‚ åŒºå—é“¾ã€NFTsã€ç¾è‚¡ç­‰ç­‰ï¼Œæƒ³è¦æ‰¾åˆ°ä¸€äº›è™½ä¸èƒ½è¯´å®Œæˆè·¨è¶Šï¼Œä½†è‡³å°‘èƒ½è®©è‡ªå·±å·¥ä½œä¸é‚£ä¹ˆç´¯çš„äº‹æƒ…ã€‚æˆ‘ä¹Ÿä¸€ç›´åœ¨è€ƒè™‘æœªæ¥è‡ªç”±èŒä¸šçš„é“è·¯ï¼Œä½†æ— å¥ˆè‡ªå·±ç°åœ¨å¾ˆç¼ºä¹è‡ªä¿¡å’Œå¯¹è‡ªå·±çš„è®¤åŒã€‚ ä»Šå¹´å®šäº†å‡ ä¸ª OKRï¼ŒåŠªåŠ›å»å®ç°å§ã€‚å¦å¤–æˆ‘å¾—æ”¾æ¾ä½“éªŒç”Ÿæ´»ã€‚ä¸ç®¡å†å¤šäº‹æƒ…ï¼Œç”Ÿæ´»æ˜¯æˆ‘ä»¬è‡ªå·±çš„ã€‚å…ˆä¸è¯´è¿™ä¹ˆå¤šäº†ï¼Œæˆ‘å¾—å« yoyo èµ·æ¥å‡ºå»æ•£æ­¥äº†ã€‚","categories":[],"tags":[{"name":"Life","slug":"Life","permalink":"https://orechou.github.io/tags/Life/"}]},{"title":"ã€MySQLã€‘å®ç°åˆ—è¡¨æ•°æ®ç½®é¡¶","slug":"mysql/MySQL_å®ç°åˆ—è¡¨æ•°æ®ç½®é¡¶","date":"2021-08-16T06:46:00.000Z","updated":"2022-03-27T11:14:09.194Z","comments":true,"path":"2021/08/16/mysql/MySQL_å®ç°åˆ—è¡¨æ•°æ®ç½®é¡¶/","link":"","permalink":"https://orechou.github.io/2021/08/16/mysql/MySQL_%E5%AE%9E%E7%8E%B0%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E7%BD%AE%E9%A1%B6/","excerpt":"","text":"æœ‰çš„åˆ—è¡¨è·å–çš„ä¸šåŠ¡åœºæ™¯ï¼Œéœ€è¦æ ¹æ®ä¸€äº›æ¡ä»¶å°†æ•°æ®ç½®é¡¶ã€‚ ä¾‹å¦‚æœ‰ä¸€å¼ è¡¨æœ‰ id å’Œ name ä¸¤ä¸ªå­—æ®µã€‚æ•°æ®è¡¨å¦‚ä¸‹ã€‚ id name 1 1_name 2 2_name 3 3_name 4 4_name 5 5_name 6 6_name 7 7_name 8 8_name 9 9_name 10 10_name è‹¥éœ€è¦å°† id ä¸º 5 å’Œ 7 çš„æ•°æ®ç½®é¡¶ï¼Œå¹¶ä¸”åˆ†é¡µçš„ size æ˜¯ 5 çš„è¯ï¼Œæˆ‘ä»¬çš„ SQL å¯ä»¥è¿™æ ·å†™ï¼š 1234567SELECT * FROM goods ORDER BY CASE WHEN id = 5 THEN -10000 WHEN id = 7 THEN -9999 ELSE id ENDLIMIT 0, 5","categories":[],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://orechou.github.io/tags/MySQL/"}]},{"title":"ã€MySQLã€‘æ…¢ SQL åˆ†æ","slug":"mysql/MySQL_æ…¢ SQL åˆ†æ","date":"2021-08-10T04:30:00.000Z","updated":"2022-03-27T11:14:03.743Z","comments":true,"path":"2021/08/10/mysql/MySQL_æ…¢ SQL åˆ†æ/","link":"","permalink":"https://orechou.github.io/2021/08/10/mysql/MySQL_%E6%85%A2%20SQL%20%E5%88%86%E6%9E%90/","excerpt":"","text":"æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æè®¾ç½®æ…¢æŸ¥è¯¢å¯ä»¥é€šè¿‡ä¿®æ”¹å‘½ä»¤è®¾ç½®ï¼š è®¾ç½®å¼€å¯ï¼šSET GLOBAL slow_query_log = 1; #é»˜è®¤æœªå¼€å¯ï¼Œå¼€å¯ä¼šå½±å“æ€§èƒ½ï¼Œmysqlé‡å¯ä¼šå¤±æ•ˆ æŸ¥çœ‹æ˜¯å¦å¼€å¯ï¼šSHOW VARIABLES LIKE â€˜%slow_query_log%â€™; è®¾ç½®é˜ˆå€¼ï¼šSET GLOBAL long_query_time=3; æŸ¥çœ‹é˜ˆå€¼ï¼šSHOW ã€GLOBALã€‘ VARIABLES LIKE â€˜long_query_time%â€™; #é‡è¿æˆ–æ–°å¼€ä¸€ä¸ªä¼šè¯æ‰èƒ½çœ‹åˆ°ä¿®æ”¹å€¼ ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®ï¼Œé…ç½®æ–‡ä»¶ my.conf ä¼šä¸€ç›´ç”Ÿæ•ˆï¼Œåœ¨[mysqld]ä¸‹é…ç½®ï¼š 12345[mysqld]slow_query_log = 1; #å¼€å¯slow_query_log_file=/var/lib/mysql/atguigu-slow.log #æ…¢æ—¥å¿—åœ°å€ï¼Œç¼ºçœæ–‡ä»¶åhost_name-slow.loglong_query_time=3; #è¿è¡Œæ—¶é—´è¶…è¿‡è¯¥å€¼çš„SQLä¼šè¢«è®°å½•ï¼Œé»˜è®¤å€¼&gt;10log_output=FILE è·å–æ…¢ SQL ä¿¡æ¯æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•æ•°ï¼šSHOW GLOBAL STATUS LIKE â€˜%Slow_queries%â€™; æ¨¡æ‹Ÿè¯­å¥ï¼šSELECT SLEEP(4); æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—ï¼š 12345678910$ cat /usr/local/var/mysql/OreChoudeMacBook-Pro-slow.log/usr/local/Cellar/mysql/8.0.25_1/bin/mysqld, Version: 8.0.25 (Homebrew). started with:Tcp port: 3306 Unix socket: /tmp/mysql.sockTime Id Command Argument# Time: 2021-08-10T06:29:53.513752Z# User@Host: root[root] @ localhost [127.0.0.1] Id: 11# Query_time: 4.003605 Lock_time: 0.000000 Rows_sent: 1 Rows_examined: 1use test;SET timestamp=1628576989;select sleep(4); ä½¿ç”¨ mysqldumpslow åˆ†æä½¿ç”¨æ ·ä¾‹ï¼š mysqldumpslow -s r -t 10 /usr/local/var/mysql/OreChoudeMacBook-Pro-slow.log #å¾—åˆ°è¿”å›è®°å½•é›†æœ€å¤šçš„10ä¸ªSQL mysqldumpslow -s c -t 10 /usr/local/var/mysql/OreChoudeMacBook-Pro-slow.log #å¾—åˆ°è®¿é—®æ¬¡æ•°æœ€å¤šçš„10ä¸ªSQL mysqldumpslow -s t -t 10 -g â€œLEFT JOINâ€ /usr/local/var/mysql/OreChoudeMacBook-Pro-slow.log #å¾—åˆ°æŒ‰ç…§æ—¶é—´æ’åºçš„å‰10æ¡é‡Œé¢å«æœ‰å·¦è¿æ¥çš„æŸ¥è¯¢è¯­å¥ mysqldumpslow -s r -t 10 /usr/local/var/mysql/OreChoudeMacBook-Pro-slow.log | more #ç»“åˆ| moreä½¿ç”¨ï¼Œé˜²æ­¢çˆ†å±æƒ…å†µ Explain åˆ†æShow Profile åˆ†æShow Profile èƒ½å¤Ÿè·å–æ¯” Explain æ›´ä¸ºè¯¦ç»†çš„ä¿¡æ¯ï¼Œèƒ½å¤Ÿåˆ†æå½“å‰ä¼šè¯ä¸­è¯­å¥æ‰§è¡Œæ—¶çš„èµ„æºæ¶ˆè€—ï¼Œè·å– SQL åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ—¶é—´ã€‚ å¼€å¯ Profile12å¼€å¯ï¼šset profiling = on;æŸ¥çœ‹ï¼šSHOW VARIABLES LIKE &#x27;profiling%&#x27;; å¼€å¯å MySQL åå°ä¼šä¿å­˜æœ€è¿‘ 15 æ¬¡çš„ç»“æœã€‚ æŸ¥çœ‹ Profileä½¿ç”¨ SHOW PROFILES å¯ä»¥æŸ¥çœ‹æœ€è¿‘çš„ 15 æ¬¡ç»“æœã€‚ æŸ¥çœ‹å…·ä½“çš„ Profileé€šè¿‡ Query_ID å¯ä»¥å¾—åˆ°å…·ä½“ SQL ä»è¿æ¥ - æœåŠ¡ - å¼•æ“ - å­˜å‚¨å››å±‚ç»“æ„å®Œæ•´ç”Ÿå‘½å‘¨æœŸçš„è€—æ—¶ã€‚ ä½¿ç”¨å‘½ä»¤ï¼šSHOW PROFILE CPU, BLOCK IO FOR Query_ID å¯ç”¨å‚æ•°type: ALL #æ˜¾ç¤ºæ‰€æœ‰çš„å¼€é”€ä¿¡æ¯ BLOCK IO #æ˜¾ç¤ºå—IOç›¸å…³å¼€é”€ CONTEXT SWITCHES #ä¸Šä¸‹æ–‡åˆ‡æ¢ç›¸å…³å¼€é”€ CPU #æ˜¾ç¤ºCPUç›¸å…³å¼€é”€ä¿¡æ¯ IPC #æ˜¾ç¤ºå‘é€å’Œæ¥æ”¶ç›¸å…³å¼€é”€ä¿¡æ¯ MEMORY #æ˜¾ç¤ºå†…å­˜ç›¸å…³å¼€é”€ä¿¡æ¯ PAGE FAULTS #æ˜¾ç¤ºé¡µé¢é”™è¯¯ç›¸å…³å¼€é”€ä¿¡æ¯ SOURCE #æ˜¾ç¤ºå’ŒSource_functionï¼ŒSource_fileï¼ŒSource_lineç›¸å…³çš„å¼€é”€ä¿¡æ¯ SWAPS #æ˜¾ç¤ºäº¤æ¢æ¬¡æ•°ç›¸å…³å¼€é”€çš„ä¿¡æ¯ å¦‚æœå‡ºç°ä»¥ä¸‹å‡ ä¸ªçŠ¶æ€åˆ™ SQL éœ€è¦é‡ç‚¹åˆ†æï¼š converting HEAP to MyISAM #æŸ¥è¯¢ç»“æœå¤ªå¤§ï¼Œå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œåœ¨å¾€ç£ç›˜ä¸Šæ¬ Creating tmp table #åˆ›å»ºäº†ä¸´æ—¶è¡¨ï¼Œå›å…ˆæŠŠæ•°æ®æ‹·è´åˆ°ä¸´æ—¶è¡¨ï¼Œç”¨å®Œåå†åˆ é™¤ä¸´æ—¶è¡¨ Copying to tmp table on disk #æŠŠå†…å­˜ä¸­ä¸´æ—¶è¡¨å¤åˆ¶åˆ°ç£ç›˜ï¼Œå±é™©ï¼ï¼ï¼ locked","categories":[],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://orechou.github.io/tags/MySQL/"}]},{"title":"ã€MySQLã€‘Explain","slug":"mysql/MySQL_Explain","date":"2021-08-06T09:00:00.000Z","updated":"2022-03-27T11:14:13.632Z","comments":true,"path":"2021/08/06/mysql/MySQL_Explain/","link":"","permalink":"https://orechou.github.io/2021/08/06/mysql/MySQL_Explain/","excerpt":"","text":"MySQL ExplainExplain æ˜¯ MySQL è‡ªå¸¦çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ã€‚ ä½¿ç”¨ Explain + SQL å¯æŸ¥è¯¢å‡ºæ‰§è¡Œçš„ç›¸å…³ä¿¡æ¯ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹ 10 ä¸ªå±æ€§ï¼šid, select_type, table, type, possible_key, key, key_len, ref, row, filtered, Extra æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆï¼Œä¸»è¦å…³æ³¨ CPU å’Œ IOã€‚ idåæ˜ çš„æ˜¯è¡¨çš„è¯»å–é¡ºåºï¼Œæˆ–è€…æŸ¥è¯¢ä¸­ SELECT çš„æ‰§è¡Œé¡ºåºã€‚ å°è¡¨æ°¸è¿œé©±åŠ¨å¤§è¡¨ï¼Œä¸‰ç§æƒ…å†µï¼šï¼ˆ1ï¼‰id ç›¸åŒï¼Œæ‰§è¡Œé¡ºåºæ˜¯ç”±ä¸Šè‡³ä¸‹çš„ï¼ˆ2ï¼‰id ä¸åŒï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œid åºå·ä¼šé€’å¢ï¼Œid å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šå…ˆè¢«æ‰§è¡Œï¼ˆ3ï¼‰id å­˜åœ¨ç›¸åŒçš„ï¼Œä¹Ÿå­˜åœ¨ä¸åŒçš„ï¼Œæ‰€æœ‰ç»„ä¸­ï¼Œid è¶Šå¤§è¶Šå…ˆæ‰§è¡Œï¼Œå¦‚æœ id ç›¸åŒçš„ï¼Œä»ä¸Šå¾€ä¸‹é¡ºåºæ‰§è¡Œ select_typeåæ˜ çš„æ˜¯ MySQL ç†è§£çš„æŸ¥è¯¢ç±»å‹ï¼Œæœ‰å‡ ä¸‹å‡ ç§ï¼š SIMPLEï¼šç®€å•çš„ SELECT æŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ– UNION PRIMARYï¼šæŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­—éƒ¨åˆ†ï¼Œæœ€å¤–å±‚æŸ¥è¯¢æ ‡è®°ä¸º PRIMARY SUBQUERYï¼šSELECT æˆ– WHERE åˆ—è¡¨ä¸­çš„å­æŸ¥è¯¢ DERIVEDï¼šåœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢ï¼ŒMySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢ï¼ŒæŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œ UNIONï¼šè‹¥ç¬¬äºŒä¸ª SELECT å‡ºç°åœ¨ UNION åï¼Œåˆ™è¢«æ ‡è®°ä¸º UNIONï¼Œè‹¥ UNION åŒ…å«åœ¨ FROM å­—å¥çš„å­æŸ¥è¯¢ä¸­ï¼Œå¤–å±‚ SELECT å°†è¢«æ ‡è®°ä¸º DERIVED UNION RESULTï¼šUNION åçš„ç»“æœé›† tableåæ˜ çš„æ˜¯æ•°æ®ä»å“ªå¼ è¡¨ä¸­è¯»å–å‡ºæ¥ã€‚ ä¾‹å¦‚ &lt;derived2&gt; è¡¨ç¤ºä» id ä¸º 2 çš„ä¸´æ—¶è¡¨è¯»å–ã€‚ typetype æ˜¯è®¿é—®ç±»å‹æ’åºï¼Œåæ˜ çš„æ˜¯ SQL çš„ä¼˜åŒ–çŠ¶æ€ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ï¼š systemï¼šä»å•è¡¨åªæŸ¥å‡ºä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹ä¾‹ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç° constï¼šæŸ¥è¯¢æ¡ä»¶ç”¨åˆ°äº†å¸¸é‡ï¼Œé€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°ï¼Œå¸¸åœ¨ä½¿ç”¨ primary key æˆ– unique ç´¢å¼•ä¸­å‡ºç° eq_refï¼šå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œè¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…ï¼Œå¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æ refï¼šéå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œï¼Œæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒå¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œä¸eq_refçš„å·®åˆ«æ˜¯eq_refåªåŒ¹é…äº†ä¸€æ¡è®°å½• rangeï¼šåªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚keyåˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ï¼Œä¸€èˆ¬æ˜¯åœ¨whereè¯­å¥ä¸­å‡ºç°äº† betweenã€&lt;ã€&gt;ã€in ç­‰çš„æŸ¥è¯¢ indexï¼šfull Index scanï¼Œindex å’Œ all çš„åŒºåˆ«ä¸º index ç±»å‹åªéå†ç´¢å¼•æ ‘ã€‚è¿™é€šå¸¸æ¯” all å¿«ï¼Œå› ä¸ºç´¢å¼•æ–‡ä»¶é€šå¸¸æ¯”æ•°æ®æ–‡ä»¶å° allï¼šå…¨è¡¨æ‰«æï¼Œå¦‚æœæŸ¥è¯¢æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œå…¨è¡¨æ‰«ææ•ˆç‡æ˜¯å¾ˆä½çš„ åœ¨ SQL ä¼˜åŒ–ä¸­è‡³å°‘åšåˆ° range çº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ° ref çº§åˆ« possible_key &amp; key &amp; key_lenpossible_key åæ˜ çš„æ˜¯ MySQL æ¨æµ‹å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•ï¼Œä¸ä¸€å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨åˆ°ã€‚key åæ˜ çš„æ˜¯å®é™…ä½¿ç”¨åˆ°çš„ç´¢å¼•ï¼Œè‹¥ä¸º null åˆ™æ˜¯å› ä¸ºæ²¡æœ‰å»ºç´¢å¼•æˆ–è€…ç´¢å¼•å¤±æ•ˆã€‚key_len åæ˜ ç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯è®¡ç®—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ï¼Œè¶ŠçŸ­è¶Šå¥½ã€‚å…¶æ˜¾ç¤ºçš„å€¼ä¸ºç´¢å¼•å­—æ®µçš„æœ€å¤§å¯èƒ½é•¿åº¦ï¼Œè€Œéå®é™…ä½¿ç”¨é•¿åº¦ã€‚ refref åæ˜ çš„æ˜¯å“ªäº›åˆ—æˆ–è€…å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼ã€‚ rowsrows åæ˜ çš„æ ¹æ®è¡¨çš„ç»Ÿè®¡ä¿¡æ¯å’Œç´¢å¼•é€‰ç”¨çš„æƒ…å†µï¼Œå¤§è‡´ä¼°ç®—å‡ºæ¥åˆ°æ‰¾åˆ°æ‰€æœ‰è®°å½•æ‰€éœ€è¦è¯»å–çš„è¡Œæ•°ã€‚ filteredä½¿ç”¨ explain extended æ—¶ä¼šå‡ºç°è¿™ä¸ªåˆ—ï¼Œ5.7 ä¹‹åçš„ç‰ˆæœ¬é»˜è®¤å°±æœ‰è¿™ä¸ªå­—æ®µã€‚è¿™ä¸ªå­—æ®µè¡¨ç¤ºå­˜å‚¨å¼•æ“è¿”å›çš„æ•°æ®åœ¨ server å±‚è¿‡æ»¤åï¼Œå‰©ä¸‹å¤šå°‘æ»¡è¶³æŸ¥è¯¢çš„è®°å½•æ•°é‡çš„æ¯”ä¾‹ï¼Œä¸æ˜¯å…·ä½“è®°å½•æ•°ã€‚ ExtraExtra åæ˜ çš„ä¸é€‚åˆåœ¨å…¶ä»–åˆ—æ˜¾ç¤ºï¼Œä½†æ˜¯ä¹Ÿå¾ˆé‡è¦çš„ä¿¡æ¯ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š Using filesortï¼šMySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºï¼Œè¿™æ—¶ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚ Using temporaryï¼šä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœï¼ŒMySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group byã€‚ Using indexï¼šMySQL ç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé¿å…äº†è®¿é—®è¡¨çš„æ•°æ®è¡Œï¼Œæ•ˆç‡é«˜ã€‚ Using whereï¼šMySQL ä½¿ç”¨äº† where è¿‡æ»¤ã€‚ Using join bufferï¼šMySQL ä½¿ç”¨äº†è¿æ¥ç¼“å­˜ã€‚ Impossible whereï¼šwhere å­å¥çš„å€¼ä¸º falseã€‚ Distinctï¼šä¼˜åŒ– distinct æ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç»„åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚","categories":[],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://orechou.github.io/tags/MySQL/"}]}],"categories":[],"tags":[{"name":"Reading","slug":"Reading","permalink":"https://orechou.github.io/tags/Reading/"},{"name":"Life","slug":"Life","permalink":"https://orechou.github.io/tags/Life/"},{"name":"Java","slug":"Java","permalink":"https://orechou.github.io/tags/Java/"},{"name":"Other","slug":"Other","permalink":"https://orechou.github.io/tags/Other/"},{"name":"Song","slug":"Song","permalink":"https://orechou.github.io/tags/Song/"},{"name":"iOS","slug":"iOS","permalink":"https://orechou.github.io/tags/iOS/"},{"name":"SwiftUI","slug":"SwiftUI","permalink":"https://orechou.github.io/tags/SwiftUI/"},{"name":"MySQL","slug":"MySQL","permalink":"https://orechou.github.io/tags/MySQL/"}]}