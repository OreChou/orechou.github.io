<!DOCTYPE html>
<html lang="en-us">
<head>
  
  <link rel="dns-prefetch" href="https://latest.cactus.chat">
  <link rel="preconnect" href="https://latest.cactus.chat" crossorigin>

  
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Bcrypt 加密算法详解 | OreChou</title>
  <link rel = 'canonical' href = 'https://www.orechou.com/posts/2023/bcrypt-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3/'>
  <meta name="description" content="所有的文字，均致十年后的自己.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:url" content="https://www.orechou.com/posts/2023/bcrypt-%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3/">
  <meta property="og:site_name" content="OreChou">
  <meta property="og:title" content="Bcrypt 加密算法详解">
  <meta property="og:description" content="最近在回顾中台系统的用户权限设计，在用户密码落库这块使用了 Bcrypt 算法来保证安全性，这篇文章是对该算法的一个详细介绍。
什么是 Bcrypt 加密算法 Bcrypt 是一种密码哈希函数，用于加密用户密码。它是一种强大且安全的算法，用于存储用户密码，并在用户登录时进行验证。 Bcrypt 算法使用了 Blowfish 加密算法，它在对用户密码进行加密时需要一个随机的盐值，这样就可以避免暴力破解。此外，Bcrypt 算法还具有慢哈希的特性，即在加密过程中使用的复杂度可以通过 cost 参数来控制，从而使用户的密码更加安全。
加密的过程 生成 Salt 首先，Bcrypt 会生成一个随机的 salt，这个 salt 会被用于密码加密过程。
对密码和 salt 进行加密 然后，密码和 salt 会被结合在一起，并使用密码哈希函数进行加密。
增加复杂度 在加密的过程中，Bcrypt 会使用指定的 cost 参数进行加密，这个参数代表加密的次数。通过增加 cost 参数，可以使加密过程更加复杂，从而提高密码的安全性。
生成密文 Bcrypt 加密后的密文是一个长度为 60~100 个字符的字符串。它包含了以下几部分信息：
版本标识：Bcrypt 的密文开头一般以 “$2y$” 或 “$2a$” 开头，这代表了 Bcrypt 的版本信息。 cost 参数：密文的下一个字符是数字，代表了 Bcrypt 加密过程中使用的 cost 参数。 salt：接下来的 22 个字符代表了随机生成的 salt。使用 Base64 编码。 哈希值：最后的字符串是加密后的哈希值，代表了密码的密文形式。使用 Base 64 编码。 一个加密后的密文可能如下所示：&#34;$2a$10$S8U6dsEjvAUtf7XuUzK8.eDmI.xMh7OJj0s8Q7WuOvZDz9XBk1PM2&#34;。 与 SHA-256 算法的对比 Bcrypt 和 SHA-256 都是常用的哈希算法，但它们的安全性是有所不同的。Bcrypt 有如下的优点：">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-02-12T18:00:00+00:00">
    <meta property="article:modified_time" content="2023-02-12T18:00:00+00:00">
    <meta property="article:tag" content="Spring">
    <meta property="article:tag" content="Java">
    <meta property="article:tag" content="密码学">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bcrypt 加密算法详解">
  <meta name="twitter:description" content="最近在回顾中台系统的用户权限设计，在用户密码落库这块使用了 Bcrypt 算法来保证安全性，这篇文章是对该算法的一个详细介绍。
什么是 Bcrypt 加密算法 Bcrypt 是一种密码哈希函数，用于加密用户密码。它是一种强大且安全的算法，用于存储用户密码，并在用户登录时进行验证。 Bcrypt 算法使用了 Blowfish 加密算法，它在对用户密码进行加密时需要一个随机的盐值，这样就可以避免暴力破解。此外，Bcrypt 算法还具有慢哈希的特性，即在加密过程中使用的复杂度可以通过 cost 参数来控制，从而使用户的密码更加安全。
加密的过程 生成 Salt 首先，Bcrypt 会生成一个随机的 salt，这个 salt 会被用于密码加密过程。
对密码和 salt 进行加密 然后，密码和 salt 会被结合在一起，并使用密码哈希函数进行加密。
增加复杂度 在加密的过程中，Bcrypt 会使用指定的 cost 参数进行加密，这个参数代表加密的次数。通过增加 cost 参数，可以使加密过程更加复杂，从而提高密码的安全性。
生成密文 Bcrypt 加密后的密文是一个长度为 60~100 个字符的字符串。它包含了以下几部分信息：
版本标识：Bcrypt 的密文开头一般以 “$2y$” 或 “$2a$” 开头，这代表了 Bcrypt 的版本信息。 cost 参数：密文的下一个字符是数字，代表了 Bcrypt 加密过程中使用的 cost 参数。 salt：接下来的 22 个字符代表了随机生成的 salt。使用 Base64 编码。 哈希值：最后的字符串是加密后的哈希值，代表了密码的密文形式。使用 Base 64 编码。 一个加密后的密文可能如下所示：&#34;$2a$10$S8U6dsEjvAUtf7XuUzK8.eDmI.xMh7OJj0s8Q7WuOvZDz9XBk1PM2&#34;。 与 SHA-256 算法的对比 Bcrypt 和 SHA-256 都是常用的哈希算法，但它们的安全性是有所不同的。Bcrypt 有如下的优点：">

  
  
    
  
  
  <link rel="stylesheet" href="https://www.orechou.com/css/styles.c7fd5c039d6b095b5626e581b15068ced66bd84176ebf716ba2376e7d2f71b7d961de43194a5ec15760e25bd3b5867af1b96fa8330a6d8258bbb66ce974dd2e4.css" integrity="sha512-x/1cA51rCVtWJuWBsVBoztZr2EF26/cWuiN259L3G32WHeQxlKXsFXYOJb07WGevG5b6gzCm2CWLu2bOl03S5A=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  <link rel="icon" type="image/x-icon" href="https://www.orechou.com/images/favicon.ico" />
<link rel="shortcut icon" type="image/x-icon" href="https://www.orechou.com/images/favicon.ico" />

  
  
  
  
  

  
  <script>
    (function() {
      try {
        
        var savedTheme = localStorage.getItem('theme');
        var systemTheme = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        var theme = savedTheme || systemTheme;

        
        if (theme === 'white' || theme === 'classic') {
          theme = 'light';
          localStorage.setItem('theme', theme);
        }

        
        if (theme && theme !== 'default') {
          document.documentElement.classList.add('theme-' + theme);
        }
      } catch (e) {
        
      }
    })();
  </script>

  
  <script>
    document.documentElement.dataset.copyLabel = "Copy";
    document.documentElement.dataset.copiedLabel = "Copied!";
  </script>
</head>

<body class="max-width mx-auto px3 ltr">
  
  <div class="theme-switcher">
    
  </div>

  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'});" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/books">Books</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://www.orechou.com/posts/2023/%E5%85%B3%E4%BA%8E-priorityordered-%E5%92%8C-ordered-%E7%9A%84%E4%BD%BF%E7%94%A8/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="toggleDisplay('i-prev')" onmouseout="toggleDisplay('i-prev')"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://www.orechou.com/posts/2023/no.5-the-curious-case-of-benjamin-button/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="toggleDisplay('i-next')" onmouseout="toggleDisplay('i-next')"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'});" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="toggleDisplay('i-top')" onmouseout="toggleDisplay('i-top')"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="toggleDisplay('i-share')" onmouseout="toggleDisplay('i-share')" onclick="toggleDisplay('share');return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&text=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&is_video=false&description=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3&body=Check out this article: https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&name=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3&description=%3cp%3e%e6%9c%80%e8%bf%91%e5%9c%a8%e5%9b%9e%e9%a1%be%e4%b8%ad%e5%8f%b0%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%94%a8%e6%88%b7%e6%9d%83%e9%99%90%e8%ae%be%e8%ae%a1%ef%bc%8c%e5%9c%a8%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e8%90%bd%e5%ba%93%e8%bf%99%e5%9d%97%e4%bd%bf%e7%94%a8%e4%ba%86%20Bcrypt%20%e7%ae%97%e6%b3%95%e6%9d%a5%e4%bf%9d%e8%af%81%e5%ae%89%e5%85%a8%e6%80%a7%ef%bc%8c%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%98%af%e5%af%b9%e8%af%a5%e7%ae%97%e6%b3%95%e7%9a%84%e4%b8%80%e4%b8%aa%e8%af%a6%e7%bb%86%e4%bb%8b%e7%bb%8d%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22%e4%bb%80%e4%b9%88%e6%98%af-bcrypt-%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%22%3e%e4%bb%80%e4%b9%88%e6%98%af%20Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%3c%2fh2%3e%0a%3cp%3eBcrypt%20%e6%98%af%e4%b8%80%e7%a7%8d%e5%af%86%e7%a0%81%e5%93%88%e5%b8%8c%e5%87%bd%e6%95%b0%ef%bc%8c%e7%94%a8%e4%ba%8e%e5%8a%a0%e5%af%86%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e3%80%82%e5%ae%83%e6%98%af%e4%b8%80%e7%a7%8d%e5%bc%ba%e5%a4%a7%e4%b8%94%e5%ae%89%e5%85%a8%e7%9a%84%e7%ae%97%e6%b3%95%ef%bc%8c%e7%94%a8%e4%ba%8e%e5%ad%98%e5%82%a8%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%ef%bc%8c%e5%b9%b6%e5%9c%a8%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95%e6%97%b6%e8%bf%9b%e8%a1%8c%e9%aa%8c%e8%af%81%e3%80%82%0aBcrypt%20%e7%ae%97%e6%b3%95%e4%bd%bf%e7%94%a8%e4%ba%86%20Blowfish%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%ef%bc%8c%e5%ae%83%e5%9c%a8%e5%af%b9%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e6%97%b6%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e9%9a%8f%e6%9c%ba%e7%9a%84%e7%9b%90%e5%80%bc%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e5%8f%af%e4%bb%a5%e9%81%bf%e5%85%8d%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e3%80%82%e6%ad%a4%e5%a4%96%ef%bc%8cBcrypt%20%e7%ae%97%e6%b3%95%e8%bf%98%e5%85%b7%e6%9c%89%e6%85%a2%e5%93%88%e5%b8%8c%e7%9a%84%e7%89%b9%e6%80%a7%ef%bc%8c%e5%8d%b3%e5%9c%a8%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bd%bf%e7%94%a8%e7%9a%84%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87%20cost%20%e5%8f%82%e6%95%b0%e6%9d%a5%e6%8e%a7%e5%88%b6%ef%bc%8c%e4%bb%8e%e8%80%8c%e4%bd%bf%e7%94%a8%e6%88%b7%e7%9a%84%e5%af%86%e7%a0%81%e6%9b%b4%e5%8a%a0%e5%ae%89%e5%85%a8%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%22%3e%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%3c%2fh2%3e%0a%3ch3%20id%3d%22%e7%94%9f%e6%88%90-salt%22%3e%e7%94%9f%e6%88%90%20Salt%3c%2fh3%3e%0a%3cp%3e%e9%a6%96%e5%85%88%ef%bc%8cBcrypt%20%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%b8%aa%e9%9a%8f%e6%9c%ba%e7%9a%84%20salt%ef%bc%8c%e8%bf%99%e4%b8%aa%20salt%20%e4%bc%9a%e8%a2%ab%e7%94%a8%e4%ba%8e%e5%af%86%e7%a0%81%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%af%b9%e5%af%86%e7%a0%81%e5%92%8c-salt-%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%22%3e%e5%af%b9%e5%af%86%e7%a0%81%e5%92%8c%20salt%20%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%3c%2fh3%3e%0a%3cp%3e%e7%84%b6%e5%90%8e%ef%bc%8c%e5%af%86%e7%a0%81%e5%92%8c%20salt%20%e4%bc%9a%e8%a2%ab%e7%bb%93%e5%90%88%e5%9c%a8%e4%b8%80%e8%b5%b7%ef%bc%8c%e5%b9%b6%e4%bd%bf%e7%94%a8%e5%af%86%e7%a0%81%e5%93%88%e5%b8%8c%e5%87%bd%e6%95%b0%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%a2%9e%e5%8a%a0%e5%a4%8d%e6%9d%82%e5%ba%a6%22%3e%e5%a2%9e%e5%8a%a0%e5%a4%8d%e6%9d%82%e5%ba%a6%3c%2fh3%3e%0a%3cp%3e%e5%9c%a8%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%ef%bc%8cBcrypt%20%e4%bc%9a%e4%bd%bf%e7%94%a8%e6%8c%87%e5%ae%9a%e7%9a%84%20cost%20%e5%8f%82%e6%95%b0%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%bf%99%e4%b8%aa%e5%8f%82%e6%95%b0%e4%bb%a3%e8%a1%a8%e5%8a%a0%e5%af%86%e7%9a%84%e6%ac%a1%e6%95%b0%e3%80%82%e9%80%9a%e8%bf%87%e5%a2%9e%e5%8a%a0%20cost%20%e5%8f%82%e6%95%b0%ef%bc%8c%e5%8f%af%e4%bb%a5%e4%bd%bf%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e6%9b%b4%e5%8a%a0%e5%a4%8d%e6%9d%82%ef%bc%8c%e4%bb%8e%e8%80%8c%e6%8f%90%e9%ab%98%e5%af%86%e7%a0%81%e7%9a%84%e5%ae%89%e5%85%a8%e6%80%a7%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e7%94%9f%e6%88%90%e5%af%86%e6%96%87%22%3e%e7%94%9f%e6%88%90%e5%af%86%e6%96%87%3c%2fh3%3e%0a%3cp%3eBcrypt%20%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e6%98%af%e4%b8%80%e4%b8%aa%e9%95%bf%e5%ba%a6%e4%b8%ba%2060~100%20%e4%b8%aa%e5%ad%97%e7%ac%a6%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%82%e5%ae%83%e5%8c%85%e5%90%ab%e4%ba%86%e4%bb%a5%e4%b8%8b%e5%87%a0%e9%83%a8%e5%88%86%e4%bf%a1%e6%81%af%ef%bc%9a%3c%2fp%3e%0a%3col%3e%0a%3cli%3e%e7%89%88%e6%9c%ac%e6%a0%87%e8%af%86%ef%bc%9aBcrypt%20%e7%9a%84%e5%af%86%e6%96%87%e5%bc%80%e5%a4%b4%e4%b8%80%e8%88%ac%e4%bb%a5%20%26ldquo%3b%242y%24%26rdquo%3b%20%e6%88%96%20%26ldquo%3b%242a%24%26rdquo%3b%20%e5%bc%80%e5%a4%b4%ef%bc%8c%e8%bf%99%e4%bb%a3%e8%a1%a8%e4%ba%86%20Bcrypt%20%e7%9a%84%e7%89%88%e6%9c%ac%e4%bf%a1%e6%81%af%e3%80%82%3c%2fli%3e%0a%3cli%3ecost%20%e5%8f%82%e6%95%b0%ef%bc%9a%e5%af%86%e6%96%87%e7%9a%84%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%ad%97%e7%ac%a6%e6%98%af%e6%95%b0%e5%ad%97%ef%bc%8c%e4%bb%a3%e8%a1%a8%e4%ba%86%20Bcrypt%20%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bd%bf%e7%94%a8%e7%9a%84%20cost%20%e5%8f%82%e6%95%b0%e3%80%82%3c%2fli%3e%0a%3cli%3esalt%ef%bc%9a%e6%8e%a5%e4%b8%8b%e6%9d%a5%e7%9a%84%2022%20%e4%b8%aa%e5%ad%97%e7%ac%a6%e4%bb%a3%e8%a1%a8%e4%ba%86%e9%9a%8f%e6%9c%ba%e7%94%9f%e6%88%90%e7%9a%84%20salt%e3%80%82%e4%bd%bf%e7%94%a8%20Base64%20%e7%bc%96%e7%a0%81%e3%80%82%3c%2fli%3e%0a%3cli%3e%e5%93%88%e5%b8%8c%e5%80%bc%ef%bc%9a%e6%9c%80%e5%90%8e%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%af%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%93%88%e5%b8%8c%e5%80%bc%ef%bc%8c%e4%bb%a3%e8%a1%a8%e4%ba%86%e5%af%86%e7%a0%81%e7%9a%84%e5%af%86%e6%96%87%e5%bd%a2%e5%bc%8f%e3%80%82%e4%bd%bf%e7%94%a8%20Base%2064%20%e7%bc%96%e7%a0%81%e3%80%82%0a%e4%b8%80%e4%b8%aa%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e5%8f%af%e8%83%bd%e5%a6%82%e4%b8%8b%e6%89%80%e7%a4%ba%ef%bc%9a%3ccode%3e%26quot%3b%242a%2410%24S8U6dsEjvAUtf7XuUzK8.eDmI.xMh7OJj0s8Q7WuOvZDz9XBk1PM2%26quot%3b%3c%2fcode%3e%e3%80%82%3c%2fli%3e%0a%3c%2fol%3e%0a%3ch2%20id%3d%22%e4%b8%8e-sha-256-%e7%ae%97%e6%b3%95%e7%9a%84%e5%af%b9%e6%af%94%22%3e%e4%b8%8e%20SHA-256%20%e7%ae%97%e6%b3%95%e7%9a%84%e5%af%b9%e6%af%94%3c%2fh2%3e%0a%3cp%3eBcrypt%20%e5%92%8c%20SHA-256%20%e9%83%bd%e6%98%af%e5%b8%b8%e7%94%a8%e7%9a%84%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%ef%bc%8c%e4%bd%86%e5%ae%83%e4%bb%ac%e7%9a%84%e5%ae%89%e5%85%a8%e6%80%a7%e6%98%af%e6%9c%89%e6%89%80%e4%b8%8d%e5%90%8c%e7%9a%84%e3%80%82Bcrypt%20%e6%9c%89%e5%a6%82%e4%b8%8b%e7%9a%84%e4%bc%98%e7%82%b9%ef%bc%9a%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&t=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#什么是-bcrypt-加密算法">什么是 Bcrypt 加密算法</a></li>
    <li><a href="#加密的过程">加密的过程</a>
      <ul>
        <li><a href="#生成-salt">生成 Salt</a></li>
        <li><a href="#对密码和-salt-进行加密">对密码和 salt 进行加密</a></li>
        <li><a href="#增加复杂度">增加复杂度</a></li>
        <li><a href="#生成密文">生成密文</a></li>
      </ul>
    </li>
    <li><a href="#与-sha-256-算法的对比">与 SHA-256 算法的对比</a></li>
    <li><a href="#实际的应用">实际的应用</a>
      <ul>
        <li><a href="#使用">使用</a></li>
        <li><a href="#实现源码">实现源码</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Bcrypt 加密算法详解
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2023-02-12 18:00:00 &#43;0000 UTC" itemprop="datePublished">2023-02-12</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          7 minute read
        </div>
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/spring" rel="tag">Spring</a>
            
             ,  
            <a class="tag-link" href="/tags/java" rel="tag">Java</a>
            
             ,  
            <a class="tag-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6" rel="tag">密码学</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <p>最近在回顾中台系统的用户权限设计，在用户密码落库这块使用了 Bcrypt 算法来保证安全性，这篇文章是对该算法的一个详细介绍。</p>
<h2 id="什么是-bcrypt-加密算法">什么是 Bcrypt 加密算法</h2>
<p>Bcrypt 是一种密码哈希函数，用于加密用户密码。它是一种强大且安全的算法，用于存储用户密码，并在用户登录时进行验证。
Bcrypt 算法使用了 Blowfish 加密算法，它在对用户密码进行加密时需要一个随机的盐值，这样就可以避免暴力破解。此外，Bcrypt 算法还具有慢哈希的特性，即在加密过程中使用的复杂度可以通过 cost 参数来控制，从而使用户的密码更加安全。</p>
<h2 id="加密的过程">加密的过程</h2>
<h3 id="生成-salt">生成 Salt</h3>
<p>首先，Bcrypt 会生成一个随机的 salt，这个 salt 会被用于密码加密过程。</p>
<h3 id="对密码和-salt-进行加密">对密码和 salt 进行加密</h3>
<p>然后，密码和 salt 会被结合在一起，并使用密码哈希函数进行加密。</p>
<h3 id="增加复杂度">增加复杂度</h3>
<p>在加密的过程中，Bcrypt 会使用指定的 cost 参数进行加密，这个参数代表加密的次数。通过增加 cost 参数，可以使加密过程更加复杂，从而提高密码的安全性。</p>
<h3 id="生成密文">生成密文</h3>
<p>Bcrypt 加密后的密文是一个长度为 60~100 个字符的字符串。它包含了以下几部分信息：</p>
<ol>
<li>版本标识：Bcrypt 的密文开头一般以 &ldquo;$2y$&rdquo; 或 &ldquo;$2a$&rdquo; 开头，这代表了 Bcrypt 的版本信息。</li>
<li>cost 参数：密文的下一个字符是数字，代表了 Bcrypt 加密过程中使用的 cost 参数。</li>
<li>salt：接下来的 22 个字符代表了随机生成的 salt。使用 Base64 编码。</li>
<li>哈希值：最后的字符串是加密后的哈希值，代表了密码的密文形式。使用 Base 64 编码。
一个加密后的密文可能如下所示：<code>&quot;$2a$10$S8U6dsEjvAUtf7XuUzK8.eDmI.xMh7OJj0s8Q7WuOvZDz9XBk1PM2&quot;</code>。</li>
</ol>
<h2 id="与-sha-256-算法的对比">与 SHA-256 算法的对比</h2>
<p>Bcrypt 和 SHA-256 都是常用的哈希算法，但它们的安全性是有所不同的。Bcrypt 有如下的优点：</p>
<ol>
<li>慢哈希：Bcrypt 算法具有慢哈希的特点，即在加密过程中使用的计算复杂度可以通过 cost 参数来控制，从而使密码更加安全。而 SHA-256 并不具有这种特点，速度较快。</li>
<li>盐值：Bcrypt 在加密过程中使用了随机的盐值，这样就可以避免暴力破解。盐值存储在加密后的密文中，每个用户都有一个唯一的盐值。而 SHA-256 不支持使用盐值，因此它在数据库密码加密方面比 Bcrypt 更不安全</li>
<li>强度：Bcrypt 算法具有较高的强度，比 SHA-256 算法更难被破解。</li>
</ol>
<p>由于 Bcrypt 算法具有以上特点，因此它可以有效防止数据库被拖库，并保证密码不被泄露。即使数据库被黑客获取，他们也无法获得用户的原始密码，因为密码已经被加密。因此，使用 Bcrypt 算法存储密码是一种安全的方法。</p>
<h2 id="实际的应用">实际的应用</h2>
<p>Spring Security 就内置了 Bcrypt 算法的编码器 <code>BcryptPasswordEncoder</code>。</p>
<h3 id="使用">使用</h3>
<p>在项目中添加 <code>org.springframework.security:spring-security-crypto</code> 的依赖后在配置项中声明一个 Bean，代码如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>@Bean
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> PasswordEncoder <span style="color:#50fa7b">passwordEncoder</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">new</span> BcryptPasswordEncoder();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后我们就可以在其他地方使用这个 <code>PasswordEncoder</code> 了，对应了两个方法 <code>encode</code>() 和 <code>matches</code>()。</p>
<h3 id="实现源码">实现源码</h3>
<p>其实现了 <code>PasswordEncoder</code> 接口，接口的定义如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">interface</span> <span style="color:#50fa7b">PasswordEncoder</span> {
</span></span><span style="display:flex;"><span>	String <span style="color:#50fa7b">encode</span>(CharSequence rawPassword);
</span></span><span style="display:flex;"><span>	<span style="color:#8be9fd">boolean</span> <span style="color:#50fa7b">matches</span>(CharSequence rawPassword, String encodedPassword);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>编码的具体实现如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">encode</span>(CharSequence rawPassword) {
</span></span><span style="display:flex;"><span>    String salt;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (strength <span style="color:#ff79c6">&gt;</span> 0) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (random <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>            salt <span style="color:#ff79c6">=</span> Bcrypt.<span style="color:#50fa7b">gensalt</span>(strength, random);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>            salt <span style="color:#ff79c6">=</span> Bcrypt.<span style="color:#50fa7b">gensalt</span>(strength);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>        salt <span style="color:#ff79c6">=</span> Bcrypt.<span style="color:#50fa7b">gensalt</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> Bcrypt.<span style="color:#50fa7b">hashpw</span>(rawPassword.<span style="color:#50fa7b">toString</span>(), salt);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> String <span style="color:#50fa7b">hashpw</span>(String password, String salt) <span style="color:#8be9fd;font-style:italic">throws</span> IllegalArgumentException {
</span></span><span style="display:flex;"><span>    Bcrypt B;
</span></span><span style="display:flex;"><span>    String real_salt;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">byte</span> passwordb<span style="color:#ff79c6">[]</span>, saltb<span style="color:#ff79c6">[]</span>, hashed<span style="color:#ff79c6">[]</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">char</span> minor <span style="color:#ff79c6">=</span> (<span style="color:#8be9fd">char</span>) 0;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">int</span> rounds, off <span style="color:#ff79c6">=</span> 0;
</span></span><span style="display:flex;"><span>    StringBuilder rs <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringBuilder();
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (salt <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;salt cannot be null&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">int</span> saltLength <span style="color:#ff79c6">=</span> salt.<span style="color:#50fa7b">length</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (saltLength <span style="color:#ff79c6">&lt;</span> 28) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;Invalid salt&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (salt.<span style="color:#50fa7b">charAt</span>(0) <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;$&#39;</span> <span style="color:#ff79c6">||</span> salt.<span style="color:#50fa7b">charAt</span>(1) <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;2&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;Invalid salt version&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (salt.<span style="color:#50fa7b">charAt</span>(2) <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#39;$&#39;</span>) {
</span></span><span style="display:flex;"><span>        off <span style="color:#ff79c6">=</span> 3;
</span></span><span style="display:flex;"><span>    } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>        minor <span style="color:#ff79c6">=</span> salt.<span style="color:#50fa7b">charAt</span>(2);
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (minor <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;a&#39;</span> <span style="color:#ff79c6">||</span> salt.<span style="color:#50fa7b">charAt</span>(3) <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;$&#39;</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;Invalid salt revision&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        off <span style="color:#ff79c6">=</span> 4;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (saltLength <span style="color:#ff79c6">-</span> off <span style="color:#ff79c6">&lt;</span> 25) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;Invalid salt&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// Extract number of rounds</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (salt.<span style="color:#50fa7b">charAt</span>(off <span style="color:#ff79c6">+</span> 2) <span style="color:#ff79c6">&gt;</span> <span style="color:#f1fa8c">&#39;$&#39;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> IllegalArgumentException(<span style="color:#f1fa8c">&#34;Missing salt rounds&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    rounds <span style="color:#ff79c6">=</span> Integer.<span style="color:#50fa7b">parseint</span>(salt.<span style="color:#50fa7b">substring</span>(off, off <span style="color:#ff79c6">+</span> 2));
</span></span><span style="display:flex;"><span>    real_salt <span style="color:#ff79c6">=</span> salt.<span style="color:#50fa7b">substring</span>(off <span style="color:#ff79c6">+</span> 3, off <span style="color:#ff79c6">+</span> 25);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>        passwordb <span style="color:#ff79c6">=</span> (password <span style="color:#ff79c6">+</span> (minor <span style="color:#ff79c6">&gt;=</span> <span style="color:#f1fa8c">&#39;a&#39;</span> <span style="color:#ff79c6">?</span> <span style="color:#f1fa8c">&#34;00&#34;</span> : <span style="color:#f1fa8c">&#34;&#34;</span>)).<span style="color:#50fa7b">getBytes</span>(<span style="color:#f1fa8c">&#34;UTF-8&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">catch</span> (UnsupportedEncodingException uee) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> AssertionError(<span style="color:#f1fa8c">&#34;UTF-8 is not supported&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    saltb <span style="color:#ff79c6">=</span> decode_base64(real_salt, BCRYPT_SALT_LEN);
</span></span><span style="display:flex;"><span>    B <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> Bcrypt();
</span></span><span style="display:flex;"><span>    hashed <span style="color:#ff79c6">=</span> B.<span style="color:#50fa7b">crypt_raw</span>(passwordb, saltb, rounds);
</span></span><span style="display:flex;"><span>    rs.<span style="color:#50fa7b">append</span>(<span style="color:#f1fa8c">&#34;$2&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (minor <span style="color:#ff79c6">&gt;=</span> <span style="color:#f1fa8c">&#39;a&#39;</span>) {
</span></span><span style="display:flex;"><span>        rs.<span style="color:#50fa7b">append</span>(minor);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    rs.<span style="color:#50fa7b">append</span>(<span style="color:#f1fa8c">&#34;$&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (rounds <span style="color:#ff79c6">&lt;</span> 10) {
</span></span><span style="display:flex;"><span>        rs.<span style="color:#50fa7b">append</span>(<span style="color:#f1fa8c">&#34;0&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    rs.<span style="color:#50fa7b">append</span>(rounds);
</span></span><span style="display:flex;"><span>    rs.<span style="color:#50fa7b">append</span>(<span style="color:#f1fa8c">&#34;$&#34;</span>);
</span></span><span style="display:flex;"><span>    encode_base64(saltb, saltb.<span style="color:#50fa7b">length</span>, rs);
</span></span><span style="display:flex;"><span>    encode_base64(hashed, bf_crypt_ciphertext.<span style="color:#50fa7b">length</span> <span style="color:#ff79c6">*</span> 4 <span style="color:#ff79c6">-</span> 1, rs);
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> rs.<span style="color:#50fa7b">toString</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>验证密码的实现如下：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> Boolean <span style="color:#50fa7b">matches</span>(CharSequence rawPassword, String encodedPassword) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (encodedPassword <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">||</span> encodedPassword.<span style="color:#50fa7b">length</span>() <span style="color:#ff79c6">==</span> 0) {
</span></span><span style="display:flex;"><span>        logger.<span style="color:#50fa7b">warn</span>(<span style="color:#f1fa8c">&#34;Empty encoded password&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">!</span>BCRYPT_PATTERN.<span style="color:#50fa7b">matcher</span>(encodedPassword).<span style="color:#50fa7b">matches</span>()) {
</span></span><span style="display:flex;"><span>        logger.<span style="color:#50fa7b">warn</span>(<span style="color:#f1fa8c">&#34;Encoded password does not look like Bcrypt&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> Bcrypt.<span style="color:#50fa7b">checkpw</span>(rawPassword.<span style="color:#50fa7b">toString</span>(), encodedPassword);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> Boolean <span style="color:#50fa7b">checkpw</span>(String plaintext, String hashed) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> equalsNoEarlyReturn(hashed, hashpw(plaintext, hashed));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">static</span> Boolean <span style="color:#50fa7b">equalsNoEarlyReturn</span>(String a, String b) {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">char</span><span style="color:#ff79c6">[]</span> caa <span style="color:#ff79c6">=</span> a.<span style="color:#50fa7b">toCharArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">char</span><span style="color:#ff79c6">[]</span> cab <span style="color:#ff79c6">=</span> b.<span style="color:#50fa7b">toCharArray</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> (caa.<span style="color:#50fa7b">length</span> <span style="color:#ff79c6">!=</span> cab.<span style="color:#50fa7b">length</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">false</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd">byte</span> ret <span style="color:#ff79c6">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 0; i <span style="color:#ff79c6">&lt;</span> caa.<span style="color:#50fa7b">length</span>; i<span style="color:#ff79c6">++</span>) {
</span></span><span style="display:flex;"><span>        ret <span style="color:#ff79c6">|=</span> caa<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">^</span> cab<span style="color:#ff79c6">[</span>i<span style="color:#ff79c6">]</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> ret <span style="color:#ff79c6">==</span> 0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>整个的代码是比较简单的，就不详细说明了。</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/books">Books</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#什么是-bcrypt-加密算法">什么是 Bcrypt 加密算法</a></li>
    <li><a href="#加密的过程">加密的过程</a>
      <ul>
        <li><a href="#生成-salt">生成 Salt</a></li>
        <li><a href="#对密码和-salt-进行加密">对密码和 salt 进行加密</a></li>
        <li><a href="#增加复杂度">增加复杂度</a></li>
        <li><a href="#生成密文">生成密文</a></li>
      </ul>
    </li>
    <li><a href="#与-sha-256-算法的对比">与 SHA-256 算法的对比</a></li>
    <li><a href="#实际的应用">实际的应用</a>
      <ul>
        <li><a href="#使用">使用</a></li>
        <li><a href="#实现源码">实现源码</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&text=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&is_video=false&description=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3&body=Check out this article: https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&title=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&name=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3&description=%3cp%3e%e6%9c%80%e8%bf%91%e5%9c%a8%e5%9b%9e%e9%a1%be%e4%b8%ad%e5%8f%b0%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%94%a8%e6%88%b7%e6%9d%83%e9%99%90%e8%ae%be%e8%ae%a1%ef%bc%8c%e5%9c%a8%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e8%90%bd%e5%ba%93%e8%bf%99%e5%9d%97%e4%bd%bf%e7%94%a8%e4%ba%86%20Bcrypt%20%e7%ae%97%e6%b3%95%e6%9d%a5%e4%bf%9d%e8%af%81%e5%ae%89%e5%85%a8%e6%80%a7%ef%bc%8c%e8%bf%99%e7%af%87%e6%96%87%e7%ab%a0%e6%98%af%e5%af%b9%e8%af%a5%e7%ae%97%e6%b3%95%e7%9a%84%e4%b8%80%e4%b8%aa%e8%af%a6%e7%bb%86%e4%bb%8b%e7%bb%8d%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22%e4%bb%80%e4%b9%88%e6%98%af-bcrypt-%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%22%3e%e4%bb%80%e4%b9%88%e6%98%af%20Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%3c%2fh2%3e%0a%3cp%3eBcrypt%20%e6%98%af%e4%b8%80%e7%a7%8d%e5%af%86%e7%a0%81%e5%93%88%e5%b8%8c%e5%87%bd%e6%95%b0%ef%bc%8c%e7%94%a8%e4%ba%8e%e5%8a%a0%e5%af%86%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e3%80%82%e5%ae%83%e6%98%af%e4%b8%80%e7%a7%8d%e5%bc%ba%e5%a4%a7%e4%b8%94%e5%ae%89%e5%85%a8%e7%9a%84%e7%ae%97%e6%b3%95%ef%bc%8c%e7%94%a8%e4%ba%8e%e5%ad%98%e5%82%a8%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%ef%bc%8c%e5%b9%b6%e5%9c%a8%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95%e6%97%b6%e8%bf%9b%e8%a1%8c%e9%aa%8c%e8%af%81%e3%80%82%0aBcrypt%20%e7%ae%97%e6%b3%95%e4%bd%bf%e7%94%a8%e4%ba%86%20Blowfish%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%ef%bc%8c%e5%ae%83%e5%9c%a8%e5%af%b9%e7%94%a8%e6%88%b7%e5%af%86%e7%a0%81%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e6%97%b6%e9%9c%80%e8%a6%81%e4%b8%80%e4%b8%aa%e9%9a%8f%e6%9c%ba%e7%9a%84%e7%9b%90%e5%80%bc%ef%bc%8c%e8%bf%99%e6%a0%b7%e5%b0%b1%e5%8f%af%e4%bb%a5%e9%81%bf%e5%85%8d%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e3%80%82%e6%ad%a4%e5%a4%96%ef%bc%8cBcrypt%20%e7%ae%97%e6%b3%95%e8%bf%98%e5%85%b7%e6%9c%89%e6%85%a2%e5%93%88%e5%b8%8c%e7%9a%84%e7%89%b9%e6%80%a7%ef%bc%8c%e5%8d%b3%e5%9c%a8%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bd%bf%e7%94%a8%e7%9a%84%e5%a4%8d%e6%9d%82%e5%ba%a6%e5%8f%af%e4%bb%a5%e9%80%9a%e8%bf%87%20cost%20%e5%8f%82%e6%95%b0%e6%9d%a5%e6%8e%a7%e5%88%b6%ef%bc%8c%e4%bb%8e%e8%80%8c%e4%bd%bf%e7%94%a8%e6%88%b7%e7%9a%84%e5%af%86%e7%a0%81%e6%9b%b4%e5%8a%a0%e5%ae%89%e5%85%a8%e3%80%82%3c%2fp%3e%0a%3ch2%20id%3d%22%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%22%3e%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%3c%2fh2%3e%0a%3ch3%20id%3d%22%e7%94%9f%e6%88%90-salt%22%3e%e7%94%9f%e6%88%90%20Salt%3c%2fh3%3e%0a%3cp%3e%e9%a6%96%e5%85%88%ef%bc%8cBcrypt%20%e4%bc%9a%e7%94%9f%e6%88%90%e4%b8%80%e4%b8%aa%e9%9a%8f%e6%9c%ba%e7%9a%84%20salt%ef%bc%8c%e8%bf%99%e4%b8%aa%20salt%20%e4%bc%9a%e8%a2%ab%e7%94%a8%e4%ba%8e%e5%af%86%e7%a0%81%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%af%b9%e5%af%86%e7%a0%81%e5%92%8c-salt-%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%22%3e%e5%af%b9%e5%af%86%e7%a0%81%e5%92%8c%20salt%20%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%3c%2fh3%3e%0a%3cp%3e%e7%84%b6%e5%90%8e%ef%bc%8c%e5%af%86%e7%a0%81%e5%92%8c%20salt%20%e4%bc%9a%e8%a2%ab%e7%bb%93%e5%90%88%e5%9c%a8%e4%b8%80%e8%b5%b7%ef%bc%8c%e5%b9%b6%e4%bd%bf%e7%94%a8%e5%af%86%e7%a0%81%e5%93%88%e5%b8%8c%e5%87%bd%e6%95%b0%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e5%a2%9e%e5%8a%a0%e5%a4%8d%e6%9d%82%e5%ba%a6%22%3e%e5%a2%9e%e5%8a%a0%e5%a4%8d%e6%9d%82%e5%ba%a6%3c%2fh3%3e%0a%3cp%3e%e5%9c%a8%e5%8a%a0%e5%af%86%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%ef%bc%8cBcrypt%20%e4%bc%9a%e4%bd%bf%e7%94%a8%e6%8c%87%e5%ae%9a%e7%9a%84%20cost%20%e5%8f%82%e6%95%b0%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%ef%bc%8c%e8%bf%99%e4%b8%aa%e5%8f%82%e6%95%b0%e4%bb%a3%e8%a1%a8%e5%8a%a0%e5%af%86%e7%9a%84%e6%ac%a1%e6%95%b0%e3%80%82%e9%80%9a%e8%bf%87%e5%a2%9e%e5%8a%a0%20cost%20%e5%8f%82%e6%95%b0%ef%bc%8c%e5%8f%af%e4%bb%a5%e4%bd%bf%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e6%9b%b4%e5%8a%a0%e5%a4%8d%e6%9d%82%ef%bc%8c%e4%bb%8e%e8%80%8c%e6%8f%90%e9%ab%98%e5%af%86%e7%a0%81%e7%9a%84%e5%ae%89%e5%85%a8%e6%80%a7%e3%80%82%3c%2fp%3e%0a%3ch3%20id%3d%22%e7%94%9f%e6%88%90%e5%af%86%e6%96%87%22%3e%e7%94%9f%e6%88%90%e5%af%86%e6%96%87%3c%2fh3%3e%0a%3cp%3eBcrypt%20%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e6%98%af%e4%b8%80%e4%b8%aa%e9%95%bf%e5%ba%a6%e4%b8%ba%2060~100%20%e4%b8%aa%e5%ad%97%e7%ac%a6%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%82%e5%ae%83%e5%8c%85%e5%90%ab%e4%ba%86%e4%bb%a5%e4%b8%8b%e5%87%a0%e9%83%a8%e5%88%86%e4%bf%a1%e6%81%af%ef%bc%9a%3c%2fp%3e%0a%3col%3e%0a%3cli%3e%e7%89%88%e6%9c%ac%e6%a0%87%e8%af%86%ef%bc%9aBcrypt%20%e7%9a%84%e5%af%86%e6%96%87%e5%bc%80%e5%a4%b4%e4%b8%80%e8%88%ac%e4%bb%a5%20%26ldquo%3b%242y%24%26rdquo%3b%20%e6%88%96%20%26ldquo%3b%242a%24%26rdquo%3b%20%e5%bc%80%e5%a4%b4%ef%bc%8c%e8%bf%99%e4%bb%a3%e8%a1%a8%e4%ba%86%20Bcrypt%20%e7%9a%84%e7%89%88%e6%9c%ac%e4%bf%a1%e6%81%af%e3%80%82%3c%2fli%3e%0a%3cli%3ecost%20%e5%8f%82%e6%95%b0%ef%bc%9a%e5%af%86%e6%96%87%e7%9a%84%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%ad%97%e7%ac%a6%e6%98%af%e6%95%b0%e5%ad%97%ef%bc%8c%e4%bb%a3%e8%a1%a8%e4%ba%86%20Bcrypt%20%e5%8a%a0%e5%af%86%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bd%bf%e7%94%a8%e7%9a%84%20cost%20%e5%8f%82%e6%95%b0%e3%80%82%3c%2fli%3e%0a%3cli%3esalt%ef%bc%9a%e6%8e%a5%e4%b8%8b%e6%9d%a5%e7%9a%84%2022%20%e4%b8%aa%e5%ad%97%e7%ac%a6%e4%bb%a3%e8%a1%a8%e4%ba%86%e9%9a%8f%e6%9c%ba%e7%94%9f%e6%88%90%e7%9a%84%20salt%e3%80%82%e4%bd%bf%e7%94%a8%20Base64%20%e7%bc%96%e7%a0%81%e3%80%82%3c%2fli%3e%0a%3cli%3e%e5%93%88%e5%b8%8c%e5%80%bc%ef%bc%9a%e6%9c%80%e5%90%8e%e7%9a%84%e5%ad%97%e7%ac%a6%e4%b8%b2%e6%98%af%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%93%88%e5%b8%8c%e5%80%bc%ef%bc%8c%e4%bb%a3%e8%a1%a8%e4%ba%86%e5%af%86%e7%a0%81%e7%9a%84%e5%af%86%e6%96%87%e5%bd%a2%e5%bc%8f%e3%80%82%e4%bd%bf%e7%94%a8%20Base%2064%20%e7%bc%96%e7%a0%81%e3%80%82%0a%e4%b8%80%e4%b8%aa%e5%8a%a0%e5%af%86%e5%90%8e%e7%9a%84%e5%af%86%e6%96%87%e5%8f%af%e8%83%bd%e5%a6%82%e4%b8%8b%e6%89%80%e7%a4%ba%ef%bc%9a%3ccode%3e%26quot%3b%242a%2410%24S8U6dsEjvAUtf7XuUzK8.eDmI.xMh7OJj0s8Q7WuOvZDz9XBk1PM2%26quot%3b%3c%2fcode%3e%e3%80%82%3c%2fli%3e%0a%3c%2fol%3e%0a%3ch2%20id%3d%22%e4%b8%8e-sha-256-%e7%ae%97%e6%b3%95%e7%9a%84%e5%af%b9%e6%af%94%22%3e%e4%b8%8e%20SHA-256%20%e7%ae%97%e6%b3%95%e7%9a%84%e5%af%b9%e6%af%94%3c%2fh2%3e%0a%3cp%3eBcrypt%20%e5%92%8c%20SHA-256%20%e9%83%bd%e6%98%af%e5%b8%b8%e7%94%a8%e7%9a%84%e5%93%88%e5%b8%8c%e7%ae%97%e6%b3%95%ef%bc%8c%e4%bd%86%e5%ae%83%e4%bb%ac%e7%9a%84%e5%ae%89%e5%85%a8%e6%80%a7%e6%98%af%e6%9c%89%e6%89%80%e4%b8%8d%e5%90%8c%e7%9a%84%e3%80%82Bcrypt%20%e6%9c%89%e5%a6%82%e4%b8%8b%e7%9a%84%e4%bc%98%e7%82%b9%ef%bc%9a%3c%2fp%3e" aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.orechou.com%2fposts%2f2023%2fbcrypt-%25E5%258A%25A0%25E5%25AF%2586%25E7%25AE%2597%25E6%25B3%2595%25E8%25AF%25A6%25E8%25A7%25A3%2f&t=Bcrypt%20%e5%8a%a0%e5%af%86%e7%ae%97%e6%b3%95%e8%af%a6%e8%a7%a3" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="toggleDisplay('nav-footer');return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="toggleDisplay('toc-footer');return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="toggleDisplay('share-footer');return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'});" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2026  OreChou 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/books">Books</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/js/main.js defer></script>

<script src=/js/code-copy.js defer></script>




</html>
